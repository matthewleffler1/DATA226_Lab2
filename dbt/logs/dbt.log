[0m12:44:28.905085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062797f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c7ed0>]}


============================== 12:44:28.907729 | 3a1079f7-ef4f-47ac-8126-b1c384a21730 ==============================
[0m12:44:28.907729 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:44:28.907982 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/matthewleffler/.dbt', 'log_path': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/stock_elt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:44:29.072664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a1079f7-ef4f-47ac-8126-b1c384a21730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e1fe10>]}
[0m12:44:29.091745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a1079f7-ef4f-47ac-8126-b1c384a21730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cee140>]}
[0m12:44:29.092281 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:44:29.152086 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:44:29.152455 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:44:29.152609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3a1079f7-ef4f-47ac-8126-b1c384a21730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d94e50>]}
[0m12:44:29.631441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a1079f7-ef4f-47ac-8126-b1c384a21730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093167b0>]}
[0m12:44:29.662997 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/stock_elt/target/manifest.json
[0m12:44:29.664400 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/stock_elt/target/semantic_manifest.json
[0m12:44:29.673552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a1079f7-ef4f-47ac-8126-b1c384a21730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096cb930>]}
[0m12:44:29.673738 [info ] [MainThread]: Found 3 models, 4 data tests, 2 sources, 474 macros
[0m12:44:29.673863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a1079f7-ef4f-47ac-8126-b1c384a21730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093a2340>]}
[0m12:44:29.674541 [info ] [MainThread]: 
[0m12:44:29.674669 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:44:29.674766 [info ] [MainThread]: 
[0m12:44:29.674943 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:44:29.676530 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH'
[0m12:44:29.700101 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH"
[0m12:44:29.700296 [debug] [ThreadPool]: On list_USER_DB_CATFISH: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_elt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH"} */
show terse schemas in database USER_DB_CATFISH
    limit 10000
[0m12:44:29.700395 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:44:30.575610 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.875 seconds
[0m12:44:30.580386 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH, now list_USER_DB_CATFISH_analytics)
[0m12:44:30.589230 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_analytics"
[0m12:44:30.589543 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_elt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_analytics"} */
show objects in USER_DB_CATFISH.analytics limit 10000;
[0m12:44:30.760048 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.170 seconds
[0m12:44:30.762674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a1079f7-ef4f-47ac-8126-b1c384a21730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f09a90>]}
[0m12:44:30.765936 [debug] [Thread-1 (]: Began running node model.stock_elt.lab1_stock_price_table
[0m12:44:30.766276 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.lab1_stock_price_table ................... [RUN]
[0m12:44:30.766557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_analytics, now model.stock_elt.lab1_stock_price_table)
[0m12:44:30.766766 [debug] [Thread-1 (]: Began compiling node model.stock_elt.lab1_stock_price_table
[0m12:44:30.771326 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt.lab1_stock_price_table"
[0m12:44:30.771999 [debug] [Thread-1 (]: Began executing node model.stock_elt.lab1_stock_price_table
[0m12:44:30.787330 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_elt.lab1_stock_price_table"
[0m12:44:30.788072 [debug] [Thread-1 (]: Using snowflake connection "model.stock_elt.lab1_stock_price_table"
[0m12:44:30.788242 [debug] [Thread-1 (]: On model.stock_elt.lab1_stock_price_table: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_elt", "target_name": "dev", "node_id": "model.stock_elt.lab1_stock_price_table"} */
create or replace   view USER_DB_CATFISH.analytics.lab1_stock_price_table
  
   as (
    SELECT *
FROM USER_DB_CATFISH.raw.lab1_stock_price_table
  );
[0m12:44:31.240603 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.452 seconds
[0m12:44:31.267630 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a1079f7-ef4f-47ac-8126-b1c384a21730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f0f490>]}
[0m12:44:31.268252 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.lab1_stock_price_table .............. [[32mSUCCESS 1[0m in 0.50s]
[0m12:44:31.268656 [debug] [Thread-1 (]: Finished running node model.stock_elt.lab1_stock_price_table
[0m12:44:31.268914 [debug] [Thread-1 (]: Began running node model.stock_elt.my_first_dbt_model
[0m12:44:31.269301 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.my_first_dbt_model ...................... [RUN]
[0m12:44:31.269665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt.lab1_stock_price_table, now model.stock_elt.my_first_dbt_model)
[0m12:44:31.269896 [debug] [Thread-1 (]: Began compiling node model.stock_elt.my_first_dbt_model
[0m12:44:31.271622 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt.my_first_dbt_model"
[0m12:44:31.272249 [debug] [Thread-1 (]: Began executing node model.stock_elt.my_first_dbt_model
[0m12:44:31.285530 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_elt.my_first_dbt_model"
[0m12:44:31.286225 [debug] [Thread-1 (]: Using snowflake connection "model.stock_elt.my_first_dbt_model"
[0m12:44:31.286430 [debug] [Thread-1 (]: On model.stock_elt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_elt", "target_name": "dev", "node_id": "model.stock_elt.my_first_dbt_model"} */
create or replace transient table USER_DB_CATFISH.analytics.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m12:44:32.341390 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.054 seconds
[0m12:44:32.345431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a1079f7-ef4f-47ac-8126-b1c384a21730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e00c910>]}
[0m12:44:32.346440 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.my_first_dbt_model ................. [[32mSUCCESS 1[0m in 1.08s]
[0m12:44:32.347328 [debug] [Thread-1 (]: Finished running node model.stock_elt.my_first_dbt_model
[0m12:44:32.348586 [debug] [Thread-1 (]: Began running node model.stock_elt.my_second_dbt_model
[0m12:44:32.349146 [info ] [Thread-1 (]: 3 of 3 START sql view model analytics.my_second_dbt_model ...................... [RUN]
[0m12:44:32.349697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt.my_first_dbt_model, now model.stock_elt.my_second_dbt_model)
[0m12:44:32.350083 [debug] [Thread-1 (]: Began compiling node model.stock_elt.my_second_dbt_model
[0m12:44:32.354679 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt.my_second_dbt_model"
[0m12:44:32.355933 [debug] [Thread-1 (]: Began executing node model.stock_elt.my_second_dbt_model
[0m12:44:32.359268 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_elt.my_second_dbt_model"
[0m12:44:32.360133 [debug] [Thread-1 (]: Using snowflake connection "model.stock_elt.my_second_dbt_model"
[0m12:44:32.360452 [debug] [Thread-1 (]: On model.stock_elt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_elt", "target_name": "dev", "node_id": "model.stock_elt.my_second_dbt_model"} */
create or replace   view USER_DB_CATFISH.analytics.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from USER_DB_CATFISH.analytics.my_first_dbt_model
where id = 1
  );
[0m12:44:32.774813 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.414 seconds
[0m12:44:32.777927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a1079f7-ef4f-47ac-8126-b1c384a21730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ceb9d0>]}
[0m12:44:32.778763 [info ] [Thread-1 (]: 3 of 3 OK created sql view model analytics.my_second_dbt_model ................. [[32mSUCCESS 1[0m in 0.43s]
[0m12:44:32.779432 [debug] [Thread-1 (]: Finished running node model.stock_elt.my_second_dbt_model
[0m12:44:32.780972 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:44:32.781311 [debug] [MainThread]: Connection 'model.stock_elt.my_second_dbt_model' was left open.
[0m12:44:32.781622 [debug] [MainThread]: On model.stock_elt.my_second_dbt_model: Close
[0m12:44:32.924438 [info ] [MainThread]: 
[0m12:44:32.925290 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 3.25 seconds (3.25s).
[0m12:44:32.926629 [debug] [MainThread]: Command end result
[0m12:44:32.951201 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/stock_elt/target/manifest.json
[0m12:44:32.952924 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/stock_elt/target/semantic_manifest.json
[0m12:44:32.957239 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/stock_elt/target/run_results.json
[0m12:44:32.957468 [info ] [MainThread]: 
[0m12:44:32.957708 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:44:32.957874 [info ] [MainThread]: 
[0m12:44:32.958045 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:44:32.959778 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.081974, "process_in_blocks": "0", "process_kernel_time": 0.22885, "process_mem_max_rss": "149454848", "process_out_blocks": "0", "process_user_time": 1.430175}
[0m12:44:32.960018 [debug] [MainThread]: Command `dbt run` succeeded at 12:44:32.959963 after 4.08 seconds
[0m12:44:32.960231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10742d400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100ae79a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106518770>]}
[0m12:44:32.960435 [debug] [MainThread]: Flushing usage events
[0m12:44:33.402218 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:49:08.087094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cf17f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a3fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a3fed0>]}


============================== 20:49:08.089710 | 8a9ec2ea-12f4-4571-b92d-f0951ab604af ==============================
[0m20:49:08.089710 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:49:08.089959 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/stock_elt/logs', 'profiles_dir': '/Users/matthewleffler/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:49:08.248049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a9ec2ea-12f4-4571-b92d-f0951ab604af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107373e10>]}
[0m20:49:08.266324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a9ec2ea-12f4-4571-b92d-f0951ab604af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071d2140>]}
[0m20:49:08.266780 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:49:08.324057 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:49:08.375554 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 3 files added, 0 files changed.
[0m20:49:08.375786 [debug] [MainThread]: Partial parsing: added file: stock_elt://models/output/rolling_avg_filtered.sql
[0m20:49:08.375924 [debug] [MainThread]: Partial parsing: added file: stock_elt://models/schema.yml
[0m20:49:08.376028 [debug] [MainThread]: Partial parsing: added file: stock_elt://models/intermediate/rolling_average_calc.sql
[0m20:49:08.376171 [debug] [MainThread]: Partial parsing: deleted file: stock_elt://models/example/my_second_dbt_model.sql
[0m20:49:08.376264 [debug] [MainThread]: Partial parsing: deleted file: stock_elt://models/example/my_first_dbt_model.sql
[0m20:49:08.533794 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_elt.example
[0m20:49:08.538394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a9ec2ea-12f4-4571-b92d-f0951ab604af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10786d150>]}
[0m20:49:08.569843 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/stock_elt/target/manifest.json
[0m20:49:08.571816 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/stock_elt/target/semantic_manifest.json
[0m20:49:08.581301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a9ec2ea-12f4-4571-b92d-f0951ab604af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075a59a0>]}
[0m20:49:08.581473 [info ] [MainThread]: Found 3 models, 3 data tests, 2 sources, 474 macros
[0m20:49:08.581599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a9ec2ea-12f4-4571-b92d-f0951ab604af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078c3a10>]}
[0m20:49:08.582269 [info ] [MainThread]: 
[0m20:49:08.582399 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:49:08.582497 [info ] [MainThread]: 
[0m20:49:08.582674 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:49:08.584271 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH'
[0m20:49:08.613143 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH"
[0m20:49:08.613318 [debug] [ThreadPool]: On list_USER_DB_CATFISH: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_elt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH"} */
show terse schemas in database USER_DB_CATFISH
    limit 10000
[0m20:49:08.613433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:09.454068 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.840 seconds
[0m20:49:09.459379 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH, now list_USER_DB_CATFISH_analytics)
[0m20:49:09.472535 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_analytics"
[0m20:49:09.473084 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_elt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_analytics"} */
show objects in USER_DB_CATFISH.analytics limit 10000;
[0m20:49:09.651965 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.178 seconds
[0m20:49:09.657335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a9ec2ea-12f4-4571-b92d-f0951ab604af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107900e20>]}
[0m20:49:09.662334 [debug] [Thread-1 (]: Began running node model.stock_elt.lab1_stock_price_table
[0m20:49:09.662931 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.lab1_stock_price_table ................... [RUN]
[0m20:49:09.663382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_analytics, now model.stock_elt.lab1_stock_price_table)
[0m20:49:09.663681 [debug] [Thread-1 (]: Began compiling node model.stock_elt.lab1_stock_price_table
[0m20:49:09.670137 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt.lab1_stock_price_table"
[0m20:49:09.670941 [debug] [Thread-1 (]: Began executing node model.stock_elt.lab1_stock_price_table
[0m20:49:09.689886 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_elt.lab1_stock_price_table"
[0m20:49:09.690543 [debug] [Thread-1 (]: Using snowflake connection "model.stock_elt.lab1_stock_price_table"
[0m20:49:09.690750 [debug] [Thread-1 (]: On model.stock_elt.lab1_stock_price_table: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_elt", "target_name": "dev", "node_id": "model.stock_elt.lab1_stock_price_table"} */
create or replace   view USER_DB_CATFISH.analytics.lab1_stock_price_table
  
   as (
    SELECT *
FROM USER_DB_CATFISH.raw.lab1_stock_price_table
  );
[0m20:49:10.170862 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.480 seconds
[0m20:49:10.195164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a9ec2ea-12f4-4571-b92d-f0951ab604af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079f3890>]}
[0m20:49:10.195813 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.lab1_stock_price_table .............. [[32mSUCCESS 1[0m in 0.53s]
[0m20:49:10.196236 [debug] [Thread-1 (]: Finished running node model.stock_elt.lab1_stock_price_table
[0m20:49:10.196821 [debug] [Thread-1 (]: Began running node model.stock_elt.rolling_average_calc
[0m20:49:10.197177 [info ] [Thread-1 (]: 2 of 3 START sql view model analytics.rolling_average_calc ..................... [RUN]
[0m20:49:10.197491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt.lab1_stock_price_table, now model.stock_elt.rolling_average_calc)
[0m20:49:10.197707 [debug] [Thread-1 (]: Began compiling node model.stock_elt.rolling_average_calc
[0m20:49:10.199776 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt.rolling_average_calc"
[0m20:49:10.200377 [debug] [Thread-1 (]: Began executing node model.stock_elt.rolling_average_calc
[0m20:49:10.201828 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_elt.rolling_average_calc"
[0m20:49:10.202634 [debug] [Thread-1 (]: Using snowflake connection "model.stock_elt.rolling_average_calc"
[0m20:49:10.202929 [debug] [Thread-1 (]: On model.stock_elt.rolling_average_calc: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_elt", "target_name": "dev", "node_id": "model.stock_elt.rolling_average_calc"} */
create or replace   view USER_DB_CATFISH.analytics.rolling_average_calc
  
   as (
    SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
  );
[0m20:49:10.682096 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.479 seconds
[0m20:49:10.686836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a9ec2ea-12f4-4571-b92d-f0951ab604af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10792e8e0>]}
[0m20:49:10.687604 [info ] [Thread-1 (]: 2 of 3 OK created sql view model analytics.rolling_average_calc ................ [[32mSUCCESS 1[0m in 0.49s]
[0m20:49:10.688183 [debug] [Thread-1 (]: Finished running node model.stock_elt.rolling_average_calc
[0m20:49:10.688919 [debug] [Thread-1 (]: Began running node model.stock_elt.rolling_avg_filtered
[0m20:49:10.689505 [info ] [Thread-1 (]: 3 of 3 START sql view model analytics.rolling_avg_filtered ..................... [RUN]
[0m20:49:10.690007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt.rolling_average_calc, now model.stock_elt.rolling_avg_filtered)
[0m20:49:10.690333 [debug] [Thread-1 (]: Began compiling node model.stock_elt.rolling_avg_filtered
[0m20:49:10.692839 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt.rolling_avg_filtered"
[0m20:49:10.693766 [debug] [Thread-1 (]: Began executing node model.stock_elt.rolling_avg_filtered
[0m20:49:10.696572 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_elt.rolling_avg_filtered"
[0m20:49:10.697706 [debug] [Thread-1 (]: Using snowflake connection "model.stock_elt.rolling_avg_filtered"
[0m20:49:10.698094 [debug] [Thread-1 (]: On model.stock_elt.rolling_avg_filtered: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_elt", "target_name": "dev", "node_id": "model.stock_elt.rolling_avg_filtered"} */
create or replace   view USER_DB_CATFISH.analytics.rolling_avg_filtered
  
   as (
    SELECT *
FROM USER_DB_CATFISH.analytics.rolling_average_calc
WHERE row_num >= 7
ORDER BY SYMBOL, DATE, row_num
  );
[0m20:49:11.171349 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.473 seconds
[0m20:49:11.175541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a9ec2ea-12f4-4571-b92d-f0951ab604af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d016a30>]}
[0m20:49:11.176400 [info ] [Thread-1 (]: 3 of 3 OK created sql view model analytics.rolling_avg_filtered ................ [[32mSUCCESS 1[0m in 0.49s]
[0m20:49:11.177156 [debug] [Thread-1 (]: Finished running node model.stock_elt.rolling_avg_filtered
[0m20:49:11.178415 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:49:11.178686 [debug] [MainThread]: Connection 'model.stock_elt.rolling_avg_filtered' was left open.
[0m20:49:11.178926 [debug] [MainThread]: On model.stock_elt.rolling_avg_filtered: Close
[0m20:49:11.328450 [info ] [MainThread]: 
[0m20:49:11.329482 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 2.75 seconds (2.75s).
[0m20:49:11.330869 [debug] [MainThread]: Command end result
[0m20:49:11.355642 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/stock_elt/target/manifest.json
[0m20:49:11.357431 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/stock_elt/target/semantic_manifest.json
[0m20:49:11.361663 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/stock_elt/target/run_results.json
[0m20:49:11.361884 [info ] [MainThread]: 
[0m20:49:11.362142 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:49:11.362318 [info ] [MainThread]: 
[0m20:49:11.362525 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:49:11.364569 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.30236, "process_in_blocks": "0", "process_kernel_time": 0.159353, "process_mem_max_rss": "142819328", "process_out_blocks": "0", "process_user_time": 1.062056}
[0m20:49:11.364850 [debug] [MainThread]: Command `dbt run` succeeded at 20:49:11.364793 after 3.30 seconds
[0m20:49:11.365115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078be2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078b7e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aa5400>]}
[0m20:49:11.365333 [debug] [MainThread]: Flushing usage events
[0m20:49:11.753392 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:54:45.438474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1188717f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119bc7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119bc7ed0>]}


============================== 20:54:45.441562 | 6b4499fa-8393-475f-8a04-bca9023c2fbb ==============================
[0m20:54:45.441562 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:54:45.441818 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/matthewleffler/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/stock_elt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:54:45.603416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b4499fa-8393-475f-8a04-bca9023c2fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a81fe10>]}
[0m20:54:45.621533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b4499fa-8393-475f-8a04-bca9023c2fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a6ee140>]}
[0m20:54:45.622017 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:54:45.670383 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:54:45.722792 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:54:45.722971 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:54:45.725136 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_elt.example
[0m20:54:45.740179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b4499fa-8393-475f-8a04-bca9023c2fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a797e50>]}
[0m20:54:45.770638 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/stock_elt/target/manifest.json
[0m20:54:45.772286 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/stock_elt/target/semantic_manifest.json
[0m20:54:45.813554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b4499fa-8393-475f-8a04-bca9023c2fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ade8410>]}
[0m20:54:45.813788 [info ] [MainThread]: Found 3 models, 3 data tests, 2 sources, 474 macros
[0m20:54:45.813924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b4499fa-8393-475f-8a04-bca9023c2fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a8560b0>]}
[0m20:54:45.814649 [info ] [MainThread]: 
[0m20:54:45.814791 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:54:45.814893 [info ] [MainThread]: 
[0m20:54:45.815078 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:54:45.816750 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH_analytics'
[0m20:54:45.842341 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_analytics"
[0m20:54:45.842517 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_elt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_analytics"} */
show objects in USER_DB_CATFISH.analytics limit 10000;
[0m20:54:45.842619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:54:46.425859 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.583 seconds
[0m20:54:46.432781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b4499fa-8393-475f-8a04-bca9023c2fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bb0f6c0>]}
[0m20:54:46.435674 [debug] [Thread-1 (]: Began running node test.stock_elt.not_null_rolling_average_calc_DATE.687edb0d17
[0m20:54:46.436083 [info ] [Thread-1 (]: 1 of 3 START test not_null_rolling_average_calc_DATE ........................... [RUN]
[0m20:54:46.436486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_analytics, now test.stock_elt.not_null_rolling_average_calc_DATE.687edb0d17)
[0m20:54:46.436782 [debug] [Thread-1 (]: Began compiling node test.stock_elt.not_null_rolling_average_calc_DATE.687edb0d17
[0m20:54:46.450703 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt.not_null_rolling_average_calc_DATE.687edb0d17"
[0m20:54:46.451299 [debug] [Thread-1 (]: Began executing node test.stock_elt.not_null_rolling_average_calc_DATE.687edb0d17
[0m20:54:46.462021 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt.not_null_rolling_average_calc_DATE.687edb0d17"
[0m20:54:46.462935 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt.not_null_rolling_average_calc_DATE.687edb0d17"
[0m20:54:46.463146 [debug] [Thread-1 (]: On test.stock_elt.not_null_rolling_average_calc_DATE.687edb0d17: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_elt", "target_name": "dev", "node_id": "test.stock_elt.not_null_rolling_average_calc_DATE.687edb0d17"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DATE
from USER_DB_CATFISH.analytics.rolling_average_calc
where DATE is null



      
    ) dbt_internal_test
[0m20:54:46.909629 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.446 seconds
[0m20:54:46.921694 [info ] [Thread-1 (]: 1 of 3 PASS not_null_rolling_average_calc_DATE ................................. [[32mPASS[0m in 0.49s]
[0m20:54:46.922326 [debug] [Thread-1 (]: Finished running node test.stock_elt.not_null_rolling_average_calc_DATE.687edb0d17
[0m20:54:46.922684 [debug] [Thread-1 (]: Began running node test.stock_elt.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6
[0m20:54:46.923096 [info ] [Thread-1 (]: 2 of 3 START test not_null_rolling_average_calc_SYMBOL ......................... [RUN]
[0m20:54:46.923529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt.not_null_rolling_average_calc_DATE.687edb0d17, now test.stock_elt.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6)
[0m20:54:46.923850 [debug] [Thread-1 (]: Began compiling node test.stock_elt.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6
[0m20:54:46.927650 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6"
[0m20:54:46.928460 [debug] [Thread-1 (]: Began executing node test.stock_elt.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6
[0m20:54:46.930189 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6"
[0m20:54:46.931116 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6"
[0m20:54:46.931480 [debug] [Thread-1 (]: On test.stock_elt.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_elt", "target_name": "dev", "node_id": "test.stock_elt.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SYMBOL
from USER_DB_CATFISH.analytics.rolling_average_calc
where SYMBOL is null



      
    ) dbt_internal_test
[0m20:54:47.086527 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.154 seconds
[0m20:54:47.091493 [info ] [Thread-1 (]: 2 of 3 PASS not_null_rolling_average_calc_SYMBOL ............................... [[32mPASS[0m in 0.17s]
[0m20:54:47.092164 [debug] [Thread-1 (]: Finished running node test.stock_elt.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6
[0m20:54:47.092575 [debug] [Thread-1 (]: Began running node test.stock_elt.not_null_rolling_average_calc_row_num.05f5f58c28
[0m20:54:47.093022 [info ] [Thread-1 (]: 3 of 3 START test not_null_rolling_average_calc_row_num ........................ [RUN]
[0m20:54:47.093523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6, now test.stock_elt.not_null_rolling_average_calc_row_num.05f5f58c28)
[0m20:54:47.093892 [debug] [Thread-1 (]: Began compiling node test.stock_elt.not_null_rolling_average_calc_row_num.05f5f58c28
[0m20:54:47.098424 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt.not_null_rolling_average_calc_row_num.05f5f58c28"
[0m20:54:47.099293 [debug] [Thread-1 (]: Began executing node test.stock_elt.not_null_rolling_average_calc_row_num.05f5f58c28
[0m20:54:47.101013 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt.not_null_rolling_average_calc_row_num.05f5f58c28"
[0m20:54:47.101784 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt.not_null_rolling_average_calc_row_num.05f5f58c28"
[0m20:54:47.102058 [debug] [Thread-1 (]: On test.stock_elt.not_null_rolling_average_calc_row_num.05f5f58c28: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_elt", "target_name": "dev", "node_id": "test.stock_elt.not_null_rolling_average_calc_row_num.05f5f58c28"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select row_num
from USER_DB_CATFISH.analytics.rolling_average_calc
where row_num is null



      
    ) dbt_internal_test
[0m20:54:47.626541 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.524 seconds
[0m20:54:47.630190 [info ] [Thread-1 (]: 3 of 3 PASS not_null_rolling_average_calc_row_num .............................. [[32mPASS[0m in 0.54s]
[0m20:54:47.631076 [debug] [Thread-1 (]: Finished running node test.stock_elt.not_null_rolling_average_calc_row_num.05f5f58c28
[0m20:54:47.632899 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:54:47.633285 [debug] [MainThread]: Connection 'test.stock_elt.not_null_rolling_average_calc_row_num.05f5f58c28' was left open.
[0m20:54:47.633669 [debug] [MainThread]: On test.stock_elt.not_null_rolling_average_calc_row_num.05f5f58c28: Close
[0m20:54:47.790427 [info ] [MainThread]: 
[0m20:54:47.791152 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 1.98 seconds (1.98s).
[0m20:54:47.792446 [debug] [MainThread]: Command end result
[0m20:54:47.817745 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/stock_elt/target/manifest.json
[0m20:54:47.819319 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/stock_elt/target/semantic_manifest.json
[0m20:54:47.824368 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/stock_elt/target/run_results.json
[0m20:54:47.824597 [info ] [MainThread]: 
[0m20:54:47.824849 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:54:47.825053 [info ] [MainThread]: 
[0m20:54:47.825229 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:54:47.827264 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.4148772, "process_in_blocks": "0", "process_kernel_time": 0.179118, "process_mem_max_rss": "140804096", "process_out_blocks": "0", "process_user_time": 0.913733}
[0m20:54:47.827557 [debug] [MainThread]: Command `dbt test` succeeded at 20:54:47.827497 after 2.42 seconds
[0m20:54:47.827812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1198cf7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bab3120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bab3490>]}
[0m20:54:47.828052 [debug] [MainThread]: Flushing usage events
[0m20:54:48.260408 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:04:25.172087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038657f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045b3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045b3ed0>]}


============================== 21:04:25.174772 | f4621664-1fef-4073-b164-97bb36c52328 ==============================
[0m21:04:25.174772 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:04:25.175019 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/stock_elt/logs', 'version_check': 'True', 'profiles_dir': '/Users/matthewleffler/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:04:25.333595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4621664-1fef-4073-b164-97bb36c52328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eb3e10>]}
[0m21:04:25.351904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4621664-1fef-4073-b164-97bb36c52328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d12140>]}
[0m21:04:25.352359 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m21:04:25.400295 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:04:25.453205 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:04:25.453488 [debug] [MainThread]: Partial parsing: updated file: stock_elt://models/intermediate/rolling_average_calc.sql
[0m21:04:25.615452 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_elt.example
[0m21:04:25.619950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4621664-1fef-4073-b164-97bb36c52328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053ad250>]}
[0m21:04:25.650279 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/stock_elt/target/manifest.json
[0m21:04:25.653963 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/stock_elt/target/semantic_manifest.json
[0m21:04:25.663249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4621664-1fef-4073-b164-97bb36c52328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10442b2f0>]}
[0m21:04:25.663430 [info ] [MainThread]: Found 3 models, 3 data tests, 2 sources, 474 macros
[0m21:04:25.663555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4621664-1fef-4073-b164-97bb36c52328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105403930>]}
[0m21:04:25.664237 [info ] [MainThread]: 
[0m21:04:25.664368 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:04:25.664467 [info ] [MainThread]: 
[0m21:04:25.664646 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:04:25.666235 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH'
[0m21:04:25.690952 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH"
[0m21:04:25.691133 [debug] [ThreadPool]: On list_USER_DB_CATFISH: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_elt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH"} */
show terse schemas in database USER_DB_CATFISH
    limit 10000
[0m21:04:25.691235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:04:26.342765 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.651 seconds
[0m21:04:26.347045 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH, now list_USER_DB_CATFISH_analytics)
[0m21:04:26.359123 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_analytics"
[0m21:04:26.359501 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_elt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_analytics"} */
show objects in USER_DB_CATFISH.analytics limit 10000;
[0m21:04:26.486249 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.126 seconds
[0m21:04:26.494386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4621664-1fef-4073-b164-97bb36c52328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105434940>]}
[0m21:04:26.498741 [debug] [Thread-1 (]: Began running node model.stock_elt.lab1_stock_price_table
[0m21:04:26.499298 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics.lab1_stock_price_table ................... [RUN]
[0m21:04:26.499749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_analytics, now model.stock_elt.lab1_stock_price_table)
[0m21:04:26.500080 [debug] [Thread-1 (]: Began compiling node model.stock_elt.lab1_stock_price_table
[0m21:04:26.506712 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt.lab1_stock_price_table"
[0m21:04:26.507601 [debug] [Thread-1 (]: Began executing node model.stock_elt.lab1_stock_price_table
[0m21:04:26.526829 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_elt.lab1_stock_price_table"
[0m21:04:26.527456 [debug] [Thread-1 (]: Using snowflake connection "model.stock_elt.lab1_stock_price_table"
[0m21:04:26.527655 [debug] [Thread-1 (]: On model.stock_elt.lab1_stock_price_table: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_elt", "target_name": "dev", "node_id": "model.stock_elt.lab1_stock_price_table"} */
create or replace   view USER_DB_CATFISH.analytics.lab1_stock_price_table
  
   as (
    SELECT *
FROM USER_DB_CATFISH.raw.lab1_stock_price_table
  );
[0m21:04:26.942405 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.414 seconds
[0m21:04:26.968357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4621664-1fef-4073-b164-97bb36c52328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105533d10>]}
[0m21:04:26.968928 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics.lab1_stock_price_table .............. [[32mSUCCESS 1[0m in 0.47s]
[0m21:04:26.969349 [debug] [Thread-1 (]: Finished running node model.stock_elt.lab1_stock_price_table
[0m21:04:26.969936 [debug] [Thread-1 (]: Began running node model.stock_elt.rolling_average_calc
[0m21:04:26.970243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt.lab1_stock_price_table, now model.stock_elt.rolling_average_calc)
[0m21:04:26.970506 [debug] [Thread-1 (]: Began compiling node model.stock_elt.rolling_average_calc
[0m21:04:26.972617 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt.rolling_average_calc"
[0m21:04:26.973362 [debug] [Thread-1 (]: Finished running node model.stock_elt.rolling_average_calc
[0m21:04:26.973719 [debug] [Thread-1 (]: Began running node model.stock_elt.rolling_avg_filtered
[0m21:04:26.974036 [info ] [Thread-1 (]: 2 of 2 START sql view model analytics.rolling_avg_filtered ..................... [RUN]
[0m21:04:26.974396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt.rolling_average_calc, now model.stock_elt.rolling_avg_filtered)
[0m21:04:26.974660 [debug] [Thread-1 (]: Began compiling node model.stock_elt.rolling_avg_filtered
[0m21:04:26.976973 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt.rolling_avg_filtered"
[0m21:04:26.977848 [debug] [Thread-1 (]: Began executing node model.stock_elt.rolling_avg_filtered
[0m21:04:26.980056 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_elt.rolling_avg_filtered"
[0m21:04:26.981081 [debug] [Thread-1 (]: Using snowflake connection "model.stock_elt.rolling_avg_filtered"
[0m21:04:26.981306 [debug] [Thread-1 (]: On model.stock_elt.rolling_avg_filtered: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_elt", "target_name": "dev", "node_id": "model.stock_elt.rolling_avg_filtered"} */
create or replace   view USER_DB_CATFISH.analytics.rolling_avg_filtered
  
   as (
    with __dbt__cte__rolling_average_calc as (


SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
) SELECT *
FROM __dbt__cte__rolling_average_calc
WHERE row_num >= 7
ORDER BY SYMBOL, DATE, row_num
  );
[0m21:04:27.918794 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.937 seconds
[0m21:04:27.924082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4621664-1fef-4073-b164-97bb36c52328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054628e0>]}
[0m21:04:27.924999 [info ] [Thread-1 (]: 2 of 2 OK created sql view model analytics.rolling_avg_filtered ................ [[32mSUCCESS 1[0m in 0.95s]
[0m21:04:27.925715 [debug] [Thread-1 (]: Finished running node model.stock_elt.rolling_avg_filtered
[0m21:04:27.927465 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:04:27.927823 [debug] [MainThread]: Connection 'model.stock_elt.rolling_avg_filtered' was left open.
[0m21:04:27.928156 [debug] [MainThread]: On model.stock_elt.rolling_avg_filtered: Close
[0m21:04:28.076406 [info ] [MainThread]: 
[0m21:04:28.077222 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.41 seconds (2.41s).
[0m21:04:28.078373 [debug] [MainThread]: Command end result
[0m21:04:28.103509 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/stock_elt/target/manifest.json
[0m21:04:28.104976 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/stock_elt/target/semantic_manifest.json
[0m21:04:28.109209 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/stock_elt/target/run_results.json
[0m21:04:28.109410 [info ] [MainThread]: 
[0m21:04:28.109636 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:04:28.109793 [info ] [MainThread]: 
[0m21:04:28.109967 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:04:28.111868 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.9668393, "process_in_blocks": "0", "process_kernel_time": 0.172443, "process_mem_max_rss": "144883712", "process_out_blocks": "0", "process_user_time": 1.045347}
[0m21:04:28.112130 [debug] [MainThread]: Command `dbt run` succeeded at 21:04:28.112076 after 2.97 seconds
[0m21:04:28.112362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10588f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054cfc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053ff050>]}
[0m21:04:28.112578 [debug] [MainThread]: Flushing usage events
[0m21:04:28.539515 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:05:24.830409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086917f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093dfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093dfed0>]}


============================== 21:05:24.833239 | 1df1071f-2841-4bd1-9ac1-6d278432030e ==============================
[0m21:05:24.833239 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:05:24.833501 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/matthewleffler/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/stock_elt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:05:24.993703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1df1071f-2841-4bd1-9ac1-6d278432030e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cdfe10>]}
[0m21:05:25.011766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1df1071f-2841-4bd1-9ac1-6d278432030e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b3e140>]}
[0m21:05:25.012239 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m21:05:25.060912 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:05:25.113420 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:05:25.113676 [debug] [MainThread]: Partial parsing: updated file: stock_elt://models/output/rolling_avg_filtered.sql
[0m21:05:25.225785 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_elt.example
[0m21:05:25.230336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1df1071f-2841-4bd1-9ac1-6d278432030e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c57350>]}
[0m21:05:25.260307 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/stock_elt/target/manifest.json
[0m21:05:25.261705 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/stock_elt/target/semantic_manifest.json
[0m21:05:25.270514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1df1071f-2841-4bd1-9ac1-6d278432030e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092532f0>]}
[0m21:05:25.270696 [info ] [MainThread]: Found 3 models, 3 data tests, 2 sources, 474 macros
[0m21:05:25.270820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1df1071f-2841-4bd1-9ac1-6d278432030e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d1b5b0>]}
[0m21:05:25.271485 [info ] [MainThread]: 
[0m21:05:25.271618 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:05:25.271717 [info ] [MainThread]: 
[0m21:05:25.271891 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:05:25.273481 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH'
[0m21:05:25.297364 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH"
[0m21:05:25.297540 [debug] [ThreadPool]: On list_USER_DB_CATFISH: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_elt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH"} */
show terse schemas in database USER_DB_CATFISH
    limit 10000
[0m21:05:25.297641 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:05:25.847262 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.549 seconds
[0m21:05:25.852821 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH, now list_USER_DB_CATFISH_analytics)
[0m21:05:25.863283 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_analytics"
[0m21:05:25.863625 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_elt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_analytics"} */
show objects in USER_DB_CATFISH.analytics limit 10000;
[0m21:05:26.021472 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.157 seconds
[0m21:05:26.027469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1df1071f-2841-4bd1-9ac1-6d278432030e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1cf1e0>]}
[0m21:05:26.031274 [debug] [Thread-1 (]: Began running node model.stock_elt.lab1_stock_price_table
[0m21:05:26.031716 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics.lab1_stock_price_table ................... [RUN]
[0m21:05:26.032064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_analytics, now model.stock_elt.lab1_stock_price_table)
[0m21:05:26.032325 [debug] [Thread-1 (]: Began compiling node model.stock_elt.lab1_stock_price_table
[0m21:05:26.038007 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt.lab1_stock_price_table"
[0m21:05:26.038748 [debug] [Thread-1 (]: Began executing node model.stock_elt.lab1_stock_price_table
[0m21:05:26.057942 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_elt.lab1_stock_price_table"
[0m21:05:26.058720 [debug] [Thread-1 (]: Using snowflake connection "model.stock_elt.lab1_stock_price_table"
[0m21:05:26.058914 [debug] [Thread-1 (]: On model.stock_elt.lab1_stock_price_table: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_elt", "target_name": "dev", "node_id": "model.stock_elt.lab1_stock_price_table"} */
create or replace   view USER_DB_CATFISH.analytics.lab1_stock_price_table
  
   as (
    SELECT *
FROM USER_DB_CATFISH.raw.lab1_stock_price_table
  );
[0m21:05:26.409915 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.351 seconds
[0m21:05:26.437314 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1df1071f-2841-4bd1-9ac1-6d278432030e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3df950>]}
[0m21:05:26.437878 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics.lab1_stock_price_table .............. [[32mSUCCESS 1[0m in 0.40s]
[0m21:05:26.438320 [debug] [Thread-1 (]: Finished running node model.stock_elt.lab1_stock_price_table
[0m21:05:26.438925 [debug] [Thread-1 (]: Began running node model.stock_elt.rolling_average_calc
[0m21:05:26.439256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt.lab1_stock_price_table, now model.stock_elt.rolling_average_calc)
[0m21:05:26.439533 [debug] [Thread-1 (]: Began compiling node model.stock_elt.rolling_average_calc
[0m21:05:26.441499 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt.rolling_average_calc"
[0m21:05:26.442349 [debug] [Thread-1 (]: Finished running node model.stock_elt.rolling_average_calc
[0m21:05:26.442794 [debug] [Thread-1 (]: Began running node model.stock_elt.rolling_avg_filtered
[0m21:05:26.443166 [info ] [Thread-1 (]: 2 of 2 START sql view model analytics.rolling_avg_filtered ..................... [RUN]
[0m21:05:26.443444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt.rolling_average_calc, now model.stock_elt.rolling_avg_filtered)
[0m21:05:26.443778 [debug] [Thread-1 (]: Began compiling node model.stock_elt.rolling_avg_filtered
[0m21:05:26.446855 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt.rolling_avg_filtered"
[0m21:05:26.447297 [debug] [Thread-1 (]: Began executing node model.stock_elt.rolling_avg_filtered
[0m21:05:26.449242 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_elt.rolling_avg_filtered"
[0m21:05:26.450156 [debug] [Thread-1 (]: Using snowflake connection "model.stock_elt.rolling_avg_filtered"
[0m21:05:26.450373 [debug] [Thread-1 (]: On model.stock_elt.rolling_avg_filtered: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_elt", "target_name": "dev", "node_id": "model.stock_elt.rolling_avg_filtered"} */
create or replace   view USER_DB_CATFISH.analytics.rolling_avg_filtered
  
   as (
    with __dbt__cte__rolling_average_calc as (


SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
) SELECT SYMBOL,
       DATE,
       ROLLING_AVERAGE
FROM __dbt__cte__rolling_average_calc
WHERE row_num >= 7
ORDER BY SYMBOL, DATE, row_num
  );
[0m21:05:28.867989 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.417 seconds
[0m21:05:28.872365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1df1071f-2841-4bd1-9ac1-6d278432030e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a21de90>]}
[0m21:05:28.873359 [info ] [Thread-1 (]: 2 of 2 OK created sql view model analytics.rolling_avg_filtered ................ [[32mSUCCESS 1[0m in 2.43s]
[0m21:05:28.874021 [debug] [Thread-1 (]: Finished running node model.stock_elt.rolling_avg_filtered
[0m21:05:28.875614 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:05:28.875950 [debug] [MainThread]: Connection 'model.stock_elt.rolling_avg_filtered' was left open.
[0m21:05:28.876228 [debug] [MainThread]: On model.stock_elt.rolling_avg_filtered: Close
[0m21:05:29.032200 [info ] [MainThread]: 
[0m21:05:29.033011 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 3.76 seconds (3.76s).
[0m21:05:29.034118 [debug] [MainThread]: Command end result
[0m21:05:29.056598 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/stock_elt/target/manifest.json
[0m21:05:29.057895 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/stock_elt/target/semantic_manifest.json
[0m21:05:29.061650 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/stock_elt/target/run_results.json
[0m21:05:29.061837 [info ] [MainThread]: 
[0m21:05:29.062049 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:05:29.062203 [info ] [MainThread]: 
[0m21:05:29.062370 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:05:29.064024 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.259394, "process_in_blocks": "0", "process_kernel_time": 0.180636, "process_mem_max_rss": "143818752", "process_out_blocks": "0", "process_user_time": 0.987836}
[0m21:05:29.064253 [debug] [MainThread]: Command `dbt run` succeeded at 21:05:29.064201 after 4.26 seconds
[0m21:05:29.064456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5ab250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1e7b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c9f0d0>]}
[0m21:05:29.064644 [debug] [MainThread]: Flushing usage events
[0m21:05:29.454075 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:20:08.495137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043417f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10508fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10508fed0>]}


============================== 22:20:08.497806 | 2e9f685c-3a70-4064-97ad-32ee96968d74 ==============================
[0m22:20:08.497806 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:20:08.498060 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/stock_elt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/matthewleffler/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/stock_elt --profiles-dir /Users/matthewleffler/.dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:20:08.657782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e9f685c-3a70-4064-97ad-32ee96968d74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10598fe10>]}
[0m22:20:08.675887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e9f685c-3a70-4064-97ad-32ee96968d74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057f2140>]}
[0m22:20:08.676346 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m22:20:08.724358 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:20:08.776896 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:20:08.777093 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:20:08.779193 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_elt.example
[0m22:20:08.794209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e9f685c-3a70-4064-97ad-32ee96968d74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105907e50>]}
[0m22:20:08.824588 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/stock_elt/target/manifest.json
[0m22:20:08.825997 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/stock_elt/target/semantic_manifest.json
[0m22:20:08.836478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e9f685c-3a70-4064-97ad-32ee96968d74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f032f0>]}
[0m22:20:08.836682 [info ] [MainThread]: Found 3 models, 3 data tests, 2 sources, 474 macros
[0m22:20:08.836806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e9f685c-3a70-4064-97ad-32ee96968d74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059cbd90>]}
[0m22:20:08.837546 [info ] [MainThread]: 
[0m22:20:08.837677 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:20:08.837781 [info ] [MainThread]: 
[0m22:20:08.837972 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:20:08.839579 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH'
[0m22:20:08.891394 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH"
[0m22:20:08.891569 [debug] [ThreadPool]: On list_USER_DB_CATFISH: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_elt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH"} */
show terse schemas in database USER_DB_CATFISH
    limit 10000
[0m22:20:08.891671 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:20:09.437600 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.546 seconds
[0m22:20:09.441486 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH, now list_USER_DB_CATFISH_analytics)
[0m22:20:09.452569 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_analytics"
[0m22:20:09.452961 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_elt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_analytics"} */
show objects in USER_DB_CATFISH.analytics limit 10000;
[0m22:20:09.658184 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.205 seconds
[0m22:20:09.664049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e9f685c-3a70-4064-97ad-32ee96968d74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e2ea90>]}
[0m22:20:09.668674 [debug] [Thread-1 (]: Began running node model.stock_elt.lab1_stock_price_table
[0m22:20:09.669235 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics.lab1_stock_price_table ................... [RUN]
[0m22:20:09.669660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_analytics, now model.stock_elt.lab1_stock_price_table)
[0m22:20:09.669984 [debug] [Thread-1 (]: Began compiling node model.stock_elt.lab1_stock_price_table
[0m22:20:09.676294 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt.lab1_stock_price_table"
[0m22:20:09.677315 [debug] [Thread-1 (]: Began executing node model.stock_elt.lab1_stock_price_table
[0m22:20:09.696047 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_elt.lab1_stock_price_table"
[0m22:20:09.696701 [debug] [Thread-1 (]: Using snowflake connection "model.stock_elt.lab1_stock_price_table"
[0m22:20:09.696909 [debug] [Thread-1 (]: On model.stock_elt.lab1_stock_price_table: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_elt", "target_name": "dev", "node_id": "model.stock_elt.lab1_stock_price_table"} */
create or replace   view USER_DB_CATFISH.analytics.lab1_stock_price_table
  
   as (
    SELECT *
FROM USER_DB_CATFISH.raw.lab1_stock_price_table
  );
[0m22:20:10.152970 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.456 seconds
[0m22:20:10.172991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e9f685c-3a70-4064-97ad-32ee96968d74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe7110>]}
[0m22:20:10.173445 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics.lab1_stock_price_table .............. [[32mSUCCESS 1[0m in 0.50s]
[0m22:20:10.173738 [debug] [Thread-1 (]: Finished running node model.stock_elt.lab1_stock_price_table
[0m22:20:10.174071 [debug] [Thread-1 (]: Began running node model.stock_elt.rolling_average_calc
[0m22:20:10.174356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt.lab1_stock_price_table, now model.stock_elt.rolling_average_calc)
[0m22:20:10.174548 [debug] [Thread-1 (]: Began compiling node model.stock_elt.rolling_average_calc
[0m22:20:10.175955 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt.rolling_average_calc"
[0m22:20:10.176576 [debug] [Thread-1 (]: Finished running node model.stock_elt.rolling_average_calc
[0m22:20:10.176887 [debug] [Thread-1 (]: Began running node model.stock_elt.rolling_avg_filtered
[0m22:20:10.177098 [info ] [Thread-1 (]: 2 of 2 START sql view model analytics.rolling_avg_filtered ..................... [RUN]
[0m22:20:10.177278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt.rolling_average_calc, now model.stock_elt.rolling_avg_filtered)
[0m22:20:10.177431 [debug] [Thread-1 (]: Began compiling node model.stock_elt.rolling_avg_filtered
[0m22:20:10.179536 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt.rolling_avg_filtered"
[0m22:20:10.179856 [debug] [Thread-1 (]: Began executing node model.stock_elt.rolling_avg_filtered
[0m22:20:10.181634 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_elt.rolling_avg_filtered"
[0m22:20:10.182460 [debug] [Thread-1 (]: Using snowflake connection "model.stock_elt.rolling_avg_filtered"
[0m22:20:10.182650 [debug] [Thread-1 (]: On model.stock_elt.rolling_avg_filtered: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_elt", "target_name": "dev", "node_id": "model.stock_elt.rolling_avg_filtered"} */
create or replace   view USER_DB_CATFISH.analytics.rolling_avg_filtered
  
   as (
    with __dbt__cte__rolling_average_calc as (


SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
) SELECT SYMBOL,
       DATE,
       ROLLING_AVERAGE
FROM __dbt__cte__rolling_average_calc
WHERE row_num >= 7
ORDER BY SYMBOL, DATE, row_num
  );
[0m22:20:10.734398 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.551 seconds
[0m22:20:10.736990 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e9f685c-3a70-4064-97ad-32ee96968d74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105df9390>]}
[0m22:20:10.737593 [info ] [Thread-1 (]: 2 of 2 OK created sql view model analytics.rolling_avg_filtered ................ [[32mSUCCESS 1[0m in 0.56s]
[0m22:20:10.738074 [debug] [Thread-1 (]: Finished running node model.stock_elt.rolling_avg_filtered
[0m22:20:10.739116 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:20:10.739416 [debug] [MainThread]: Connection 'model.stock_elt.rolling_avg_filtered' was left open.
[0m22:20:10.739664 [debug] [MainThread]: On model.stock_elt.rolling_avg_filtered: Close
[0m22:20:10.892360 [info ] [MainThread]: 
[0m22:20:10.893181 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.05 seconds (2.05s).
[0m22:20:10.894300 [debug] [MainThread]: Command end result
[0m22:20:10.918043 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/stock_elt/target/manifest.json
[0m22:20:10.919431 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/stock_elt/target/semantic_manifest.json
[0m22:20:10.923766 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/stock_elt/target/run_results.json
[0m22:20:10.923968 [info ] [MainThread]: 
[0m22:20:10.924176 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:20:10.924329 [info ] [MainThread]: 
[0m22:20:10.924490 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:20:10.926215 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.4571445, "process_in_blocks": "0", "process_kernel_time": 0.168229, "process_mem_max_rss": "137150464", "process_out_blocks": "0", "process_user_time": 0.908576}
[0m22:20:10.926440 [debug] [MainThread]: Command `dbt run` succeeded at 22:20:10.926389 after 2.46 seconds
[0m22:20:10.926640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b87a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106062f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059f1fd0>]}
[0m22:20:10.926835 [debug] [MainThread]: Flushing usage events
[0m22:20:11.433063 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:32:20.238607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081b57f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f03c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f03ed0>]}


============================== 22:32:20.241315 | c84c065c-226b-41b4-b889-9f823b05485e ==============================
[0m22:32:20.241315 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:32:20.241581 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt', 'log_path': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:32:20.284928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c84c065c-226b-41b4-b889-9f823b05485e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083d2c40>]}
[0m22:32:20.295609 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.082551, "process_in_blocks": "0", "process_kernel_time": 0.100341, "process_mem_max_rss": "103792640", "process_out_blocks": "0", "process_user_time": 0.506129}
[0m22:32:20.295777 [debug] [MainThread]: Command `dbt clean` succeeded at 22:32:20.295738 after 0.08 seconds
[0m22:32:20.295906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dea9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108de9ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109084f50>]}
[0m22:32:20.296028 [debug] [MainThread]: Flushing usage events
[0m22:32:20.722597 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:48:36.768428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff993c1940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff958d5eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95eac830>]}


============================== 17:48:36.771920 | 8d4296e2-43c1-4f92-903a-f18a3ac40310 ==============================
[0m17:48:36.771920 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m17:48:36.772385 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:48:36.773644 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'dbt'
[0m17:48:36.774136 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.026509833, "process_user_time": 0.817131, "process_kernel_time": 0.13018, "process_mem_max_rss": "95140", "process_out_blocks": "1066", "command_success": false, "process_in_blocks": "0"}
[0m17:48:36.774334 [debug] [MainThread]: Command `dbt run` failed at 17:48:36.774297 after 0.03 seconds
[0m17:48:36.774473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95898440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff954dacf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95407770>]}
[0m17:48:36.774615 [debug] [MainThread]: Flushing usage events
[0m17:48:37.220590 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:23:56.978771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff938a8a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93248470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff931af860>]}


============================== 19:23:56.982459 | b730a204-2b61-4b80-baf2-a472e2cdca08 ==============================
[0m19:23:56.982459 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:23:56.982862 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:23:56.984115 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'dbt'
[0m19:23:56.984706 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.026268542, "process_user_time": 0.794734, "process_kernel_time": 0.092735, "process_mem_max_rss": "94924", "process_out_blocks": "2", "command_success": false, "process_in_blocks": "0"}
[0m19:23:56.984911 [debug] [MainThread]: Command `dbt run` failed at 19:23:56.984871 after 0.03 seconds
[0m19:23:56.985058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92f0a5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92e1ea80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92faa570>]}
[0m19:23:56.985210 [debug] [MainThread]: Flushing usage events
[0m19:23:57.420202 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:26:37.144299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad28abd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac7909b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad313bc0>]}


============================== 19:26:37.148185 | 92edddef-1692-48ba-aa37-ad65cda1fe15 ==============================
[0m19:26:37.148185 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:26:37.148685 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m19:26:37.580180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92edddef-1692-48ba-aa37-ad65cda1fe15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff903a26f0>]}
[0m19:26:37.600564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92edddef-1692-48ba-aa37-ad65cda1fe15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90519820>]}
[0m19:26:37.600930 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m19:26:37.640653 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found more than one package with the name "dbt" included in this project. Package names must be unique in a project. Please rename one of these packages.
[0m19:26:37.641381 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5177674, "process_user_time": 1.770396, "process_kernel_time": 0.177939, "process_mem_max_rss": "196324", "process_in_blocks": "664", "process_out_blocks": "4", "command_success": false}
[0m19:26:37.641617 [debug] [MainThread]: Command `dbt run` failed at 19:26:37.641575 after 0.52 seconds
[0m19:26:37.641806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac97bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff900adfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff901c2180>]}
[0m19:26:37.642007 [debug] [MainThread]: Flushing usage events
[0m19:26:38.066210 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:27:48.857242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9aa9550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9e039e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7ce32f0>]}


============================== 19:27:48.861047 | d8deefed-7409-4784-b12b-bdf7ee8bc71f ==============================
[0m19:27:48.861047 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:27:48.861751 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:27:49.279586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8deefed-7409-4784-b12b-bdf7ee8bc71f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb83ed2b0>]}
[0m19:27:49.300454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8deefed-7409-4784-b12b-bdf7ee8bc71f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cbe3050>]}
[0m19:27:49.300833 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m19:27:49.338906 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found more than one package with the name "dbt" included in this project. Package names must be unique in a project. Please rename one of these packages.
[0m19:27:49.339642 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.50261587, "process_user_time": 1.825009, "process_kernel_time": 0.169372, "process_mem_max_rss": "196184", "process_out_blocks": "4", "command_success": false, "process_in_blocks": "0"}
[0m19:27:49.340066 [debug] [MainThread]: Command `dbt run` failed at 19:27:49.340021 after 0.50 seconds
[0m19:27:49.340248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8024bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb79938c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb86d4410>]}
[0m19:27:49.340444 [debug] [MainThread]: Flushing usage events
[0m19:27:49.724439 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:29:30.249390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff959a36b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98de1940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff971dd2e0>]}


============================== 19:29:30.253917 | 14fc95ac-c399-4af9-a1ab-f05a86a30347 ==============================
[0m19:29:30.253917 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:29:30.254371 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:29:30.255857 [error] [MainThread]: Encountered an error:
Runtime Error
  outputs not specified in profile 'dbt'
[0m19:29:30.256359 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.029187834, "process_user_time": 0.823924, "process_kernel_time": 0.087097, "process_mem_max_rss": "94976", "process_out_blocks": "2", "command_success": false, "process_in_blocks": "0"}
[0m19:29:30.256564 [debug] [MainThread]: Command `dbt run` failed at 19:29:30.256516 after 0.03 seconds
[0m19:29:30.256703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95b27140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff951e1880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94e51cd0>]}
[0m19:29:30.256889 [debug] [MainThread]: Flushing usage events
[0m19:29:30.694352 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:51:08.103258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8678ac60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8678ad80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85c82180>]}


============================== 19:51:08.107110 | 4903bb16-50bc-45b2-ae29-0fb804cfd941 ==============================
[0m19:51:08.107110 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:51:08.107660 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:51:08.109115 [error] [MainThread]: Encountered an error:
Runtime Error
  outputs not specified in profile 'dbt'
[0m19:51:08.109646 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.027299125, "process_user_time": 0.811612, "process_kernel_time": 0.088066, "process_mem_max_rss": "94956", "process_out_blocks": "2", "command_success": false, "process_in_blocks": "0"}
[0m19:51:08.109844 [debug] [MainThread]: Command `dbt run` failed at 19:51:08.109806 after 0.03 seconds
[0m19:51:08.109986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff862323c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86074440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff861323f0>]}
[0m19:51:08.110138 [debug] [MainThread]: Flushing usage events
[0m19:51:08.543881 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:51:55.970402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97fef980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99a139e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98a96b40>]}


============================== 19:51:55.974751 | 868d4ae0-1bd0-447a-b150-02a98e933e66 ==============================
[0m19:51:55.974751 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:51:55.975347 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:51:56.401861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '868d4ae0-1bd0-447a-b150-02a98e933e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98a49310>]}
[0m19:51:56.422293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '868d4ae0-1bd0-447a-b150-02a98e933e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c3b8140>]}
[0m19:51:56.422654 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m19:51:56.460605 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found more than one package with the name "dbt" included in this project. Package names must be unique in a project. Please rename one of these packages.
[0m19:51:56.461299 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.51168835, "process_user_time": 1.805187, "process_kernel_time": 0.185946, "process_mem_max_rss": "196228", "process_out_blocks": "4", "command_success": false, "process_in_blocks": "0"}
[0m19:51:56.461532 [debug] [MainThread]: Command `dbt run` failed at 19:51:56.461492 after 0.51 seconds
[0m19:51:56.461710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98601d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c7f1640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff980cdee0>]}
[0m19:51:56.461884 [debug] [MainThread]: Flushing usage events
[0m19:51:56.848935 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:03:58.061492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbafa1c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbc633680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba3c4bf0>]}


============================== 20:03:58.065388 | a7193df8-cc0f-4a3c-84da-1dc82489a7ae ==============================
[0m20:03:58.065388 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m20:03:58.065850 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:03:58.067160 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'lab2_profile'
[0m20:03:58.067695 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.0266215, "process_user_time": 0.815279, "process_kernel_time": 0.080027, "process_mem_max_rss": "94908", "process_out_blocks": "2", "command_success": false, "process_in_blocks": "0"}
[0m20:03:58.067899 [debug] [MainThread]: Command `dbt run` failed at 20:03:58.067860 after 0.03 seconds
[0m20:03:58.068036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbadc35f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba694590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba1c3bc0>]}
[0m20:03:58.068179 [debug] [MainThread]: Flushing usage events
[0m20:03:58.500673 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:05:53.211046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff867d6090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84b6d1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8512f4a0>]}


============================== 20:05:53.215242 | 50cca313-50cf-48fe-830a-dc36eddf6083 ==============================
[0m20:05:53.215242 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m20:05:53.215713 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:05:53.684330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50cca313-50cf-48fe-830a-dc36eddf6083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68623470>]}
[0m20:05:53.705378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50cca313-50cf-48fe-830a-dc36eddf6083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6af2ae10>]}
[0m20:05:53.705749 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m20:05:53.749940 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m20:05:53.750576 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:05:53.750980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '50cca313-50cf-48fe-830a-dc36eddf6083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff692aca10>]}
[0m20:05:54.202933 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.Lab2_dbt_Folder.marts
- models.Lab2_dbt_Folder.staging
[0m20:05:54.207622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50cca313-50cf-48fe-830a-dc36eddf6083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63168bf0>]}
[0m20:05:54.245767 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:05:54.246864 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:05:54.254494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50cca313-50cf-48fe-830a-dc36eddf6083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6802aff0>]}
[0m20:05:54.254719 [info ] [MainThread]: Found 3 models, 3 data tests, 2 sources, 458 macros
[0m20:05:54.255039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50cca313-50cf-48fe-830a-dc36eddf6083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63169670>]}
[0m20:05:54.255773 [info ] [MainThread]: 
[0m20:05:54.255971 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:05:54.256120 [info ] [MainThread]: 
[0m20:05:54.256355 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:05:54.258013 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH'
[0m20:05:54.263450 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH"
[0m20:05:54.263621 [debug] [ThreadPool]: On list_USER_DB_CATFISH: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH"} */
show terse schemas in database USER_DB_CATFISH
    limit 10000
[0m20:05:54.263765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:54.866432 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.602 seconds
[0m20:05:54.869430 [debug] [ThreadPool]: On list_USER_DB_CATFISH: Close
[0m20:05:55.031519 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH, now list_USER_DB_CATFISH_analytics)
[0m20:05:55.045565 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_analytics"
[0m20:05:55.046240 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_analytics"} */
show terse objects in USER_DB_CATFISH.analytics limit 10000
[0m20:05:55.046682 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:55.571883 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.525 seconds
[0m20:05:55.575107 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: Close
[0m20:05:55.735738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50cca313-50cf-48fe-830a-dc36eddf6083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68040fb0>]}
[0m20:05:55.749304 [debug] [Thread-1 (]: Began running node model.Lab2_dbt_Folder.lab1_stock_price_table
[0m20:05:55.750191 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics.lab1_stock_price_table ................... [RUN]
[0m20:05:55.751864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_analytics, now model.Lab2_dbt_Folder.lab1_stock_price_table)
[0m20:05:55.752281 [debug] [Thread-1 (]: Began compiling node model.Lab2_dbt_Folder.lab1_stock_price_table
[0m20:05:55.761189 [debug] [Thread-1 (]: Writing injected SQL for node "model.Lab2_dbt_Folder.lab1_stock_price_table"
[0m20:05:55.763705 [debug] [Thread-1 (]: Began executing node model.Lab2_dbt_Folder.lab1_stock_price_table
[0m20:05:55.781505 [debug] [Thread-1 (]: Writing runtime sql for node "model.Lab2_dbt_Folder.lab1_stock_price_table"
[0m20:05:55.783398 [debug] [Thread-1 (]: Using snowflake connection "model.Lab2_dbt_Folder.lab1_stock_price_table"
[0m20:05:55.783710 [debug] [Thread-1 (]: On model.Lab2_dbt_Folder.lab1_stock_price_table: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "node_id": "model.Lab2_dbt_Folder.lab1_stock_price_table"} */
create or replace   view USER_DB_CATFISH.analytics.lab1_stock_price_table
  
   as (
    SELECT *
FROM USER_DB_CATFISH.raw.lab1_stock_price_table
  );
[0m20:05:55.783970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:56.533457 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.749 seconds
[0m20:05:56.558508 [debug] [Thread-1 (]: On model.Lab2_dbt_Folder.lab1_stock_price_table: Close
[0m20:05:56.700534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50cca313-50cf-48fe-830a-dc36eddf6083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68128410>]}
[0m20:05:56.701161 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics.lab1_stock_price_table .............. [[32mSUCCESS 1[0m in 0.95s]
[0m20:05:56.701847 [debug] [Thread-1 (]: Finished running node model.Lab2_dbt_Folder.lab1_stock_price_table
[0m20:05:56.702506 [debug] [Thread-1 (]: Began running node model.Lab2_dbt_Folder.rolling_average_calc
[0m20:05:56.702810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Lab2_dbt_Folder.lab1_stock_price_table, now model.Lab2_dbt_Folder.rolling_average_calc)
[0m20:05:56.703061 [debug] [Thread-1 (]: Began compiling node model.Lab2_dbt_Folder.rolling_average_calc
[0m20:05:56.705247 [debug] [Thread-1 (]: Writing injected SQL for node "model.Lab2_dbt_Folder.rolling_average_calc"
[0m20:05:56.706900 [debug] [Thread-1 (]: Finished running node model.Lab2_dbt_Folder.rolling_average_calc
[0m20:05:56.707402 [debug] [Thread-1 (]: Began running node model.Lab2_dbt_Folder.rolling_avg_filtered
[0m20:05:56.707748 [info ] [Thread-1 (]: 2 of 2 START sql view model analytics.rolling_avg_filtered ..................... [RUN]
[0m20:05:56.708193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Lab2_dbt_Folder.rolling_average_calc, now model.Lab2_dbt_Folder.rolling_avg_filtered)
[0m20:05:56.708490 [debug] [Thread-1 (]: Began compiling node model.Lab2_dbt_Folder.rolling_avg_filtered
[0m20:05:56.710936 [debug] [Thread-1 (]: Writing injected SQL for node "model.Lab2_dbt_Folder.rolling_avg_filtered"
[0m20:05:56.712142 [debug] [Thread-1 (]: Began executing node model.Lab2_dbt_Folder.rolling_avg_filtered
[0m20:05:56.714278 [debug] [Thread-1 (]: Writing runtime sql for node "model.Lab2_dbt_Folder.rolling_avg_filtered"
[0m20:05:56.715802 [debug] [Thread-1 (]: Using snowflake connection "model.Lab2_dbt_Folder.rolling_avg_filtered"
[0m20:05:56.716038 [debug] [Thread-1 (]: On model.Lab2_dbt_Folder.rolling_avg_filtered: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "node_id": "model.Lab2_dbt_Folder.rolling_avg_filtered"} */
create or replace   view USER_DB_CATFISH.analytics.rolling_avg_filtered
  
   as (
    with __dbt__cte__rolling_average_calc as (


SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
) SELECT SYMBOL,
       DATE,
       ROLLING_AVERAGE
FROM __dbt__cte__rolling_average_calc
WHERE row_num >= 7
ORDER BY SYMBOL, DATE, row_num
  );
[0m20:05:56.716258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:57.254743 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.538 seconds
[0m20:05:57.258737 [debug] [Thread-1 (]: On model.Lab2_dbt_Folder.rolling_avg_filtered: Close
[0m20:05:57.390811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50cca313-50cf-48fe-830a-dc36eddf6083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85d7eea0>]}
[0m20:05:57.392563 [info ] [Thread-1 (]: 2 of 2 OK created sql view model analytics.rolling_avg_filtered ................ [[32mSUCCESS 1[0m in 0.68s]
[0m20:05:57.393487 [debug] [Thread-1 (]: Finished running node model.Lab2_dbt_Folder.rolling_avg_filtered
[0m20:05:57.395497 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:05:57.395992 [debug] [MainThread]: Connection 'model.Lab2_dbt_Folder.rolling_avg_filtered' was properly closed.
[0m20:05:57.396516 [info ] [MainThread]: 
[0m20:05:57.397420 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 3.14 seconds (3.14s).
[0m20:05:57.398857 [debug] [MainThread]: Command end result
[0m20:05:57.424702 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:05:57.426055 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:05:57.429764 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m20:05:57.430018 [info ] [MainThread]: 
[0m20:05:57.430496 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:05:57.430773 [info ] [MainThread]: 
[0m20:05:57.430998 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:05:57.431707 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.241034, "process_user_time": 2.6508, "process_kernel_time": 0.205061, "process_mem_max_rss": "212120", "process_in_blocks": "40", "process_out_blocks": "2772"}
[0m20:05:57.432023 [debug] [MainThread]: Command `dbt run` succeeded at 20:05:57.431955 after 4.24 seconds
[0m20:05:57.432274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84bb7860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63000080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84e2ef90>]}
[0m20:05:57.432561 [debug] [MainThread]: Flushing usage events
[0m20:05:57.911760 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:05:59.504798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e7d35f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c77f080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dcadca0>]}


============================== 20:05:59.508003 | f9584a19-1c3e-426e-8a1c-bf6236f625e4 ==============================
[0m20:05:59.508003 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m20:05:59.508513 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:05:59.905971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9584a19-1c3e-426e-8a1c-bf6236f625e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5bd35790>]}
[0m20:05:59.927162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9584a19-1c3e-426e-8a1c-bf6236f625e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cdb4500>]}
[0m20:05:59.927624 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m20:05:59.966487 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m20:06:00.021514 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:06:00.021769 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:06:00.023955 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.Lab2_dbt_Folder.marts
- models.Lab2_dbt_Folder.staging
[0m20:06:00.039035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9584a19-1c3e-426e-8a1c-bf6236f625e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5b907890>]}
[0m20:06:00.076278 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:06:00.077109 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:06:00.089817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9584a19-1c3e-426e-8a1c-bf6236f625e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5b7008f0>]}
[0m20:06:00.090074 [info ] [MainThread]: Found 3 models, 3 data tests, 2 sources, 458 macros
[0m20:06:00.090392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9584a19-1c3e-426e-8a1c-bf6236f625e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5b913e90>]}
[0m20:06:00.091146 [info ] [MainThread]: 
[0m20:06:00.091383 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:06:00.091546 [info ] [MainThread]: 
[0m20:06:00.091783 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:06:00.093510 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH_analytics'
[0m20:06:00.100215 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_analytics"
[0m20:06:00.100394 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_analytics"} */
show terse objects in USER_DB_CATFISH.analytics limit 10000
[0m20:06:00.100539 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:06:00.730800 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.630 seconds
[0m20:06:00.733304 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: Close
[0m20:06:00.916078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9584a19-1c3e-426e-8a1c-bf6236f625e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5bc75070>]}
[0m20:06:00.926084 [debug] [Thread-1 (]: Began running node test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17
[0m20:06:00.926479 [info ] [Thread-1 (]: 1 of 3 START test not_null_rolling_average_calc_DATE ........................... [RUN]
[0m20:06:00.927247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_analytics, now test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17)
[0m20:06:00.927519 [debug] [Thread-1 (]: Began compiling node test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17
[0m20:06:00.940903 [debug] [Thread-1 (]: Writing injected SQL for node "test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17"
[0m20:06:00.942452 [debug] [Thread-1 (]: Writing injected SQL for node "test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17"
[0m20:06:00.943601 [debug] [Thread-1 (]: Began executing node test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17
[0m20:06:00.954691 [debug] [Thread-1 (]: Writing runtime sql for node "test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17"
[0m20:06:00.955991 [debug] [Thread-1 (]: Using snowflake connection "test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17"
[0m20:06:00.956217 [debug] [Thread-1 (]: On test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "node_id": "test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__rolling_average_calc as (


SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
) select DATE
from __dbt__cte__rolling_average_calc
where DATE is null



      
    ) dbt_internal_test
[0m20:06:00.956420 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:02.130808 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.174 seconds
[0m20:06:02.147138 [debug] [Thread-1 (]: On test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17: Close
[0m20:06:02.302491 [info ] [Thread-1 (]: 1 of 3 PASS not_null_rolling_average_calc_DATE ................................. [[32mPASS[0m in 1.37s]
[0m20:06:02.305184 [debug] [Thread-1 (]: Finished running node test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17
[0m20:06:02.306156 [debug] [Thread-1 (]: Began running node test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6
[0m20:06:02.306834 [info ] [Thread-1 (]: 2 of 3 START test not_null_rolling_average_calc_SYMBOL ......................... [RUN]
[0m20:06:02.308076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17, now test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6)
[0m20:06:02.308733 [debug] [Thread-1 (]: Began compiling node test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6
[0m20:06:02.316120 [debug] [Thread-1 (]: Writing injected SQL for node "test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6"
[0m20:06:02.318757 [debug] [Thread-1 (]: Began executing node test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6
[0m20:06:02.321338 [debug] [Thread-1 (]: Writing runtime sql for node "test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6"
[0m20:06:02.323073 [debug] [Thread-1 (]: Using snowflake connection "test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6"
[0m20:06:02.323473 [debug] [Thread-1 (]: On test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "node_id": "test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__rolling_average_calc as (


SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
) select SYMBOL
from __dbt__cte__rolling_average_calc
where SYMBOL is null



      
    ) dbt_internal_test
[0m20:06:02.323912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:03.088806 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.764 seconds
[0m20:06:03.093490 [debug] [Thread-1 (]: On test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6: Close
[0m20:06:03.265560 [info ] [Thread-1 (]: 2 of 3 PASS not_null_rolling_average_calc_SYMBOL ............................... [[32mPASS[0m in 0.96s]
[0m20:06:03.267333 [debug] [Thread-1 (]: Finished running node test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6
[0m20:06:03.268077 [debug] [Thread-1 (]: Began running node test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28
[0m20:06:03.268717 [info ] [Thread-1 (]: 3 of 3 START test not_null_rolling_average_calc_row_num ........................ [RUN]
[0m20:06:03.269895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6, now test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28)
[0m20:06:03.270617 [debug] [Thread-1 (]: Began compiling node test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28
[0m20:06:03.276868 [debug] [Thread-1 (]: Writing injected SQL for node "test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28"
[0m20:06:03.279232 [debug] [Thread-1 (]: Began executing node test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28
[0m20:06:03.282361 [debug] [Thread-1 (]: Writing runtime sql for node "test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28"
[0m20:06:03.284753 [debug] [Thread-1 (]: Using snowflake connection "test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28"
[0m20:06:03.285274 [debug] [Thread-1 (]: On test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "node_id": "test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__rolling_average_calc as (


SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
) select row_num
from __dbt__cte__rolling_average_calc
where row_num is null



      
    ) dbt_internal_test
[0m20:06:03.285567 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:03.906600 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.621 seconds
[0m20:06:03.910849 [debug] [Thread-1 (]: On test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28: Close
[0m20:06:04.064882 [info ] [Thread-1 (]: 3 of 3 PASS not_null_rolling_average_calc_row_num .............................. [[32mPASS[0m in 0.79s]
[0m20:06:04.067396 [debug] [Thread-1 (]: Finished running node test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28
[0m20:06:04.070036 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:06:04.070642 [debug] [MainThread]: Connection 'test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28' was properly closed.
[0m20:06:04.071344 [info ] [MainThread]: 
[0m20:06:04.072582 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 3.98 seconds (3.98s).
[0m20:06:04.074189 [debug] [MainThread]: Command end result
[0m20:06:04.101205 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:06:04.103277 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:06:04.108572 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m20:06:04.108786 [info ] [MainThread]: 
[0m20:06:04.109233 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:06:04.109569 [info ] [MainThread]: 
[0m20:06:04.109810 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:06:04.110689 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.6260247, "process_user_time": 2.179722, "process_kernel_time": 0.155408, "process_mem_max_rss": "210396", "process_in_blocks": "16", "process_out_blocks": "1876"}
[0m20:06:04.111064 [debug] [MainThread]: Command `dbt test` succeeded at 20:06:04.111004 after 4.63 seconds
[0m20:06:04.111318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80666a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cf30590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c5a70e0>]}
[0m20:06:04.111555 [debug] [MainThread]: Flushing usage events
[0m20:06:04.492640 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:06:06.253703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa31458e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa268ae40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4f57740>]}


============================== 20:06:06.257406 | 901e96fc-4e9d-447d-bbdb-5a9b53a52086 ==============================
[0m20:06:06.257406 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m20:06:06.257860 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:06:06.646609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '901e96fc-4e9d-447d-bbdb-5a9b53a52086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff829e1ee0>]}
[0m20:06:06.667582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '901e96fc-4e9d-447d-bbdb-5a9b53a52086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83572d50>]}
[0m20:06:06.667934 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m20:06:06.708650 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m20:06:06.766517 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:06:06.766773 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:06:06.769086 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.Lab2_dbt_Folder.staging
- models.Lab2_dbt_Folder.marts
[0m20:06:06.786545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '901e96fc-4e9d-447d-bbdb-5a9b53a52086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81e14ad0>]}
[0m20:06:06.824367 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:06:06.825301 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:06:06.831409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '901e96fc-4e9d-447d-bbdb-5a9b53a52086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81bf8170>]}
[0m20:06:06.831623 [info ] [MainThread]: Found 3 models, 3 data tests, 2 sources, 458 macros
[0m20:06:06.831973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '901e96fc-4e9d-447d-bbdb-5a9b53a52086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff824457f0>]}
[0m20:06:06.832601 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:06:06.833438 [debug] [MainThread]: Command end result
[0m20:06:06.844330 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:06:06.845036 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:06:06.846327 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m20:06:06.846787 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.6136298, "process_user_time": 1.952767, "process_kernel_time": 0.11841, "process_mem_max_rss": "200932", "process_out_blocks": "1828", "process_in_blocks": "0"}
[0m20:06:06.847030 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:06:06.846987 after 0.61 seconds
[0m20:06:06.847192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa22815e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2d9c1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8da5ac30>]}
[0m20:06:06.847340 [debug] [MainThread]: Flushing usage events
[0m20:06:07.231465 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:29:43.795992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ea1dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0033b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e7df020>]}


============================== 22:29:43.801664 | 65ca4005-ce7d-4b65-986d-ba43c577722e ==============================
[0m22:29:43.801664 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m22:29:43.801995 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:29:44.284720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65ca4005-ce7d-4b65-986d-ba43c577722e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83ff3ce0>]}
[0m22:29:44.305570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65ca4005-ce7d-4b65-986d-ba43c577722e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81a8b6e0>]}
[0m22:29:44.305935 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m22:29:44.347156 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m22:29:44.397980 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:29:44.398342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '65ca4005-ce7d-4b65-986d-ba43c577722e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e1102f0>]}
[0m22:29:44.841221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65ca4005-ce7d-4b65-986d-ba43c577722e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff812fb4d0>]}
[0m22:29:44.911298 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m22:29:44.912711 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m22:29:44.918834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65ca4005-ce7d-4b65-986d-ba43c577722e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5fe64080>]}
[0m22:29:44.919041 [info ] [MainThread]: Found 3 models, 3 data tests, 2 sources, 458 macros
[0m22:29:44.919397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65ca4005-ce7d-4b65-986d-ba43c577722e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5fe4ed50>]}
[0m22:29:44.920095 [info ] [MainThread]: 
[0m22:29:44.920335 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:29:44.920533 [info ] [MainThread]: 
[0m22:29:44.920839 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:29:44.922524 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH'
[0m22:29:44.928289 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH"
[0m22:29:44.928458 [debug] [ThreadPool]: On list_USER_DB_CATFISH: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH"} */
show terse schemas in database USER_DB_CATFISH
    limit 10000
[0m22:29:44.928585 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:29:45.324476 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.396 seconds
[0m22:29:45.327815 [debug] [ThreadPool]: On list_USER_DB_CATFISH: Close
[0m22:29:45.441590 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH, now list_USER_DB_CATFISH_analytics)
[0m22:29:45.448422 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_analytics"
[0m22:29:45.448758 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_analytics"} */
show terse objects in USER_DB_CATFISH.analytics limit 10000
[0m22:29:45.449010 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:29:45.791930 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.343 seconds
[0m22:29:45.795197 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: Close
[0m22:29:45.931433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65ca4005-ce7d-4b65-986d-ba43c577722e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa00335f0>]}
[0m22:29:45.944974 [debug] [Thread-1 (]: Began running node model.Lab2_dbt_Folder.lab1_stock_price_table
[0m22:29:45.945892 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics.lab1_stock_price_table ................... [RUN]
[0m22:29:45.946962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_analytics, now model.Lab2_dbt_Folder.lab1_stock_price_table)
[0m22:29:45.947370 [debug] [Thread-1 (]: Began compiling node model.Lab2_dbt_Folder.lab1_stock_price_table
[0m22:29:45.955076 [debug] [Thread-1 (]: Writing injected SQL for node "model.Lab2_dbt_Folder.lab1_stock_price_table"
[0m22:29:45.957451 [debug] [Thread-1 (]: Began executing node model.Lab2_dbt_Folder.lab1_stock_price_table
[0m22:29:45.977110 [debug] [Thread-1 (]: Writing runtime sql for node "model.Lab2_dbt_Folder.lab1_stock_price_table"
[0m22:29:45.978692 [debug] [Thread-1 (]: Using snowflake connection "model.Lab2_dbt_Folder.lab1_stock_price_table"
[0m22:29:45.978931 [debug] [Thread-1 (]: On model.Lab2_dbt_Folder.lab1_stock_price_table: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "node_id": "model.Lab2_dbt_Folder.lab1_stock_price_table"} */
create or replace   view USER_DB_CATFISH.analytics.lab1_stock_price_table
  
   as (
    SELECT *
FROM USER_DB_CATFISH.raw.lab1_stock_price_table
  );
[0m22:29:45.979108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:46.556714 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.577 seconds
[0m22:29:46.578572 [debug] [Thread-1 (]: On model.Lab2_dbt_Folder.lab1_stock_price_table: Close
[0m22:29:46.702878 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65ca4005-ce7d-4b65-986d-ba43c577722e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81122e70>]}
[0m22:29:46.703725 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics.lab1_stock_price_table .............. [[32mSUCCESS 1[0m in 0.75s]
[0m22:29:46.704304 [debug] [Thread-1 (]: Finished running node model.Lab2_dbt_Folder.lab1_stock_price_table
[0m22:29:46.705208 [debug] [Thread-1 (]: Began running node model.Lab2_dbt_Folder.rolling_average_calc
[0m22:29:46.705604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Lab2_dbt_Folder.lab1_stock_price_table, now model.Lab2_dbt_Folder.rolling_average_calc)
[0m22:29:46.705959 [debug] [Thread-1 (]: Began compiling node model.Lab2_dbt_Folder.rolling_average_calc
[0m22:29:46.708932 [debug] [Thread-1 (]: Writing injected SQL for node "model.Lab2_dbt_Folder.rolling_average_calc"
[0m22:29:46.710480 [debug] [Thread-1 (]: Finished running node model.Lab2_dbt_Folder.rolling_average_calc
[0m22:29:46.711040 [debug] [Thread-1 (]: Began running node model.Lab2_dbt_Folder.rolling_avg_filtered
[0m22:29:46.711379 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics.rolling_avg_filtered .................... [RUN]
[0m22:29:46.711944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Lab2_dbt_Folder.rolling_average_calc, now model.Lab2_dbt_Folder.rolling_avg_filtered)
[0m22:29:46.712178 [debug] [Thread-1 (]: Began compiling node model.Lab2_dbt_Folder.rolling_avg_filtered
[0m22:29:46.714965 [debug] [Thread-1 (]: Writing injected SQL for node "model.Lab2_dbt_Folder.rolling_avg_filtered"
[0m22:29:46.715746 [debug] [Thread-1 (]: Began executing node model.Lab2_dbt_Folder.rolling_avg_filtered
[0m22:29:46.729453 [debug] [Thread-1 (]: Writing runtime sql for node "model.Lab2_dbt_Folder.rolling_avg_filtered"
[0m22:29:46.730625 [debug] [Thread-1 (]: Using snowflake connection "model.Lab2_dbt_Folder.rolling_avg_filtered"
[0m22:29:46.730830 [debug] [Thread-1 (]: On model.Lab2_dbt_Folder.rolling_avg_filtered: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "node_id": "model.Lab2_dbt_Folder.rolling_avg_filtered"} */
create or replace transient table USER_DB_CATFISH.analytics.rolling_avg_filtered
         as
        (with __dbt__cte__rolling_average_calc as (


SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
) SELECT SYMBOL,
       DATE,
       ROLLING_AVERAGE
FROM __dbt__cte__rolling_average_calc
WHERE row_num >= 7
ORDER BY SYMBOL, DATE, row_num
        );
[0m22:29:46.731046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:48.154422 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.423 seconds
[0m22:29:48.157847 [debug] [Thread-1 (]: On model.Lab2_dbt_Folder.rolling_avg_filtered: Close
[0m22:29:48.274195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65ca4005-ce7d-4b65-986d-ba43c577722e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eede8d0>]}
[0m22:29:48.276036 [info ] [Thread-1 (]: 2 of 2 OK created sql table model analytics.rolling_avg_filtered ............... [[32mSUCCESS 1[0m in 1.56s]
[0m22:29:48.278086 [debug] [Thread-1 (]: Finished running node model.Lab2_dbt_Folder.rolling_avg_filtered
[0m22:29:48.280678 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:29:48.281311 [debug] [MainThread]: Connection 'model.Lab2_dbt_Folder.rolling_avg_filtered' was properly closed.
[0m22:29:48.281932 [info ] [MainThread]: 
[0m22:29:48.282920 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 3.36 seconds (3.36s).
[0m22:29:48.284393 [debug] [MainThread]: Command end result
[0m22:29:48.310814 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m22:29:48.312243 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m22:29:48.316010 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m22:29:48.316212 [info ] [MainThread]: 
[0m22:29:48.316731 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:29:48.317054 [info ] [MainThread]: 
[0m22:29:48.317494 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:29:48.318440 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.5456433, "process_user_time": 2.681052, "process_kernel_time": 0.247606, "process_mem_max_rss": "212188", "process_out_blocks": "2771", "process_in_blocks": "0"}
[0m22:29:48.318753 [debug] [MainThread]: Command `dbt run` succeeded at 22:29:48.318700 after 4.55 seconds
[0m22:29:48.318968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e7df020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e756b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5fd0afc0>]}
[0m22:29:48.319169 [debug] [MainThread]: Flushing usage events
[0m22:29:48.746886 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:29:50.495094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80df19d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f213ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ce1f2f0>]}


============================== 22:29:50.497994 | 4afd5dc9-9dd2-42db-a172-6711bff4c2a4 ==============================
[0m22:29:50.497994 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m22:29:50.498409 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:29:50.876630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4afd5dc9-9dd2-42db-a172-6711bff4c2a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61172ae0>]}
[0m22:29:50.896521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4afd5dc9-9dd2-42db-a172-6711bff4c2a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff615ac860>]}
[0m22:29:50.896916 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m22:29:50.934135 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m22:29:50.987064 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:29:50.987287 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:29:51.004178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4afd5dc9-9dd2-42db-a172-6711bff4c2a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff612f24e0>]}
[0m22:29:51.040584 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m22:29:51.041373 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m22:29:51.051952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4afd5dc9-9dd2-42db-a172-6711bff4c2a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff602bcf20>]}
[0m22:29:51.052190 [info ] [MainThread]: Found 3 models, 3 data tests, 2 sources, 458 macros
[0m22:29:51.052537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4afd5dc9-9dd2-42db-a172-6711bff4c2a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff608968a0>]}
[0m22:29:51.053252 [info ] [MainThread]: 
[0m22:29:51.053487 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:29:51.053738 [info ] [MainThread]: 
[0m22:29:51.054032 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:29:51.055676 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH_analytics'
[0m22:29:51.062399 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_analytics"
[0m22:29:51.062572 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_analytics"} */
show terse objects in USER_DB_CATFISH.analytics limit 10000
[0m22:29:51.062694 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:29:51.477798 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.415 seconds
[0m22:29:51.479883 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: Close
[0m22:29:51.618724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4afd5dc9-9dd2-42db-a172-6711bff4c2a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60156990>]}
[0m22:29:51.629308 [debug] [Thread-1 (]: Began running node test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17
[0m22:29:51.629757 [info ] [Thread-1 (]: 1 of 3 START test not_null_rolling_average_calc_DATE ........................... [RUN]
[0m22:29:51.630528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_analytics, now test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17)
[0m22:29:51.630886 [debug] [Thread-1 (]: Began compiling node test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17
[0m22:29:51.645135 [debug] [Thread-1 (]: Writing injected SQL for node "test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17"
[0m22:29:51.646434 [debug] [Thread-1 (]: Writing injected SQL for node "test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17"
[0m22:29:51.647312 [debug] [Thread-1 (]: Began executing node test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17
[0m22:29:51.658110 [debug] [Thread-1 (]: Writing runtime sql for node "test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17"
[0m22:29:51.659181 [debug] [Thread-1 (]: Using snowflake connection "test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17"
[0m22:29:51.659411 [debug] [Thread-1 (]: On test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "node_id": "test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__rolling_average_calc as (


SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
) select DATE
from __dbt__cte__rolling_average_calc
where DATE is null



      
    ) dbt_internal_test
[0m22:29:51.659619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:52.067470 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.407 seconds
[0m22:29:52.080937 [debug] [Thread-1 (]: On test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17: Close
[0m22:29:52.199010 [info ] [Thread-1 (]: 1 of 3 PASS not_null_rolling_average_calc_DATE ................................. [[32mPASS[0m in 0.57s]
[0m22:29:52.200968 [debug] [Thread-1 (]: Finished running node test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17
[0m22:29:52.201750 [debug] [Thread-1 (]: Began running node test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6
[0m22:29:52.202389 [info ] [Thread-1 (]: 2 of 3 START test not_null_rolling_average_calc_SYMBOL ......................... [RUN]
[0m22:29:52.203472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17, now test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6)
[0m22:29:52.204120 [debug] [Thread-1 (]: Began compiling node test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6
[0m22:29:52.211525 [debug] [Thread-1 (]: Writing injected SQL for node "test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6"
[0m22:29:52.213411 [debug] [Thread-1 (]: Began executing node test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6
[0m22:29:52.216284 [debug] [Thread-1 (]: Writing runtime sql for node "test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6"
[0m22:29:52.218087 [debug] [Thread-1 (]: Using snowflake connection "test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6"
[0m22:29:52.218500 [debug] [Thread-1 (]: On test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "node_id": "test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__rolling_average_calc as (


SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
) select SYMBOL
from __dbt__cte__rolling_average_calc
where SYMBOL is null



      
    ) dbt_internal_test
[0m22:29:52.218914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:52.735868 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.517 seconds
[0m22:29:52.737859 [debug] [Thread-1 (]: On test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6: Close
[0m22:29:52.844196 [info ] [Thread-1 (]: 2 of 3 PASS not_null_rolling_average_calc_SYMBOL ............................... [[32mPASS[0m in 0.64s]
[0m22:29:52.845410 [debug] [Thread-1 (]: Finished running node test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6
[0m22:29:52.846077 [debug] [Thread-1 (]: Began running node test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28
[0m22:29:52.846662 [info ] [Thread-1 (]: 3 of 3 START test not_null_rolling_average_calc_row_num ........................ [RUN]
[0m22:29:52.847541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6, now test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28)
[0m22:29:52.848020 [debug] [Thread-1 (]: Began compiling node test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28
[0m22:29:52.855130 [debug] [Thread-1 (]: Writing injected SQL for node "test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28"
[0m22:29:52.856641 [debug] [Thread-1 (]: Began executing node test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28
[0m22:29:52.859576 [debug] [Thread-1 (]: Writing runtime sql for node "test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28"
[0m22:29:52.861131 [debug] [Thread-1 (]: Using snowflake connection "test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28"
[0m22:29:52.861495 [debug] [Thread-1 (]: On test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "node_id": "test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__rolling_average_calc as (


SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
) select row_num
from __dbt__cte__rolling_average_calc
where row_num is null



      
    ) dbt_internal_test
[0m22:29:52.861827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:53.267031 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.405 seconds
[0m22:29:53.272018 [debug] [Thread-1 (]: On test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28: Close
[0m22:29:53.401623 [info ] [Thread-1 (]: 3 of 3 PASS not_null_rolling_average_calc_row_num .............................. [[32mPASS[0m in 0.55s]
[0m22:29:53.403472 [debug] [Thread-1 (]: Finished running node test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28
[0m22:29:53.405948 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:29:53.406512 [debug] [MainThread]: Connection 'test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28' was properly closed.
[0m22:29:53.407077 [info ] [MainThread]: 
[0m22:29:53.407861 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 2.35 seconds (2.35s).
[0m22:29:53.409251 [debug] [MainThread]: Command end result
[0m22:29:53.437397 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m22:29:53.438819 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m22:29:53.443192 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m22:29:53.443433 [info ] [MainThread]: 
[0m22:29:53.443858 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:29:53.444075 [info ] [MainThread]: 
[0m22:29:53.444257 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:29:53.444881 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.9700603, "process_user_time": 2.157372, "process_kernel_time": 0.118459, "process_mem_max_rss": "210368", "process_out_blocks": "1875", "process_in_blocks": "0"}
[0m22:29:53.445169 [debug] [MainThread]: Command `dbt test` succeeded at 22:29:53.445117 after 2.97 seconds
[0m22:29:53.445392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81176a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60508560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d6c3020>]}
[0m22:29:53.445611 [debug] [MainThread]: Flushing usage events
[0m22:29:53.796986 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:29:55.818094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d0135c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cc951f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ce0e210>]}


============================== 22:29:55.821673 | eb000b9b-1ff8-4207-b26e-14f13c9fb110 ==============================
[0m22:29:55.821673 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m22:29:55.822123 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:29:56.185215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb000b9b-1ff8-4207-b26e-14f13c9fb110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e4cd2e0>]}
[0m22:29:56.205771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb000b9b-1ff8-4207-b26e-14f13c9fb110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff627be420>]}
[0m22:29:56.206145 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m22:29:56.244797 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m22:29:56.296838 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:29:56.297081 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:29:56.314390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb000b9b-1ff8-4207-b26e-14f13c9fb110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5bced400>]}
[0m22:29:56.351935 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m22:29:56.352812 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m22:29:56.358583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb000b9b-1ff8-4207-b26e-14f13c9fb110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5bad8ef0>]}
[0m22:29:56.358798 [info ] [MainThread]: Found 3 models, 3 data tests, 2 sources, 458 macros
[0m22:29:56.359131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb000b9b-1ff8-4207-b26e-14f13c9fb110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5b9cc8f0>]}
[0m22:29:56.359783 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:29:56.360618 [debug] [MainThread]: Command end result
[0m22:29:56.371521 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m22:29:56.372204 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m22:29:56.373515 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m22:29:56.373918 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.5752157, "process_user_time": 1.868142, "process_kernel_time": 0.106178, "process_mem_max_rss": "200948", "process_out_blocks": "1827", "process_in_blocks": "0"}
[0m22:29:56.374129 [debug] [MainThread]: Command `dbt snapshot` succeeded at 22:29:56.374090 after 0.58 seconds
[0m22:29:56.374303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c3714f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c58a180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62792ea0>]}
[0m22:29:56.374462 [debug] [MainThread]: Flushing usage events
[0m22:29:56.730693 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:16:09.396533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9965f620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ac260f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98cccec0>]}


============================== 02:16:09.400776 | e4e8a580-9cbe-4717-b981-d9f4a4a020d4 ==============================
[0m02:16:09.400776 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m02:16:09.401209 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:16:09.860905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4e8a580-9cbe-4717-b981-d9f4a4a020d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff992884d0>]}
[0m02:16:09.881320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4e8a580-9cbe-4717-b981-d9f4a4a020d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c265eb0>]}
[0m02:16:09.881698 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m02:16:09.920664 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m02:16:09.976084 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:16:09.976314 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:16:09.993641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4e8a580-9cbe-4717-b981-d9f4a4a020d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77eabe60>]}
[0m02:16:10.031872 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m02:16:10.033002 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m02:16:10.040907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4e8a580-9cbe-4717-b981-d9f4a4a020d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77fabcb0>]}
[0m02:16:10.041212 [info ] [MainThread]: Found 3 models, 3 data tests, 2 sources, 458 macros
[0m02:16:10.041593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4e8a580-9cbe-4717-b981-d9f4a4a020d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d239700>]}
[0m02:16:10.042447 [info ] [MainThread]: 
[0m02:16:10.042674 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:16:10.042873 [info ] [MainThread]: 
[0m02:16:10.043226 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:16:10.045039 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH'
[0m02:16:10.051652 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH"
[0m02:16:10.051841 [debug] [ThreadPool]: On list_USER_DB_CATFISH: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH"} */
show terse schemas in database USER_DB_CATFISH
    limit 10000
[0m02:16:10.051992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:16:10.611057 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.559 seconds
[0m02:16:10.614673 [debug] [ThreadPool]: On list_USER_DB_CATFISH: Close
[0m02:16:10.767863 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH, now list_USER_DB_CATFISH_analytics)
[0m02:16:10.780839 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_analytics"
[0m02:16:10.781588 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_analytics"} */
show terse objects in USER_DB_CATFISH.analytics limit 10000
[0m02:16:10.782100 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:16:11.183128 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.401 seconds
[0m02:16:11.185316 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: Close
[0m02:16:11.332049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4e8a580-9cbe-4717-b981-d9f4a4a020d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a551eb0>]}
[0m02:16:11.345993 [debug] [Thread-1 (]: Began running node model.Lab2_dbt_Folder.lab1_stock_price_table
[0m02:16:11.346919 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics.lab1_stock_price_table ................... [RUN]
[0m02:16:11.348353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_analytics, now model.Lab2_dbt_Folder.lab1_stock_price_table)
[0m02:16:11.348765 [debug] [Thread-1 (]: Began compiling node model.Lab2_dbt_Folder.lab1_stock_price_table
[0m02:16:11.356255 [debug] [Thread-1 (]: Writing injected SQL for node "model.Lab2_dbt_Folder.lab1_stock_price_table"
[0m02:16:11.358564 [debug] [Thread-1 (]: Began executing node model.Lab2_dbt_Folder.lab1_stock_price_table
[0m02:16:11.377341 [debug] [Thread-1 (]: Writing runtime sql for node "model.Lab2_dbt_Folder.lab1_stock_price_table"
[0m02:16:11.378373 [debug] [Thread-1 (]: Using snowflake connection "model.Lab2_dbt_Folder.lab1_stock_price_table"
[0m02:16:11.378606 [debug] [Thread-1 (]: On model.Lab2_dbt_Folder.lab1_stock_price_table: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "node_id": "model.Lab2_dbt_Folder.lab1_stock_price_table"} */
create or replace   view USER_DB_CATFISH.analytics.lab1_stock_price_table
  
   as (
    SELECT *
FROM USER_DB_CATFISH.raw.lab1_stock_price_table
  );
[0m02:16:11.378814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:16:12.054488 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.675 seconds
[0m02:16:12.080230 [debug] [Thread-1 (]: On model.Lab2_dbt_Folder.lab1_stock_price_table: Close
[0m02:16:12.212369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4e8a580-9cbe-4717-b981-d9f4a4a020d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c264ad0>]}
[0m02:16:12.213202 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics.lab1_stock_price_table .............. [[32mSUCCESS 1[0m in 0.86s]
[0m02:16:12.214047 [debug] [Thread-1 (]: Finished running node model.Lab2_dbt_Folder.lab1_stock_price_table
[0m02:16:12.214763 [debug] [Thread-1 (]: Began running node model.Lab2_dbt_Folder.rolling_average_calc
[0m02:16:12.215087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Lab2_dbt_Folder.lab1_stock_price_table, now model.Lab2_dbt_Folder.rolling_average_calc)
[0m02:16:12.215309 [debug] [Thread-1 (]: Began compiling node model.Lab2_dbt_Folder.rolling_average_calc
[0m02:16:12.218453 [debug] [Thread-1 (]: Writing injected SQL for node "model.Lab2_dbt_Folder.rolling_average_calc"
[0m02:16:12.219690 [debug] [Thread-1 (]: Finished running node model.Lab2_dbt_Folder.rolling_average_calc
[0m02:16:12.220088 [debug] [Thread-1 (]: Began running node model.Lab2_dbt_Folder.rolling_avg_filtered
[0m02:16:12.220415 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics.rolling_avg_filtered .................... [RUN]
[0m02:16:12.220981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Lab2_dbt_Folder.rolling_average_calc, now model.Lab2_dbt_Folder.rolling_avg_filtered)
[0m02:16:12.221257 [debug] [Thread-1 (]: Began compiling node model.Lab2_dbt_Folder.rolling_avg_filtered
[0m02:16:12.223363 [debug] [Thread-1 (]: Writing injected SQL for node "model.Lab2_dbt_Folder.rolling_avg_filtered"
[0m02:16:12.224210 [debug] [Thread-1 (]: Began executing node model.Lab2_dbt_Folder.rolling_avg_filtered
[0m02:16:12.234979 [debug] [Thread-1 (]: Writing runtime sql for node "model.Lab2_dbt_Folder.rolling_avg_filtered"
[0m02:16:12.236938 [debug] [Thread-1 (]: Using snowflake connection "model.Lab2_dbt_Folder.rolling_avg_filtered"
[0m02:16:12.237405 [debug] [Thread-1 (]: On model.Lab2_dbt_Folder.rolling_avg_filtered: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "node_id": "model.Lab2_dbt_Folder.rolling_avg_filtered"} */
create or replace transient table USER_DB_CATFISH.analytics.rolling_avg_filtered
         as
        (with __dbt__cte__rolling_average_calc as (


SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
) SELECT SYMBOL,
       DATE,
       ROLLING_AVERAGE
FROM __dbt__cte__rolling_average_calc
WHERE row_num >= 7
ORDER BY SYMBOL, DATE, row_num
        );
[0m02:16:12.240429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:16:13.558778 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.318 seconds
[0m02:16:13.561327 [debug] [Thread-1 (]: On model.Lab2_dbt_Folder.rolling_avg_filtered: Close
[0m02:16:13.698789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4e8a580-9cbe-4717-b981-d9f4a4a020d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99a8abd0>]}
[0m02:16:13.700010 [info ] [Thread-1 (]: 2 of 2 OK created sql table model analytics.rolling_avg_filtered ............... [[32mSUCCESS 1[0m in 1.48s]
[0m02:16:13.703883 [debug] [Thread-1 (]: Finished running node model.Lab2_dbt_Folder.rolling_avg_filtered
[0m02:16:13.707016 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:16:13.707725 [debug] [MainThread]: Connection 'model.Lab2_dbt_Folder.rolling_avg_filtered' was properly closed.
[0m02:16:13.708312 [info ] [MainThread]: 
[0m02:16:13.710886 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 3.67 seconds (3.67s).
[0m02:16:13.714895 [debug] [MainThread]: Command end result
[0m02:16:13.742439 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m02:16:13.744356 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m02:16:13.748495 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m02:16:13.748706 [info ] [MainThread]: 
[0m02:16:13.749288 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:16:13.749550 [info ] [MainThread]: 
[0m02:16:13.749803 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m02:16:13.750891 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.3772745, "process_user_time": 2.169451, "process_kernel_time": 0.29765, "process_mem_max_rss": "208268", "process_out_blocks": "1860", "process_in_blocks": "0"}
[0m02:16:13.751314 [debug] [MainThread]: Command `dbt run` succeeded at 02:16:13.751258 after 4.38 seconds
[0m02:16:13.751594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98ac64e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98cccec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ecbe150>]}
[0m02:16:13.751803 [debug] [MainThread]: Flushing usage events
[0m02:16:14.198854 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:16:16.372172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb145b080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0c4d220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0c4c830>]}


============================== 02:16:16.375212 | ac6ee59f-2c61-448f-a32d-43d23be63373 ==============================
[0m02:16:16.375212 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m02:16:16.375674 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:16:16.748214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac6ee59f-2c61-448f-a32d-43d23be63373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff946d7b00>]}
[0m02:16:16.768072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac6ee59f-2c61-448f-a32d-43d23be63373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95c405c0>]}
[0m02:16:16.768703 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m02:16:16.807943 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m02:16:16.861894 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:16:16.862132 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:16:16.878929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac6ee59f-2c61-448f-a32d-43d23be63373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff942cd010>]}
[0m02:16:16.915545 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m02:16:16.916344 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m02:16:16.927113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac6ee59f-2c61-448f-a32d-43d23be63373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fd9cdd0>]}
[0m02:16:16.927355 [info ] [MainThread]: Found 3 models, 3 data tests, 2 sources, 458 macros
[0m02:16:16.927706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac6ee59f-2c61-448f-a32d-43d23be63373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fd60680>]}
[0m02:16:16.928478 [info ] [MainThread]: 
[0m02:16:16.928738 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:16:16.928912 [info ] [MainThread]: 
[0m02:16:16.929151 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:16:16.930887 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH_analytics'
[0m02:16:16.937391 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_analytics"
[0m02:16:16.937569 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_analytics"} */
show terse objects in USER_DB_CATFISH.analytics limit 10000
[0m02:16:16.937724 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:16:17.443742 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.506 seconds
[0m02:16:17.447176 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: Close
[0m02:16:17.578024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac6ee59f-2c61-448f-a32d-43d23be63373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fd68500>]}
[0m02:16:17.586991 [debug] [Thread-1 (]: Began running node test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17
[0m02:16:17.587557 [info ] [Thread-1 (]: 1 of 3 START test not_null_rolling_average_calc_DATE ........................... [RUN]
[0m02:16:17.588493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_analytics, now test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17)
[0m02:16:17.588780 [debug] [Thread-1 (]: Began compiling node test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17
[0m02:16:17.603055 [debug] [Thread-1 (]: Writing injected SQL for node "test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17"
[0m02:16:17.604680 [debug] [Thread-1 (]: Writing injected SQL for node "test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17"
[0m02:16:17.605612 [debug] [Thread-1 (]: Began executing node test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17
[0m02:16:17.616926 [debug] [Thread-1 (]: Writing runtime sql for node "test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17"
[0m02:16:17.618212 [debug] [Thread-1 (]: Using snowflake connection "test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17"
[0m02:16:17.618443 [debug] [Thread-1 (]: On test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "node_id": "test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__rolling_average_calc as (


SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
) select DATE
from __dbt__cte__rolling_average_calc
where DATE is null



      
    ) dbt_internal_test
[0m02:16:17.618655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:16:18.008029 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.389 seconds
[0m02:16:18.022055 [debug] [Thread-1 (]: On test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17: Close
[0m02:16:18.170710 [info ] [Thread-1 (]: 1 of 3 PASS not_null_rolling_average_calc_DATE ................................. [[32mPASS[0m in 0.58s]
[0m02:16:18.172969 [debug] [Thread-1 (]: Finished running node test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17
[0m02:16:18.173760 [debug] [Thread-1 (]: Began running node test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6
[0m02:16:18.174499 [info ] [Thread-1 (]: 2 of 3 START test not_null_rolling_average_calc_SYMBOL ......................... [RUN]
[0m02:16:18.176063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17, now test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6)
[0m02:16:18.177426 [debug] [Thread-1 (]: Began compiling node test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6
[0m02:16:18.184405 [debug] [Thread-1 (]: Writing injected SQL for node "test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6"
[0m02:16:18.185923 [debug] [Thread-1 (]: Began executing node test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6
[0m02:16:18.188365 [debug] [Thread-1 (]: Writing runtime sql for node "test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6"
[0m02:16:18.189902 [debug] [Thread-1 (]: Using snowflake connection "test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6"
[0m02:16:18.190264 [debug] [Thread-1 (]: On test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "node_id": "test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__rolling_average_calc as (


SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
) select SYMBOL
from __dbt__cte__rolling_average_calc
where SYMBOL is null



      
    ) dbt_internal_test
[0m02:16:18.190675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:16:18.561342 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.371 seconds
[0m02:16:18.562960 [debug] [Thread-1 (]: On test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6: Close
[0m02:16:18.720915 [info ] [Thread-1 (]: 2 of 3 PASS not_null_rolling_average_calc_SYMBOL ............................... [[32mPASS[0m in 0.55s]
[0m02:16:18.721744 [debug] [Thread-1 (]: Finished running node test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6
[0m02:16:18.722083 [debug] [Thread-1 (]: Began running node test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28
[0m02:16:18.722395 [info ] [Thread-1 (]: 3 of 3 START test not_null_rolling_average_calc_row_num ........................ [RUN]
[0m02:16:18.722911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6, now test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28)
[0m02:16:18.723185 [debug] [Thread-1 (]: Began compiling node test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28
[0m02:16:18.727150 [debug] [Thread-1 (]: Writing injected SQL for node "test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28"
[0m02:16:18.727918 [debug] [Thread-1 (]: Began executing node test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28
[0m02:16:18.729147 [debug] [Thread-1 (]: Writing runtime sql for node "test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28"
[0m02:16:18.730172 [debug] [Thread-1 (]: Using snowflake connection "test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28"
[0m02:16:18.730386 [debug] [Thread-1 (]: On test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "node_id": "test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__rolling_average_calc as (


SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
) select row_num
from __dbt__cte__rolling_average_calc
where row_num is null



      
    ) dbt_internal_test
[0m02:16:18.730591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:16:19.334095 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.603 seconds
[0m02:16:19.337691 [debug] [Thread-1 (]: On test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28: Close
[0m02:16:19.475291 [info ] [Thread-1 (]: 3 of 3 PASS not_null_rolling_average_calc_row_num .............................. [[32mPASS[0m in 0.75s]
[0m02:16:19.476103 [debug] [Thread-1 (]: Finished running node test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28
[0m02:16:19.477381 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:16:19.477657 [debug] [MainThread]: Connection 'test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28' was properly closed.
[0m02:16:19.477909 [info ] [MainThread]: 
[0m02:16:19.478256 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 2.55 seconds (2.55s).
[0m02:16:19.478948 [debug] [MainThread]: Command end result
[0m02:16:19.497439 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m02:16:19.498643 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m02:16:19.502359 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m02:16:19.502615 [info ] [MainThread]: 
[0m02:16:19.502987 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:16:19.503193 [info ] [MainThread]: 
[0m02:16:19.503419 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m02:16:19.504213 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.1538904, "process_user_time": 2.10093, "process_kernel_time": 0.143522, "process_mem_max_rss": "210416", "process_out_blocks": "1875", "process_in_blocks": "0"}
[0m02:16:19.504515 [debug] [MainThread]: Command `dbt test` succeeded at 02:16:19.504460 after 3.15 seconds
[0m02:16:19.504742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb091fb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96cc6150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb154b9b0>]}
[0m02:16:19.504970 [debug] [MainThread]: Flushing usage events
[0m02:16:19.908281 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:16:21.533142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81b0cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81a72930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff816429c0>]}


============================== 02:16:21.536562 | f83a23d7-9794-4157-9f90-6ff478194753 ==============================
[0m02:16:21.536562 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m02:16:21.536977 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:16:21.915187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f83a23d7-9794-4157-9f90-6ff478194753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68552930>]}
[0m02:16:21.935709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f83a23d7-9794-4157-9f90-6ff478194753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8374ec90>]}
[0m02:16:21.936058 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m02:16:21.975212 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m02:16:22.027863 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:16:22.028109 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:16:22.047001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f83a23d7-9794-4157-9f90-6ff478194753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64f3d580>]}
[0m02:16:22.085232 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m02:16:22.086173 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m02:16:22.092307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f83a23d7-9794-4157-9f90-6ff478194753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64cff800>]}
[0m02:16:22.092567 [info ] [MainThread]: Found 3 models, 3 data tests, 2 sources, 458 macros
[0m02:16:22.092971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f83a23d7-9794-4157-9f90-6ff478194753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64bfb710>]}
[0m02:16:22.093675 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m02:16:22.094538 [debug] [MainThread]: Command end result
[0m02:16:22.105762 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m02:16:22.106552 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m02:16:22.107975 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m02:16:22.108568 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.59457916, "process_user_time": 1.93319, "process_kernel_time": 0.122884, "process_mem_max_rss": "200936", "process_out_blocks": "1827", "process_in_blocks": "0"}
[0m02:16:22.108791 [debug] [MainThread]: Command `dbt snapshot` succeeded at 02:16:22.108753 after 0.59 seconds
[0m02:16:22.108955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff858a69f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64f14410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64bf09b0>]}
[0m02:16:22.109105 [debug] [MainThread]: Flushing usage events
[0m02:16:22.498794 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:36:26.146793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d021b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dc7d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cce8260>]}


============================== 05:36:26.150587 | 0cbd3e49-58f4-4dfb-bfd3-c608775fc235 ==============================
[0m05:36:26.150587 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m05:36:26.150849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:36:26.566883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0cbd3e49-58f4-4dfb-bfd3-c608775fc235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e3d6f30>]}
[0m05:36:26.586469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0cbd3e49-58f4-4dfb-bfd3-c608775fc235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff626c3c20>]}
[0m05:36:26.586822 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m05:36:26.624333 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m05:36:26.665352 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m05:36:26.665868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0cbd3e49-58f4-4dfb-bfd3-c608775fc235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c6e7fb0>]}
[0m05:36:27.069829 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.Lab2_dbt_Folder.lab1_stock_price_table' (models/input/lab1_stock_price_table.sql) depends on a source named 'raw.RAW_STOCK_DATA' which was not found
[0m05:36:27.070623 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.94436675, "process_user_time": 2.286334, "process_kernel_time": 0.211884, "process_mem_max_rss": "205192", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m05:36:27.070996 [debug] [MainThread]: Command `dbt run` failed at 05:36:27.070953 after 0.94 seconds
[0m05:36:27.071175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cd696a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c243a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5b99b4d0>]}
[0m05:36:27.071369 [debug] [MainThread]: Flushing usage events
[0m05:36:27.559881 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:42:37.391247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dc02f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dadcbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ddf54f0>]}


============================== 05:42:37.395016 | e92bd5a3-8983-4008-8da1-12ac944ca2be ==============================
[0m05:42:37.395016 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m05:42:37.395464 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m05:42:37.821961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e92bd5a3-8983-4008-8da1-12ac944ca2be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f92e810>]}
[0m05:42:37.845005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e92bd5a3-8983-4008-8da1-12ac944ca2be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61f71a90>]}
[0m05:42:37.845393 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m05:42:37.889721 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m05:42:37.933298 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m05:42:37.933981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e92bd5a3-8983-4008-8da1-12ac944ca2be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d9586b0>]}
[0m05:42:38.343331 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.Lab2_dbt_Folder.lab1_stock_price_table' (models/input/lab1_stock_price_table.sql) depends on a source named 'raw.RAW_STOCK_DATA' which was not found
[0m05:42:38.344127 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.973372, "process_user_time": 2.251608, "process_kernel_time": 0.218836, "process_mem_max_rss": "205304", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m05:42:38.344397 [debug] [MainThread]: Command `dbt run` failed at 05:42:38.344338 after 0.97 seconds
[0m05:42:38.344628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e2da450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f4b58e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61267f80>]}
[0m05:42:38.344855 [debug] [MainThread]: Flushing usage events
[0m05:42:38.809323 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:50:21.160468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6758d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4818740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb33433e0>]}


============================== 05:50:21.164558 | fabf38f3-557f-4dbb-9455-eb042b2626a1 ==============================
[0m05:50:21.164558 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m05:50:21.164842 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:50:21.608135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fabf38f3-557f-4dbb-9455-eb042b2626a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92214500>]}
[0m05:50:21.629236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fabf38f3-557f-4dbb-9455-eb042b2626a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb490aea0>]}
[0m05:50:21.629683 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m05:50:21.670682 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m05:50:21.715638 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m05:50:21.715998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fabf38f3-557f-4dbb-9455-eb042b2626a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2c502c0>]}
[0m05:50:22.160651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fabf38f3-557f-4dbb-9455-eb042b2626a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90c2e8a0>]}
[0m05:50:22.230130 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m05:50:22.231207 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m05:50:22.237424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fabf38f3-557f-4dbb-9455-eb042b2626a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91cdde50>]}
[0m05:50:22.237639 [info ] [MainThread]: Found 5 models, 3 data tests, 2 sources, 458 macros
[0m05:50:22.238015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fabf38f3-557f-4dbb-9455-eb042b2626a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90c2df10>]}
[0m05:50:22.238742 [info ] [MainThread]: 
[0m05:50:22.238977 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:50:22.239153 [info ] [MainThread]: 
[0m05:50:22.239418 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:50:22.241153 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH'
[0m05:50:22.246590 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH"
[0m05:50:22.246753 [debug] [ThreadPool]: On list_USER_DB_CATFISH: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH"} */
show terse schemas in database USER_DB_CATFISH
    limit 10000
[0m05:50:22.246874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:50:22.786801 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.540 seconds
[0m05:50:22.789863 [debug] [ThreadPool]: On list_USER_DB_CATFISH: Close
[0m05:50:22.951076 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH, now list_USER_DB_CATFISH_analytics)
[0m05:50:22.963233 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_analytics"
[0m05:50:22.963925 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_analytics"} */
show terse objects in USER_DB_CATFISH.analytics limit 10000
[0m05:50:22.964401 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:50:23.386181 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.422 seconds
[0m05:50:23.389599 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: Close
[0m05:50:23.537305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fabf38f3-557f-4dbb-9455-eb042b2626a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91cf8bc0>]}
[0m05:50:23.550548 [debug] [Thread-1 (]: Began running node model.Lab2_dbt_Folder.lab1_stock_price_table
[0m05:50:23.551415 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.lab1_stock_price_table ................... [RUN]
[0m05:50:23.552425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_analytics, now model.Lab2_dbt_Folder.lab1_stock_price_table)
[0m05:50:23.552892 [debug] [Thread-1 (]: Began compiling node model.Lab2_dbt_Folder.lab1_stock_price_table
[0m05:50:23.561627 [debug] [Thread-1 (]: Writing injected SQL for node "model.Lab2_dbt_Folder.lab1_stock_price_table"
[0m05:50:23.564812 [debug] [Thread-1 (]: Began executing node model.Lab2_dbt_Folder.lab1_stock_price_table
[0m05:50:23.582897 [debug] [Thread-1 (]: Writing runtime sql for node "model.Lab2_dbt_Folder.lab1_stock_price_table"
[0m05:50:23.584069 [debug] [Thread-1 (]: Using snowflake connection "model.Lab2_dbt_Folder.lab1_stock_price_table"
[0m05:50:23.584295 [debug] [Thread-1 (]: On model.Lab2_dbt_Folder.lab1_stock_price_table: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "node_id": "model.Lab2_dbt_Folder.lab1_stock_price_table"} */
create or replace   view USER_DB_CATFISH.analytics.lab1_stock_price_table
  
   as (
    SELECT *
FROM USER_DB_CATFISH.raw.raw_stock_data
  );
[0m05:50:23.584511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:50:24.206719 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.622 seconds
[0m05:50:24.236069 [debug] [Thread-1 (]: On model.Lab2_dbt_Folder.lab1_stock_price_table: Close
[0m05:50:24.385874 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fabf38f3-557f-4dbb-9455-eb042b2626a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91ec61b0>]}
[0m05:50:24.387420 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.lab1_stock_price_table .............. [[32mSUCCESS 1[0m in 0.83s]
[0m05:50:24.388561 [debug] [Thread-1 (]: Finished running node model.Lab2_dbt_Folder.lab1_stock_price_table
[0m05:50:24.390117 [debug] [Thread-1 (]: Began running node model.Lab2_dbt_Folder.price_gap_calc
[0m05:50:24.390864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Lab2_dbt_Folder.lab1_stock_price_table, now model.Lab2_dbt_Folder.price_gap_calc)
[0m05:50:24.391389 [debug] [Thread-1 (]: Began compiling node model.Lab2_dbt_Folder.price_gap_calc
[0m05:50:24.395851 [debug] [Thread-1 (]: Writing injected SQL for node "model.Lab2_dbt_Folder.price_gap_calc"
[0m05:50:24.398937 [debug] [Thread-1 (]: Finished running node model.Lab2_dbt_Folder.price_gap_calc
[0m05:50:24.399609 [debug] [Thread-1 (]: Began running node model.Lab2_dbt_Folder.rolling_average_calc
[0m05:50:24.400170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Lab2_dbt_Folder.price_gap_calc, now model.Lab2_dbt_Folder.rolling_average_calc)
[0m05:50:24.400679 [debug] [Thread-1 (]: Began compiling node model.Lab2_dbt_Folder.rolling_average_calc
[0m05:50:24.403915 [debug] [Thread-1 (]: Writing injected SQL for node "model.Lab2_dbt_Folder.rolling_average_calc"
[0m05:50:24.405640 [debug] [Thread-1 (]: Finished running node model.Lab2_dbt_Folder.rolling_average_calc
[0m05:50:24.405980 [debug] [Thread-1 (]: Began running node model.Lab2_dbt_Folder.price_gap_filtered
[0m05:50:24.406474 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.price_gap_filtered ...................... [RUN]
[0m05:50:24.406973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Lab2_dbt_Folder.rolling_average_calc, now model.Lab2_dbt_Folder.price_gap_filtered)
[0m05:50:24.407378 [debug] [Thread-1 (]: Began compiling node model.Lab2_dbt_Folder.price_gap_filtered
[0m05:50:24.410754 [debug] [Thread-1 (]: Writing injected SQL for node "model.Lab2_dbt_Folder.price_gap_filtered"
[0m05:50:24.411927 [debug] [Thread-1 (]: Began executing node model.Lab2_dbt_Folder.price_gap_filtered
[0m05:50:24.428584 [debug] [Thread-1 (]: Writing runtime sql for node "model.Lab2_dbt_Folder.price_gap_filtered"
[0m05:50:24.429780 [debug] [Thread-1 (]: Using snowflake connection "model.Lab2_dbt_Folder.price_gap_filtered"
[0m05:50:24.430021 [debug] [Thread-1 (]: On model.Lab2_dbt_Folder.price_gap_filtered: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "node_id": "model.Lab2_dbt_Folder.price_gap_filtered"} */
create or replace transient table USER_DB_CATFISH.analytics.price_gap_filtered
         as
        (with __dbt__cte__price_gap_calc as (
SELECT SYMBOL,
        DT AS DATE,
        OPEN,
        LAG(CLOSE, 1) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DT) as LAST_CLOSING
FROM FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
ORDER BY SYMBOL, DATE
) SELECT *,
       (OPEN - LAST_CLOSING) AS PRICE_GAP
FROM __dbt__cte__price_gap_calc
WHERE LAST_CLOSING IS NOT NULL
        );
[0m05:50:24.430249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:50:24.817331 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbc97e-0305-0010-0004-59ff002313c2
[0m05:50:24.817763 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 8 at position 5 unexpected 'FROM'.
[0m05:50:24.818088 [debug] [Thread-1 (]: On model.Lab2_dbt_Folder.price_gap_filtered: Close
[0m05:50:24.974185 [debug] [Thread-1 (]: Database Error in model price_gap_filtered (models/output/price_gap_filtered.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 5 unexpected 'FROM'.
  compiled code at target/run/Lab2_dbt_Folder/models/output/price_gap_filtered.sql
[0m05:50:24.975374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fabf38f3-557f-4dbb-9455-eb042b2626a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91de6c60>]}
[0m05:50:24.976499 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model analytics.price_gap_filtered ............. [[31mERROR[0m in 0.57s]
[0m05:50:24.978136 [debug] [Thread-1 (]: Finished running node model.Lab2_dbt_Folder.price_gap_filtered
[0m05:50:24.978781 [debug] [Thread-1 (]: Began running node model.Lab2_dbt_Folder.rolling_avg_filtered
[0m05:50:24.979361 [debug] [Thread-4 (]: Marking all children of 'model.Lab2_dbt_Folder.price_gap_filtered' to be skipped because of status 'error'.  Reason: Database Error in model price_gap_filtered (models/output/price_gap_filtered.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 5 unexpected 'FROM'.
  compiled code at target/run/Lab2_dbt_Folder/models/output/price_gap_filtered.sql.
[0m05:50:24.979859 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.rolling_avg_filtered .................... [RUN]
[0m05:50:24.981861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Lab2_dbt_Folder.price_gap_filtered, now model.Lab2_dbt_Folder.rolling_avg_filtered)
[0m05:50:24.982373 [debug] [Thread-1 (]: Began compiling node model.Lab2_dbt_Folder.rolling_avg_filtered
[0m05:50:24.987442 [debug] [Thread-1 (]: Writing injected SQL for node "model.Lab2_dbt_Folder.rolling_avg_filtered"
[0m05:50:24.988804 [debug] [Thread-1 (]: Began executing node model.Lab2_dbt_Folder.rolling_avg_filtered
[0m05:50:24.991395 [debug] [Thread-1 (]: Writing runtime sql for node "model.Lab2_dbt_Folder.rolling_avg_filtered"
[0m05:50:24.993181 [debug] [Thread-1 (]: Using snowflake connection "model.Lab2_dbt_Folder.rolling_avg_filtered"
[0m05:50:24.993507 [debug] [Thread-1 (]: On model.Lab2_dbt_Folder.rolling_avg_filtered: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "node_id": "model.Lab2_dbt_Folder.rolling_avg_filtered"} */
create or replace transient table USER_DB_CATFISH.analytics.rolling_avg_filtered
         as
        (with __dbt__cte__rolling_average_calc as (


SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
) SELECT SYMBOL,
       DATE,
       ROLLING_AVERAGE
FROM __dbt__cte__rolling_average_calc
WHERE row_num >= 7
ORDER BY SYMBOL, DATE, row_num
        );
[0m05:50:24.993837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:50:26.029892 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.035 seconds
[0m05:50:26.034768 [debug] [Thread-1 (]: On model.Lab2_dbt_Folder.rolling_avg_filtered: Close
[0m05:50:26.192457 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fabf38f3-557f-4dbb-9455-eb042b2626a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff901f0050>]}
[0m05:50:26.194761 [info ] [Thread-1 (]: 3 of 3 OK created sql table model analytics.rolling_avg_filtered ............... [[32mSUCCESS 1[0m in 1.21s]
[0m05:50:26.197171 [debug] [Thread-1 (]: Finished running node model.Lab2_dbt_Folder.rolling_avg_filtered
[0m05:50:26.200683 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:50:26.201377 [debug] [MainThread]: Connection 'model.Lab2_dbt_Folder.rolling_avg_filtered' was properly closed.
[0m05:50:26.202517 [info ] [MainThread]: 
[0m05:50:26.203328 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 3.96 seconds (3.96s).
[0m05:50:26.204797 [debug] [MainThread]: Command end result
[0m05:50:26.230380 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m05:50:26.231716 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m05:50:26.235660 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m05:50:26.235862 [info ] [MainThread]: 
[0m05:50:26.236316 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successs, and 0 warnings:[0m
[0m05:50:26.236646 [info ] [MainThread]: 
[0m05:50:26.236976 [error] [MainThread]:   Database Error in model price_gap_filtered (models/output/price_gap_filtered.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 5 unexpected 'FROM'.
  compiled code at target/run/Lab2_dbt_Folder/models/output/price_gap_filtered.sql
[0m05:50:26.237417 [info ] [MainThread]: 
[0m05:50:26.237723 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m05:50:26.238708 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.0989723, "process_user_time": 2.750191, "process_kernel_time": 0.28802, "process_mem_max_rss": "213212", "process_out_blocks": "2814", "command_success": false, "process_in_blocks": "0"}
[0m05:50:26.238983 [debug] [MainThread]: Command `dbt run` failed at 05:50:26.238933 after 5.10 seconds
[0m05:50:26.239217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4b738f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90ca75f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90b80fb0>]}
[0m05:50:26.239422 [debug] [MainThread]: Flushing usage events
[0m05:50:26.683901 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:53:19.195221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff829eda30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84003890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff826b4200>]}


============================== 05:53:19.199411 | 28803b0e-a07b-4aaa-87ca-314c7294dd6a ==============================
[0m05:53:19.199411 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m05:53:19.199683 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:53:19.618807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28803b0e-a07b-4aaa-87ca-314c7294dd6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82669340>]}
[0m05:53:19.639055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28803b0e-a07b-4aaa-87ca-314c7294dd6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff680c3ce0>]}
[0m05:53:19.639411 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m05:53:19.679421 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m05:53:19.733116 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:53:19.733456 [debug] [MainThread]: Partial parsing: updated file: Lab2_dbt_Folder://models/intermediate/price_gap_calc.sql
[0m05:53:19.827305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28803b0e-a07b-4aaa-87ca-314c7294dd6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff655e60f0>]}
[0m05:53:19.864926 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m05:53:19.865804 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m05:53:19.872075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28803b0e-a07b-4aaa-87ca-314c7294dd6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff653cf140>]}
[0m05:53:19.872260 [info ] [MainThread]: Found 5 models, 3 data tests, 2 sources, 458 macros
[0m05:53:19.872630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28803b0e-a07b-4aaa-87ca-314c7294dd6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff655e4e30>]}
[0m05:53:19.873361 [info ] [MainThread]: 
[0m05:53:19.873582 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:53:19.873769 [info ] [MainThread]: 
[0m05:53:19.874054 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:53:19.875701 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH'
[0m05:53:19.881387 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH"
[0m05:53:19.881550 [debug] [ThreadPool]: On list_USER_DB_CATFISH: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH"} */
show terse schemas in database USER_DB_CATFISH
    limit 10000
[0m05:53:19.881675 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:53:20.309041 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.427 seconds
[0m05:53:20.311217 [debug] [ThreadPool]: On list_USER_DB_CATFISH: Close
[0m05:53:20.458635 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH, now list_USER_DB_CATFISH_analytics)
[0m05:53:20.469206 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_analytics"
[0m05:53:20.469619 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_analytics"} */
show terse objects in USER_DB_CATFISH.analytics limit 10000
[0m05:53:20.469991 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:53:20.926800 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.456 seconds
[0m05:53:20.930033 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: Close
[0m05:53:21.170235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28803b0e-a07b-4aaa-87ca-314c7294dd6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6520fb00>]}
[0m05:53:21.179084 [debug] [Thread-1 (]: Began running node model.Lab2_dbt_Folder.lab1_stock_price_table
[0m05:53:21.179573 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.lab1_stock_price_table ................... [RUN]
[0m05:53:21.180288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_analytics, now model.Lab2_dbt_Folder.lab1_stock_price_table)
[0m05:53:21.180561 [debug] [Thread-1 (]: Began compiling node model.Lab2_dbt_Folder.lab1_stock_price_table
[0m05:53:21.185900 [debug] [Thread-1 (]: Writing injected SQL for node "model.Lab2_dbt_Folder.lab1_stock_price_table"
[0m05:53:21.186711 [debug] [Thread-1 (]: Began executing node model.Lab2_dbt_Folder.lab1_stock_price_table
[0m05:53:21.202732 [debug] [Thread-1 (]: Writing runtime sql for node "model.Lab2_dbt_Folder.lab1_stock_price_table"
[0m05:53:21.203624 [debug] [Thread-1 (]: Using snowflake connection "model.Lab2_dbt_Folder.lab1_stock_price_table"
[0m05:53:21.203826 [debug] [Thread-1 (]: On model.Lab2_dbt_Folder.lab1_stock_price_table: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "node_id": "model.Lab2_dbt_Folder.lab1_stock_price_table"} */
create or replace   view USER_DB_CATFISH.analytics.lab1_stock_price_table
  
   as (
    SELECT *
FROM USER_DB_CATFISH.raw.raw_stock_data
  );
[0m05:53:21.204030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:53:21.797353 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.593 seconds
[0m05:53:21.823292 [debug] [Thread-1 (]: On model.Lab2_dbt_Folder.lab1_stock_price_table: Close
[0m05:53:21.962092 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28803b0e-a07b-4aaa-87ca-314c7294dd6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65664d70>]}
[0m05:53:21.963404 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.lab1_stock_price_table .............. [[32mSUCCESS 1[0m in 0.78s]
[0m05:53:21.964238 [debug] [Thread-1 (]: Finished running node model.Lab2_dbt_Folder.lab1_stock_price_table
[0m05:53:21.965631 [debug] [Thread-1 (]: Began running node model.Lab2_dbt_Folder.price_gap_calc
[0m05:53:21.966214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Lab2_dbt_Folder.lab1_stock_price_table, now model.Lab2_dbt_Folder.price_gap_calc)
[0m05:53:21.966631 [debug] [Thread-1 (]: Began compiling node model.Lab2_dbt_Folder.price_gap_calc
[0m05:53:21.970375 [debug] [Thread-1 (]: Writing injected SQL for node "model.Lab2_dbt_Folder.price_gap_calc"
[0m05:53:21.972613 [debug] [Thread-1 (]: Finished running node model.Lab2_dbt_Folder.price_gap_calc
[0m05:53:21.973013 [debug] [Thread-1 (]: Began running node model.Lab2_dbt_Folder.rolling_average_calc
[0m05:53:21.973414 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Lab2_dbt_Folder.price_gap_calc, now model.Lab2_dbt_Folder.rolling_average_calc)
[0m05:53:21.973787 [debug] [Thread-1 (]: Began compiling node model.Lab2_dbt_Folder.rolling_average_calc
[0m05:53:21.976240 [debug] [Thread-1 (]: Writing injected SQL for node "model.Lab2_dbt_Folder.rolling_average_calc"
[0m05:53:21.977216 [debug] [Thread-1 (]: Finished running node model.Lab2_dbt_Folder.rolling_average_calc
[0m05:53:21.977551 [debug] [Thread-1 (]: Began running node model.Lab2_dbt_Folder.price_gap_filtered
[0m05:53:21.977979 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.price_gap_filtered ...................... [RUN]
[0m05:53:21.978386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Lab2_dbt_Folder.rolling_average_calc, now model.Lab2_dbt_Folder.price_gap_filtered)
[0m05:53:21.978680 [debug] [Thread-1 (]: Began compiling node model.Lab2_dbt_Folder.price_gap_filtered
[0m05:53:21.981820 [debug] [Thread-1 (]: Writing injected SQL for node "model.Lab2_dbt_Folder.price_gap_filtered"
[0m05:53:21.982485 [debug] [Thread-1 (]: Began executing node model.Lab2_dbt_Folder.price_gap_filtered
[0m05:53:21.998238 [debug] [Thread-1 (]: Writing runtime sql for node "model.Lab2_dbt_Folder.price_gap_filtered"
[0m05:53:21.999183 [debug] [Thread-1 (]: Using snowflake connection "model.Lab2_dbt_Folder.price_gap_filtered"
[0m05:53:21.999415 [debug] [Thread-1 (]: On model.Lab2_dbt_Folder.price_gap_filtered: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "node_id": "model.Lab2_dbt_Folder.price_gap_filtered"} */
create or replace transient table USER_DB_CATFISH.analytics.price_gap_filtered
         as
        (with __dbt__cte__price_gap_calc as (
SELECT SYMBOL,
        DT AS DATE,
        OPEN,
        LAG(CLOSE, 1) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DT) as LAST_CLOSING
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
ORDER BY SYMBOL, DATE
) SELECT *,
       (OPEN - LAST_CLOSING) AS PRICE_GAP
FROM __dbt__cte__price_gap_calc
WHERE LAST_CLOSING IS NOT NULL
        );
[0m05:53:21.999680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:53:23.231080 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.231 seconds
[0m05:53:23.234976 [debug] [Thread-1 (]: On model.Lab2_dbt_Folder.price_gap_filtered: Close
[0m05:53:23.372609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28803b0e-a07b-4aaa-87ca-314c7294dd6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82e6aa20>]}
[0m05:53:23.374272 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.price_gap_filtered ................. [[32mSUCCESS 1[0m in 1.39s]
[0m05:53:23.375985 [debug] [Thread-1 (]: Finished running node model.Lab2_dbt_Folder.price_gap_filtered
[0m05:53:23.376667 [debug] [Thread-1 (]: Began running node model.Lab2_dbt_Folder.rolling_avg_filtered
[0m05:53:23.377464 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.rolling_avg_filtered .................... [RUN]
[0m05:53:23.378745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Lab2_dbt_Folder.price_gap_filtered, now model.Lab2_dbt_Folder.rolling_avg_filtered)
[0m05:53:23.379424 [debug] [Thread-1 (]: Began compiling node model.Lab2_dbt_Folder.rolling_avg_filtered
[0m05:53:23.385525 [debug] [Thread-1 (]: Writing injected SQL for node "model.Lab2_dbt_Folder.rolling_avg_filtered"
[0m05:53:23.386780 [debug] [Thread-1 (]: Began executing node model.Lab2_dbt_Folder.rolling_avg_filtered
[0m05:53:23.389361 [debug] [Thread-1 (]: Writing runtime sql for node "model.Lab2_dbt_Folder.rolling_avg_filtered"
[0m05:53:23.390631 [debug] [Thread-1 (]: Using snowflake connection "model.Lab2_dbt_Folder.rolling_avg_filtered"
[0m05:53:23.390955 [debug] [Thread-1 (]: On model.Lab2_dbt_Folder.rolling_avg_filtered: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "node_id": "model.Lab2_dbt_Folder.rolling_avg_filtered"} */
create or replace transient table USER_DB_CATFISH.analytics.rolling_avg_filtered
         as
        (with __dbt__cte__rolling_average_calc as (


SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
) SELECT SYMBOL,
       DATE,
       ROLLING_AVERAGE
FROM __dbt__cte__rolling_average_calc
WHERE row_num >= 7
ORDER BY SYMBOL, DATE, row_num
        );
[0m05:53:23.391230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:53:24.460720 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.069 seconds
[0m05:53:24.465834 [debug] [Thread-1 (]: On model.Lab2_dbt_Folder.rolling_avg_filtered: Close
[0m05:53:24.605873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28803b0e-a07b-4aaa-87ca-314c7294dd6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff435ea030>]}
[0m05:53:24.607869 [info ] [Thread-1 (]: 3 of 3 OK created sql table model analytics.rolling_avg_filtered ............... [[32mSUCCESS 1[0m in 1.23s]
[0m05:53:24.609641 [debug] [Thread-1 (]: Finished running node model.Lab2_dbt_Folder.rolling_avg_filtered
[0m05:53:24.611276 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:53:24.611575 [debug] [MainThread]: Connection 'model.Lab2_dbt_Folder.rolling_avg_filtered' was properly closed.
[0m05:53:24.611927 [info ] [MainThread]: 
[0m05:53:24.612262 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 4.74 seconds (4.74s).
[0m05:53:24.613190 [debug] [MainThread]: Command end result
[0m05:53:24.635636 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m05:53:24.636854 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m05:53:24.640476 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m05:53:24.640653 [info ] [MainThread]: 
[0m05:53:24.640873 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:53:24.641022 [info ] [MainThread]: 
[0m05:53:24.641370 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:53:24.642279 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.46761, "process_user_time": 2.337551, "process_kernel_time": 0.222528, "process_mem_max_rss": "211352", "process_out_blocks": "2814", "process_in_blocks": "0"}
[0m05:53:24.642564 [debug] [MainThread]: Command `dbt run` succeeded at 05:53:24.642513 after 5.47 seconds
[0m05:53:24.642779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82726b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff820e0650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff659eb770>]}
[0m05:53:24.642970 [debug] [MainThread]: Flushing usage events
[0m05:53:25.070839 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:53:26.523666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99dd1340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99e3a9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99e39ac0>]}


============================== 05:53:26.526589 | 1fd5da88-136e-4b90-8f0a-aa959e8f863e ==============================
[0m05:53:26.526589 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m05:53:26.527023 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m05:53:26.892097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1fd5da88-136e-4b90-8f0a-aa959e8f863e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fd4a870>]}
[0m05:53:26.913044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1fd5da88-136e-4b90-8f0a-aa959e8f863e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a4088c0>]}
[0m05:53:26.913405 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m05:53:26.950649 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m05:53:27.003786 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:53:27.004027 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:53:27.020867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1fd5da88-136e-4b90-8f0a-aa959e8f863e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d318c80>]}
[0m05:53:27.059221 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m05:53:27.060129 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m05:53:27.071264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1fd5da88-136e-4b90-8f0a-aa959e8f863e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cdf5370>]}
[0m05:53:27.071506 [info ] [MainThread]: Found 5 models, 3 data tests, 2 sources, 458 macros
[0m05:53:27.071876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fd5da88-136e-4b90-8f0a-aa959e8f863e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d31bd40>]}
[0m05:53:27.072624 [info ] [MainThread]: 
[0m05:53:27.072888 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:53:27.073093 [info ] [MainThread]: 
[0m05:53:27.073386 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:53:27.075082 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH_analytics'
[0m05:53:27.081830 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_analytics"
[0m05:53:27.082006 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_analytics"} */
show terse objects in USER_DB_CATFISH.analytics limit 10000
[0m05:53:27.082158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:53:27.523642 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.441 seconds
[0m05:53:27.526233 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: Close
[0m05:53:27.663054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fd5da88-136e-4b90-8f0a-aa959e8f863e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b6fde20>]}
[0m05:53:27.675839 [debug] [Thread-1 (]: Began running node test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17
[0m05:53:27.676577 [info ] [Thread-1 (]: 1 of 3 START test not_null_rolling_average_calc_DATE ........................... [RUN]
[0m05:53:27.677611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_analytics, now test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17)
[0m05:53:27.678078 [debug] [Thread-1 (]: Began compiling node test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17
[0m05:53:27.694453 [debug] [Thread-1 (]: Writing injected SQL for node "test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17"
[0m05:53:27.695928 [debug] [Thread-1 (]: Writing injected SQL for node "test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17"
[0m05:53:27.697118 [debug] [Thread-1 (]: Began executing node test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17
[0m05:53:27.708855 [debug] [Thread-1 (]: Writing runtime sql for node "test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17"
[0m05:53:27.710227 [debug] [Thread-1 (]: Using snowflake connection "test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17"
[0m05:53:27.710482 [debug] [Thread-1 (]: On test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "node_id": "test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__rolling_average_calc as (


SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
) select DATE
from __dbt__cte__rolling_average_calc
where DATE is null



      
    ) dbt_internal_test
[0m05:53:27.710768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:53:28.158503 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.447 seconds
[0m05:53:28.170670 [debug] [Thread-1 (]: On test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17: Close
[0m05:53:28.309716 [info ] [Thread-1 (]: 1 of 3 PASS not_null_rolling_average_calc_DATE ................................. [[32mPASS[0m in 0.63s]
[0m05:53:28.311630 [debug] [Thread-1 (]: Finished running node test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17
[0m05:53:28.312329 [debug] [Thread-1 (]: Began running node test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6
[0m05:53:28.312954 [info ] [Thread-1 (]: 2 of 3 START test not_null_rolling_average_calc_SYMBOL ......................... [RUN]
[0m05:53:28.313914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17, now test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6)
[0m05:53:28.314518 [debug] [Thread-1 (]: Began compiling node test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6
[0m05:53:28.321639 [debug] [Thread-1 (]: Writing injected SQL for node "test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6"
[0m05:53:28.324295 [debug] [Thread-1 (]: Began executing node test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6
[0m05:53:28.327269 [debug] [Thread-1 (]: Writing runtime sql for node "test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6"
[0m05:53:28.329012 [debug] [Thread-1 (]: Using snowflake connection "test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6"
[0m05:53:28.329422 [debug] [Thread-1 (]: On test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "node_id": "test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__rolling_average_calc as (


SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
) select SYMBOL
from __dbt__cte__rolling_average_calc
where SYMBOL is null



      
    ) dbt_internal_test
[0m05:53:28.329801 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:53:28.782529 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.452 seconds
[0m05:53:28.786207 [debug] [Thread-1 (]: On test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6: Close
[0m05:53:28.946846 [info ] [Thread-1 (]: 2 of 3 PASS not_null_rolling_average_calc_SYMBOL ............................... [[32mPASS[0m in 0.63s]
[0m05:53:28.948836 [debug] [Thread-1 (]: Finished running node test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6
[0m05:53:28.949838 [debug] [Thread-1 (]: Began running node test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28
[0m05:53:28.950611 [info ] [Thread-1 (]: 3 of 3 START test not_null_rolling_average_calc_row_num ........................ [RUN]
[0m05:53:28.951811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6, now test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28)
[0m05:53:28.953412 [debug] [Thread-1 (]: Began compiling node test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28
[0m05:53:28.962597 [debug] [Thread-1 (]: Writing injected SQL for node "test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28"
[0m05:53:28.964100 [debug] [Thread-1 (]: Began executing node test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28
[0m05:53:28.966540 [debug] [Thread-1 (]: Writing runtime sql for node "test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28"
[0m05:53:28.968361 [debug] [Thread-1 (]: Using snowflake connection "test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28"
[0m05:53:28.968860 [debug] [Thread-1 (]: On test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "node_id": "test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__rolling_average_calc as (


SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
) select row_num
from __dbt__cte__rolling_average_calc
where row_num is null



      
    ) dbt_internal_test
[0m05:53:28.969220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:53:29.368877 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.399 seconds
[0m05:53:29.374665 [debug] [Thread-1 (]: On test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28: Close
[0m05:53:29.513821 [info ] [Thread-1 (]: 3 of 3 PASS not_null_rolling_average_calc_row_num .............................. [[32mPASS[0m in 0.56s]
[0m05:53:29.515690 [debug] [Thread-1 (]: Finished running node test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28
[0m05:53:29.518256 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:53:29.518853 [debug] [MainThread]: Connection 'test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28' was properly closed.
[0m05:53:29.519472 [info ] [MainThread]: 
[0m05:53:29.520287 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 2.45 seconds (2.45s).
[0m05:53:29.521717 [debug] [MainThread]: Command end result
[0m05:53:29.551074 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m05:53:29.552715 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m05:53:29.557132 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m05:53:29.557363 [info ] [MainThread]: 
[0m05:53:29.557959 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:53:29.558194 [info ] [MainThread]: 
[0m05:53:29.558407 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:53:29.559065 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.056103, "process_user_time": 2.194648, "process_kernel_time": 0.116458, "process_mem_max_rss": "210348", "process_out_blocks": "1896", "process_in_blocks": "0"}
[0m05:53:29.559361 [debug] [MainThread]: Command `dbt test` succeeded at 05:53:29.559307 after 3.06 seconds
[0m05:53:29.559590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a4ad340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a390470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99a42ff0>]}
[0m05:53:29.559843 [debug] [MainThread]: Flushing usage events
[0m05:53:29.941705 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:53:32.172667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae38b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad73a8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffada26660>]}


============================== 05:53:32.176580 | 80e76ed3-2997-4dbb-a435-66e319b417e8 ==============================
[0m05:53:32.176580 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m05:53:32.177039 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:53:32.560155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80e76ed3-2997-4dbb-a435-66e319b417e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91438110>]}
[0m05:53:32.582469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80e76ed3-2997-4dbb-a435-66e319b417e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff914e8d10>]}
[0m05:53:32.583114 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m05:53:32.624071 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m05:53:32.677187 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:53:32.677421 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:53:32.695049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80e76ed3-2997-4dbb-a435-66e319b417e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90fff3b0>]}
[0m05:53:32.732908 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m05:53:32.733732 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m05:53:32.739362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80e76ed3-2997-4dbb-a435-66e319b417e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90d73e60>]}
[0m05:53:32.739573 [info ] [MainThread]: Found 5 models, 3 data tests, 2 sources, 458 macros
[0m05:53:32.739898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80e76ed3-2997-4dbb-a435-66e319b417e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90b224b0>]}
[0m05:53:32.740532 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m05:53:32.741339 [debug] [MainThread]: Command end result
[0m05:53:32.752568 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m05:53:32.753287 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m05:53:32.754604 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m05:53:32.755045 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.60192406, "process_user_time": 1.895746, "process_kernel_time": 0.083944, "process_mem_max_rss": "200896", "process_out_blocks": "1848", "process_in_blocks": "0"}
[0m05:53:32.755270 [debug] [MainThread]: Command `dbt snapshot` succeeded at 05:53:32.755221 after 0.60 seconds
[0m05:53:32.755446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae12e930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90fffe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadf9c410>]}
[0m05:53:32.755595 [debug] [MainThread]: Flushing usage events
[0m05:53:33.160292 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:00:27.264170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d991b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d3e6720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d3b6180>]}


============================== 12:00:27.267851 | 472e5507-6174-4719-bda1-5b9935ff7321 ==============================
[0m12:00:27.267851 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m12:00:27.268377 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:00:27.711598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '472e5507-6174-4719-bda1-5b9935ff7321', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80505fd0>]}
[0m12:00:27.731112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '472e5507-6174-4719-bda1-5b9935ff7321', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ca4c080>]}
[0m12:00:27.731495 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m12:00:27.770474 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m12:00:27.824033 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:00:27.824257 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:00:27.840750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '472e5507-6174-4719-bda1-5b9935ff7321', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80599250>]}
[0m12:00:27.876797 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m12:00:27.877724 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m12:00:27.883594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '472e5507-6174-4719-bda1-5b9935ff7321', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80383d70>]}
[0m12:00:27.883836 [info ] [MainThread]: Found 5 models, 3 data tests, 2 sources, 458 macros
[0m12:00:27.884139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '472e5507-6174-4719-bda1-5b9935ff7321', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff805bcfe0>]}
[0m12:00:27.884948 [info ] [MainThread]: 
[0m12:00:27.885146 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:00:27.885288 [info ] [MainThread]: 
[0m12:00:27.885528 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:00:27.887252 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH'
[0m12:00:27.893086 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH"
[0m12:00:27.893247 [debug] [ThreadPool]: On list_USER_DB_CATFISH: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH"} */
show terse schemas in database USER_DB_CATFISH
    limit 10000
[0m12:00:27.893371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:00:28.834586 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.941 seconds
[0m12:00:28.837772 [debug] [ThreadPool]: On list_USER_DB_CATFISH: Close
[0m12:00:29.010132 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH, now list_USER_DB_CATFISH_analytics)
[0m12:00:29.022600 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_analytics"
[0m12:00:29.023093 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_analytics"} */
show terse objects in USER_DB_CATFISH.analytics limit 10000
[0m12:00:29.023445 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:00:29.468950 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.445 seconds
[0m12:00:29.472364 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: Close
[0m12:00:29.651292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '472e5507-6174-4719-bda1-5b9935ff7321', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff808617c0>]}
[0m12:00:29.665478 [debug] [Thread-1 (]: Began running node model.Lab2_dbt_Folder.lab1_stock_price_table
[0m12:00:29.666218 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.lab1_stock_price_table ................... [RUN]
[0m12:00:29.667193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_analytics, now model.Lab2_dbt_Folder.lab1_stock_price_table)
[0m12:00:29.667640 [debug] [Thread-1 (]: Began compiling node model.Lab2_dbt_Folder.lab1_stock_price_table
[0m12:00:29.674507 [debug] [Thread-1 (]: Writing injected SQL for node "model.Lab2_dbt_Folder.lab1_stock_price_table"
[0m12:00:29.676159 [debug] [Thread-1 (]: Began executing node model.Lab2_dbt_Folder.lab1_stock_price_table
[0m12:00:29.693944 [debug] [Thread-1 (]: Writing runtime sql for node "model.Lab2_dbt_Folder.lab1_stock_price_table"
[0m12:00:29.695289 [debug] [Thread-1 (]: Using snowflake connection "model.Lab2_dbt_Folder.lab1_stock_price_table"
[0m12:00:29.695513 [debug] [Thread-1 (]: On model.Lab2_dbt_Folder.lab1_stock_price_table: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "node_id": "model.Lab2_dbt_Folder.lab1_stock_price_table"} */
create or replace   view USER_DB_CATFISH.analytics.lab1_stock_price_table
  
   as (
    SELECT *
FROM USER_DB_CATFISH.raw.raw_stock_data
  );
[0m12:00:29.695716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:30.648480 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.952 seconds
[0m12:00:30.670399 [debug] [Thread-1 (]: On model.Lab2_dbt_Folder.lab1_stock_price_table: Close
[0m12:00:30.809771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '472e5507-6174-4719-bda1-5b9935ff7321', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d79dd90>]}
[0m12:00:30.811773 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.lab1_stock_price_table .............. [[32mSUCCESS 1[0m in 1.14s]
[0m12:00:30.813892 [debug] [Thread-1 (]: Finished running node model.Lab2_dbt_Folder.lab1_stock_price_table
[0m12:00:30.815937 [debug] [Thread-1 (]: Began running node model.Lab2_dbt_Folder.price_gap_calc
[0m12:00:30.816827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Lab2_dbt_Folder.lab1_stock_price_table, now model.Lab2_dbt_Folder.price_gap_calc)
[0m12:00:30.817414 [debug] [Thread-1 (]: Began compiling node model.Lab2_dbt_Folder.price_gap_calc
[0m12:00:30.821261 [debug] [Thread-1 (]: Writing injected SQL for node "model.Lab2_dbt_Folder.price_gap_calc"
[0m12:00:30.823818 [debug] [Thread-1 (]: Finished running node model.Lab2_dbt_Folder.price_gap_calc
[0m12:00:30.824306 [debug] [Thread-1 (]: Began running node model.Lab2_dbt_Folder.rolling_average_calc
[0m12:00:30.824993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Lab2_dbt_Folder.price_gap_calc, now model.Lab2_dbt_Folder.rolling_average_calc)
[0m12:00:30.825454 [debug] [Thread-1 (]: Began compiling node model.Lab2_dbt_Folder.rolling_average_calc
[0m12:00:30.828316 [debug] [Thread-1 (]: Writing injected SQL for node "model.Lab2_dbt_Folder.rolling_average_calc"
[0m12:00:30.829827 [debug] [Thread-1 (]: Finished running node model.Lab2_dbt_Folder.rolling_average_calc
[0m12:00:30.830163 [debug] [Thread-1 (]: Began running node model.Lab2_dbt_Folder.price_gap_filtered
[0m12:00:30.830754 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.price_gap_filtered ...................... [RUN]
[0m12:00:30.831636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Lab2_dbt_Folder.rolling_average_calc, now model.Lab2_dbt_Folder.price_gap_filtered)
[0m12:00:30.831982 [debug] [Thread-1 (]: Began compiling node model.Lab2_dbt_Folder.price_gap_filtered
[0m12:00:30.835287 [debug] [Thread-1 (]: Writing injected SQL for node "model.Lab2_dbt_Folder.price_gap_filtered"
[0m12:00:30.836248 [debug] [Thread-1 (]: Began executing node model.Lab2_dbt_Folder.price_gap_filtered
[0m12:00:30.850638 [debug] [Thread-1 (]: Writing runtime sql for node "model.Lab2_dbt_Folder.price_gap_filtered"
[0m12:00:30.851828 [debug] [Thread-1 (]: Using snowflake connection "model.Lab2_dbt_Folder.price_gap_filtered"
[0m12:00:30.852083 [debug] [Thread-1 (]: On model.Lab2_dbt_Folder.price_gap_filtered: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "node_id": "model.Lab2_dbt_Folder.price_gap_filtered"} */
create or replace transient table USER_DB_CATFISH.analytics.price_gap_filtered
         as
        (with __dbt__cte__price_gap_calc as (
SELECT SYMBOL,
        DT AS DATE,
        OPEN,
        LAG(CLOSE, 1) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DT) as LAST_CLOSING
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
ORDER BY SYMBOL, DATE
) SELECT *,
       (OPEN - LAST_CLOSING) AS PRICE_GAP
FROM __dbt__cte__price_gap_calc
WHERE LAST_CLOSING IS NOT NULL
        );
[0m12:00:30.852318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:32.828105 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.975 seconds
[0m12:00:32.832909 [debug] [Thread-1 (]: On model.Lab2_dbt_Folder.price_gap_filtered: Close
[0m12:00:33.546946 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '472e5507-6174-4719-bda1-5b9935ff7321', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b654770>]}
[0m12:00:33.548701 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.price_gap_filtered ................. [[32mSUCCESS 1[0m in 2.71s]
[0m12:00:33.550391 [debug] [Thread-1 (]: Finished running node model.Lab2_dbt_Folder.price_gap_filtered
[0m12:00:33.551514 [debug] [Thread-1 (]: Began running node model.Lab2_dbt_Folder.rolling_avg_filtered
[0m12:00:33.552264 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.rolling_avg_filtered .................... [RUN]
[0m12:00:33.553241 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Lab2_dbt_Folder.price_gap_filtered, now model.Lab2_dbt_Folder.rolling_avg_filtered)
[0m12:00:33.553906 [debug] [Thread-1 (]: Began compiling node model.Lab2_dbt_Folder.rolling_avg_filtered
[0m12:00:33.559988 [debug] [Thread-1 (]: Writing injected SQL for node "model.Lab2_dbt_Folder.rolling_avg_filtered"
[0m12:00:33.562876 [debug] [Thread-1 (]: Began executing node model.Lab2_dbt_Folder.rolling_avg_filtered
[0m12:00:33.565902 [debug] [Thread-1 (]: Writing runtime sql for node "model.Lab2_dbt_Folder.rolling_avg_filtered"
[0m12:00:33.567720 [debug] [Thread-1 (]: Using snowflake connection "model.Lab2_dbt_Folder.rolling_avg_filtered"
[0m12:00:33.568076 [debug] [Thread-1 (]: On model.Lab2_dbt_Folder.rolling_avg_filtered: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "node_id": "model.Lab2_dbt_Folder.rolling_avg_filtered"} */
create or replace transient table USER_DB_CATFISH.analytics.rolling_avg_filtered
         as
        (with __dbt__cte__rolling_average_calc as (


SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
) SELECT SYMBOL,
       DATE,
       ROLLING_AVERAGE
FROM __dbt__cte__rolling_average_calc
WHERE row_num >= 7
ORDER BY SYMBOL, DATE, row_num
        );
[0m12:00:33.568414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:35.257296 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.688 seconds
[0m12:00:35.261326 [debug] [Thread-1 (]: On model.Lab2_dbt_Folder.rolling_avg_filtered: Close
[0m12:00:35.418644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '472e5507-6174-4719-bda1-5b9935ff7321', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b67d5e0>]}
[0m12:00:35.420224 [info ] [Thread-1 (]: 3 of 3 OK created sql table model analytics.rolling_avg_filtered ............... [[32mSUCCESS 1[0m in 1.86s]
[0m12:00:35.421784 [debug] [Thread-1 (]: Finished running node model.Lab2_dbt_Folder.rolling_avg_filtered
[0m12:00:35.423953 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:00:35.424506 [debug] [MainThread]: Connection 'model.Lab2_dbt_Folder.rolling_avg_filtered' was properly closed.
[0m12:00:35.425132 [info ] [MainThread]: 
[0m12:00:35.425880 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 7.54 seconds (7.54s).
[0m12:00:35.427093 [debug] [MainThread]: Command end result
[0m12:00:35.453928 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m12:00:35.455458 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m12:00:35.459354 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m12:00:35.459595 [info ] [MainThread]: 
[0m12:00:35.460021 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:00:35.460238 [info ] [MainThread]: 
[0m12:00:35.460448 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:00:35.461089 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.217324, "process_user_time": 2.303113, "process_kernel_time": 0.250864, "process_mem_max_rss": "208124", "process_out_blocks": "1893", "process_in_blocks": "0"}
[0m12:00:35.461383 [debug] [MainThread]: Command `dbt run` succeeded at 12:00:35.461329 after 8.22 seconds
[0m12:00:35.461648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d2f1430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8028bc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d476b40>]}
[0m12:00:35.461845 [debug] [MainThread]: Flushing usage events
[0m12:00:35.907734 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:00:38.106697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5537770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa51446b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa51447a0>]}


============================== 12:00:38.109585 | 733106bc-37e8-4fb5-a4bd-29739db88f0f ==============================
[0m12:00:38.109585 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m12:00:38.109987 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:00:38.470791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '733106bc-37e8-4fb5-a4bd-29739db88f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa56cd370>]}
[0m12:00:38.490108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '733106bc-37e8-4fb5-a4bd-29739db88f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88779070>]}
[0m12:00:38.490454 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m12:00:38.526014 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m12:00:38.576904 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:00:38.577139 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:00:38.593277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '733106bc-37e8-4fb5-a4bd-29739db88f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff886f9b50>]}
[0m12:00:38.628791 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m12:00:38.629610 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m12:00:38.639974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '733106bc-37e8-4fb5-a4bd-29739db88f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff881260f0>]}
[0m12:00:38.640202 [info ] [MainThread]: Found 5 models, 3 data tests, 2 sources, 458 macros
[0m12:00:38.640550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '733106bc-37e8-4fb5-a4bd-29739db88f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b091610>]}
[0m12:00:38.641269 [info ] [MainThread]: 
[0m12:00:38.641477 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:00:38.641639 [info ] [MainThread]: 
[0m12:00:38.641870 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:00:38.643608 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH_analytics'
[0m12:00:38.649965 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_analytics"
[0m12:00:38.650129 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_analytics"} */
show terse objects in USER_DB_CATFISH.analytics limit 10000
[0m12:00:38.650269 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:00:39.215883 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.565 seconds
[0m12:00:39.219657 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: Close
[0m12:00:39.370036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '733106bc-37e8-4fb5-a4bd-29739db88f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6a15df0>]}
[0m12:00:39.380759 [debug] [Thread-1 (]: Began running node test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17
[0m12:00:39.381270 [info ] [Thread-1 (]: 1 of 3 START test not_null_rolling_average_calc_DATE ........................... [RUN]
[0m12:00:39.382076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_analytics, now test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17)
[0m12:00:39.382417 [debug] [Thread-1 (]: Began compiling node test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17
[0m12:00:39.397280 [debug] [Thread-1 (]: Writing injected SQL for node "test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17"
[0m12:00:39.398536 [debug] [Thread-1 (]: Writing injected SQL for node "test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17"
[0m12:00:39.399651 [debug] [Thread-1 (]: Began executing node test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17
[0m12:00:39.410586 [debug] [Thread-1 (]: Writing runtime sql for node "test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17"
[0m12:00:39.411706 [debug] [Thread-1 (]: Using snowflake connection "test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17"
[0m12:00:39.411959 [debug] [Thread-1 (]: On test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "node_id": "test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__rolling_average_calc as (


SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
) select DATE
from __dbt__cte__rolling_average_calc
where DATE is null



      
    ) dbt_internal_test
[0m12:00:39.412174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:40.301283 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.889 seconds
[0m12:00:40.313507 [debug] [Thread-1 (]: On test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17: Close
[0m12:00:40.457140 [info ] [Thread-1 (]: 1 of 3 PASS not_null_rolling_average_calc_DATE ................................. [[32mPASS[0m in 1.07s]
[0m12:00:40.458716 [debug] [Thread-1 (]: Finished running node test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17
[0m12:00:40.459596 [debug] [Thread-1 (]: Began running node test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6
[0m12:00:40.460331 [info ] [Thread-1 (]: 2 of 3 START test not_null_rolling_average_calc_SYMBOL ......................... [RUN]
[0m12:00:40.462042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Lab2_dbt_Folder.not_null_rolling_average_calc_DATE.687edb0d17, now test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6)
[0m12:00:40.462960 [debug] [Thread-1 (]: Began compiling node test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6
[0m12:00:40.470354 [debug] [Thread-1 (]: Writing injected SQL for node "test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6"
[0m12:00:40.472015 [debug] [Thread-1 (]: Began executing node test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6
[0m12:00:40.474543 [debug] [Thread-1 (]: Writing runtime sql for node "test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6"
[0m12:00:40.476317 [debug] [Thread-1 (]: Using snowflake connection "test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6"
[0m12:00:40.476746 [debug] [Thread-1 (]: On test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "node_id": "test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__rolling_average_calc as (


SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
) select SYMBOL
from __dbt__cte__rolling_average_calc
where SYMBOL is null



      
    ) dbt_internal_test
[0m12:00:40.477127 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:41.392213 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.915 seconds
[0m12:00:41.395809 [debug] [Thread-1 (]: On test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6: Close
[0m12:00:41.544773 [info ] [Thread-1 (]: 2 of 3 PASS not_null_rolling_average_calc_SYMBOL ............................... [[32mPASS[0m in 1.08s]
[0m12:00:41.546824 [debug] [Thread-1 (]: Finished running node test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6
[0m12:00:41.547745 [debug] [Thread-1 (]: Began running node test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28
[0m12:00:41.548536 [info ] [Thread-1 (]: 3 of 3 START test not_null_rolling_average_calc_row_num ........................ [RUN]
[0m12:00:41.549514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Lab2_dbt_Folder.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6, now test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28)
[0m12:00:41.550113 [debug] [Thread-1 (]: Began compiling node test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28
[0m12:00:41.557413 [debug] [Thread-1 (]: Writing injected SQL for node "test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28"
[0m12:00:41.559025 [debug] [Thread-1 (]: Began executing node test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28
[0m12:00:41.561507 [debug] [Thread-1 (]: Writing runtime sql for node "test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28"
[0m12:00:41.563493 [debug] [Thread-1 (]: Using snowflake connection "test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28"
[0m12:00:41.563888 [debug] [Thread-1 (]: On test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "lab2_profile", "target_name": "dev", "node_id": "test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__rolling_average_calc as (


SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
) select row_num
from __dbt__cte__rolling_average_calc
where row_num is null



      
    ) dbt_internal_test
[0m12:00:41.564342 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:42.026685 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.462 seconds
[0m12:00:42.029887 [debug] [Thread-1 (]: On test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28: Close
[0m12:00:42.161027 [info ] [Thread-1 (]: 3 of 3 PASS not_null_rolling_average_calc_row_num .............................. [[32mPASS[0m in 0.61s]
[0m12:00:42.161724 [debug] [Thread-1 (]: Finished running node test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28
[0m12:00:42.163081 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:00:42.163412 [debug] [MainThread]: Connection 'test.Lab2_dbt_Folder.not_null_rolling_average_calc_row_num.05f5f58c28' was properly closed.
[0m12:00:42.163713 [info ] [MainThread]: 
[0m12:00:42.164133 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 3.52 seconds (3.52s).
[0m12:00:42.164960 [debug] [MainThread]: Command end result
[0m12:00:42.185537 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m12:00:42.186794 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m12:00:42.190470 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m12:00:42.190656 [info ] [MainThread]: 
[0m12:00:42.190995 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:00:42.191214 [info ] [MainThread]: 
[0m12:00:42.191412 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:00:42.192056 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.1040187, "process_user_time": 2.101936, "process_kernel_time": 0.108284, "process_mem_max_rss": "210280", "process_out_blocks": "1896", "process_in_blocks": "0"}
[0m12:00:42.192323 [debug] [MainThread]: Command `dbt test` succeeded at 12:00:42.192275 after 4.10 seconds
[0m12:00:42.192524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa70e3800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa585fa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa56a0440>]}
[0m12:00:42.192719 [debug] [MainThread]: Flushing usage events
[0m12:00:42.596417 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:00:44.219278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf1d59d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf8d74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaeffa180>]}


============================== 12:00:44.223063 | 0a050837-908c-497f-8c01-33360ef2acdf ==============================
[0m12:00:44.223063 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m12:00:44.223485 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:00:44.589742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a050837-908c-497f-8c01-33360ef2acdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaee592b0>]}
[0m12:00:44.609222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a050837-908c-497f-8c01-33360ef2acdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e7d8680>]}
[0m12:00:44.609598 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m12:00:44.647764 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m12:00:44.698220 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:00:44.698456 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:00:44.715237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a050837-908c-497f-8c01-33360ef2acdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8db8ff80>]}
[0m12:00:44.767129 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m12:00:44.769045 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m12:00:44.774901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a050837-908c-497f-8c01-33360ef2acdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dc8f560>]}
[0m12:00:44.775132 [info ] [MainThread]: Found 5 models, 3 data tests, 2 sources, 458 macros
[0m12:00:44.775525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a050837-908c-497f-8c01-33360ef2acdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d9b7bc0>]}
[0m12:00:44.776260 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:00:44.777153 [debug] [MainThread]: Command end result
[0m12:00:44.787960 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m12:00:44.788607 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m12:00:44.789910 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m12:00:44.790339 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.59028906, "process_user_time": 1.866223, "process_kernel_time": 0.078641, "process_mem_max_rss": "200908", "process_out_blocks": "1848", "process_in_blocks": "0"}
[0m12:00:44.790552 [debug] [MainThread]: Command `dbt snapshot` succeeded at 12:00:44.790514 after 0.59 seconds
[0m12:00:44.790715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaef403b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d9b23f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaeffb380>]}
[0m12:00:44.790863 [debug] [MainThread]: Flushing usage events
[0m12:00:45.489163 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:37:23.834659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c38a810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bc02240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b9fa930>]}


============================== 07:37:23.838238 | f060e092-420f-4ccb-9e1c-04dd676a040f ==============================
[0m07:37:23.838238 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m07:37:23.838739 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:37:24.248859 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m07:37:24.249260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f060e092-420f-4ccb-9e1c-04dd676a040f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81de1580>]}
[0m07:37:24.314357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f060e092-420f-4ccb-9e1c-04dd676a040f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9da469c0>]}
[0m07:37:24.336463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f060e092-420f-4ccb-9e1c-04dd676a040f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bc7f350>]}
[0m07:37:24.336964 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m07:37:24.377667 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found more than one package with the name "dbt" included in this project. Package names must be unique in a project. Please rename one of these packages.
[0m07:37:24.378434 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5654379, "process_user_time": 1.885658, "process_kernel_time": 0.219286, "process_mem_max_rss": "196480", "process_in_blocks": "2176", "process_out_blocks": "1069", "command_success": false}
[0m07:37:24.378705 [debug] [MainThread]: Command `dbt run` failed at 07:37:24.378641 after 0.57 seconds
[0m07:37:24.378938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bc8cd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b4c6a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b8d5970>]}
[0m07:37:24.379151 [debug] [MainThread]: Flushing usage events
[0m07:37:24.840220 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:39:35.092412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95a1f3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95f283b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95694170>]}


============================== 07:39:35.096743 | 8d4d44ba-0c76-4893-b509-5d40ae54cb60 ==============================
[0m07:39:35.096743 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m07:39:35.097233 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:39:35.531349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d4d44ba-0c76-4893-b509-5d40ae54cb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95649370>]}
[0m07:39:35.552075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d4d44ba-0c76-4893-b509-5d40ae54cb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff788a91c0>]}
[0m07:39:35.552436 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m07:39:35.592967 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m07:39:35.636631 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m07:39:35.637023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8d4d44ba-0c76-4893-b509-5d40ae54cb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff783a25d0>]}
[0m07:39:36.082769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d4d44ba-0c76-4893-b509-5d40ae54cb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff783a1970>]}
[0m07:39:36.155481 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m07:39:36.156558 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m07:39:36.165653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d4d44ba-0c76-4893-b509-5d40ae54cb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff950c2e70>]}
[0m07:39:36.165916 [info ] [MainThread]: Found 5 models, 3 data tests, 2 sources, 458 macros
[0m07:39:36.166244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d4d44ba-0c76-4893-b509-5d40ae54cb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72deed50>]}
[0m07:39:36.167005 [info ] [MainThread]: 
[0m07:39:36.167220 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:39:36.167379 [info ] [MainThread]: 
[0m07:39:36.167632 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:39:36.169472 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH'
[0m07:39:36.175099 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH"
[0m07:39:36.175266 [debug] [ThreadPool]: On list_USER_DB_CATFISH: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH"} */
show terse schemas in database USER_DB_CATFISH
    limit 10000
[0m07:39:36.175405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:39:36.834304 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.659 seconds
[0m07:39:36.835416 [debug] [ThreadPool]: On list_USER_DB_CATFISH: Close
[0m07:39:36.971463 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH, now list_USER_DB_CATFISH_analytics)
[0m07:39:36.978450 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_analytics"
[0m07:39:36.978782 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_analytics"} */
show terse objects in USER_DB_CATFISH.analytics limit 10000
[0m07:39:36.979034 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:39:37.336553 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.357 seconds
[0m07:39:37.339349 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: Close
[0m07:39:37.473771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d4d44ba-0c76-4893-b509-5d40ae54cb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78a3b9e0>]}
[0m07:39:37.487364 [debug] [Thread-1 (]: Began running node model.stock_elt_project.lab1_stock_price_table
[0m07:39:37.488249 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.lab1_stock_price_table ................... [RUN]
[0m07:39:37.489252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_analytics, now model.stock_elt_project.lab1_stock_price_table)
[0m07:39:37.489657 [debug] [Thread-1 (]: Began compiling node model.stock_elt_project.lab1_stock_price_table
[0m07:39:37.498521 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt_project.lab1_stock_price_table"
[0m07:39:37.501108 [debug] [Thread-1 (]: Began executing node model.stock_elt_project.lab1_stock_price_table
[0m07:39:37.519696 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_elt_project.lab1_stock_price_table"
[0m07:39:37.521760 [debug] [Thread-1 (]: Using snowflake connection "model.stock_elt_project.lab1_stock_price_table"
[0m07:39:37.522039 [debug] [Thread-1 (]: On model.stock_elt_project.lab1_stock_price_table: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_elt_project.lab1_stock_price_table"} */
create or replace   view USER_DB_CATFISH.analytics.lab1_stock_price_table
  
   as (
    SELECT *
FROM USER_DB_CATFISH.raw.raw_stock_data
  );
[0m07:39:37.522260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:39:38.090900 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.568 seconds
[0m07:39:38.117390 [debug] [Thread-1 (]: On model.stock_elt_project.lab1_stock_price_table: Close
[0m07:39:38.326369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d4d44ba-0c76-4893-b509-5d40ae54cb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff957d98b0>]}
[0m07:39:38.328102 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.lab1_stock_price_table .............. [[32mSUCCESS 1[0m in 0.83s]
[0m07:39:38.329769 [debug] [Thread-1 (]: Finished running node model.stock_elt_project.lab1_stock_price_table
[0m07:39:38.331452 [debug] [Thread-1 (]: Began running node model.stock_elt_project.price_gap_calc
[0m07:39:38.332203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt_project.lab1_stock_price_table, now model.stock_elt_project.price_gap_calc)
[0m07:39:38.332685 [debug] [Thread-1 (]: Began compiling node model.stock_elt_project.price_gap_calc
[0m07:39:38.336281 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt_project.price_gap_calc"
[0m07:39:38.338533 [debug] [Thread-1 (]: Finished running node model.stock_elt_project.price_gap_calc
[0m07:39:38.338941 [debug] [Thread-1 (]: Began running node model.stock_elt_project.rolling_average_calc
[0m07:39:38.339476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt_project.price_gap_calc, now model.stock_elt_project.rolling_average_calc)
[0m07:39:38.339855 [debug] [Thread-1 (]: Began compiling node model.stock_elt_project.rolling_average_calc
[0m07:39:38.342409 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt_project.rolling_average_calc"
[0m07:39:38.343721 [debug] [Thread-1 (]: Finished running node model.stock_elt_project.rolling_average_calc
[0m07:39:38.344084 [debug] [Thread-1 (]: Began running node model.stock_elt_project.price_gap_filtered
[0m07:39:38.344571 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.price_gap_filtered ...................... [RUN]
[0m07:39:38.344932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt_project.rolling_average_calc, now model.stock_elt_project.price_gap_filtered)
[0m07:39:38.345206 [debug] [Thread-1 (]: Began compiling node model.stock_elt_project.price_gap_filtered
[0m07:39:38.347944 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt_project.price_gap_filtered"
[0m07:39:38.349112 [debug] [Thread-1 (]: Began executing node model.stock_elt_project.price_gap_filtered
[0m07:39:38.363433 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_elt_project.price_gap_filtered"
[0m07:39:38.365088 [debug] [Thread-1 (]: Using snowflake connection "model.stock_elt_project.price_gap_filtered"
[0m07:39:38.365311 [debug] [Thread-1 (]: On model.stock_elt_project.price_gap_filtered: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_elt_project.price_gap_filtered"} */
create or replace transient table USER_DB_CATFISH.analytics.price_gap_filtered
         as
        (with __dbt__cte__price_gap_calc as (
SELECT SYMBOL,
        DT AS DATE,
        OPEN,
        LAG(CLOSE, 1) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DT) as LAST_CLOSING
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
ORDER BY SYMBOL, DATE
) SELECT *,
       (OPEN - LAST_CLOSING) AS PRICE_GAP
FROM __dbt__cte__price_gap_calc
WHERE LAST_CLOSING IS NOT NULL
        );
[0m07:39:38.365519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:39:40.062468 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.697 seconds
[0m07:39:40.066107 [debug] [Thread-1 (]: On model.stock_elt_project.price_gap_filtered: Close
[0m07:39:40.209810 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d4d44ba-0c76-4893-b509-5d40ae54cb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95e8ec90>]}
[0m07:39:40.210633 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.price_gap_filtered ................. [[32mSUCCESS 1[0m in 1.86s]
[0m07:39:40.211790 [debug] [Thread-1 (]: Finished running node model.stock_elt_project.price_gap_filtered
[0m07:39:40.212475 [debug] [Thread-1 (]: Began running node model.stock_elt_project.rolling_avg_filtered
[0m07:39:40.212942 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.rolling_avg_filtered .................... [RUN]
[0m07:39:40.213522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt_project.price_gap_filtered, now model.stock_elt_project.rolling_avg_filtered)
[0m07:39:40.213783 [debug] [Thread-1 (]: Began compiling node model.stock_elt_project.rolling_avg_filtered
[0m07:39:40.216371 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt_project.rolling_avg_filtered"
[0m07:39:40.217259 [debug] [Thread-1 (]: Began executing node model.stock_elt_project.rolling_avg_filtered
[0m07:39:40.218815 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_elt_project.rolling_avg_filtered"
[0m07:39:40.220023 [debug] [Thread-1 (]: Using snowflake connection "model.stock_elt_project.rolling_avg_filtered"
[0m07:39:40.220228 [debug] [Thread-1 (]: On model.stock_elt_project.rolling_avg_filtered: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_elt_project.rolling_avg_filtered"} */
create or replace transient table USER_DB_CATFISH.analytics.rolling_avg_filtered
         as
        (with __dbt__cte__rolling_average_calc as (


SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
) SELECT SYMBOL,
       DATE,
       ROLLING_AVERAGE
FROM __dbt__cte__rolling_average_calc
WHERE row_num >= 7
ORDER BY SYMBOL, DATE, row_num
        );
[0m07:39:40.220438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:39:41.557350 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.337 seconds
[0m07:39:41.561846 [debug] [Thread-1 (]: On model.stock_elt_project.rolling_avg_filtered: Close
[0m07:39:41.745804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d4d44ba-0c76-4893-b509-5d40ae54cb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72d03ad0>]}
[0m07:39:41.747592 [info ] [Thread-1 (]: 3 of 3 OK created sql table model analytics.rolling_avg_filtered ............... [[32mSUCCESS 1[0m in 1.53s]
[0m07:39:41.749607 [debug] [Thread-1 (]: Finished running node model.stock_elt_project.rolling_avg_filtered
[0m07:39:41.753361 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:39:41.754229 [debug] [MainThread]: Connection 'model.stock_elt_project.rolling_avg_filtered' was properly closed.
[0m07:39:41.755259 [info ] [MainThread]: 
[0m07:39:41.756473 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 5.59 seconds (5.59s).
[0m07:39:41.758519 [debug] [MainThread]: Command end result
[0m07:39:41.785355 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m07:39:41.786800 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m07:39:41.790520 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m07:39:41.790714 [info ] [MainThread]: 
[0m07:39:41.791113 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:39:41.791329 [info ] [MainThread]: 
[0m07:39:41.791504 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m07:39:41.792244 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.720482, "process_user_time": 2.742289, "process_kernel_time": 0.238723, "process_mem_max_rss": "212440", "process_in_blocks": "40", "process_out_blocks": "2918"}
[0m07:39:41.792511 [debug] [MainThread]: Command `dbt run` succeeded at 07:39:41.792461 after 6.72 seconds
[0m07:39:41.792721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94e5b5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff780d5b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72ccf650>]}
[0m07:39:41.792914 [debug] [MainThread]: Flushing usage events
[0m07:39:42.544559 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:39:43.852983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0d7f0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb247f740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2e238f0>]}


============================== 07:39:43.855904 | 557a82c4-f9ca-4a56-9e00-62d124167d3f ==============================
[0m07:39:43.855904 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m07:39:43.856368 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m07:39:44.217560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '557a82c4-f9ca-4a56-9e00-62d124167d3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb14892e0>]}
[0m07:39:44.238161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '557a82c4-f9ca-4a56-9e00-62d124167d3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb10dade0>]}
[0m07:39:44.238514 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m07:39:44.276284 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m07:39:44.329689 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:39:44.329917 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:39:44.346713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '557a82c4-f9ca-4a56-9e00-62d124167d3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1261730>]}
[0m07:39:44.384194 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m07:39:44.385078 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m07:39:44.396456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '557a82c4-f9ca-4a56-9e00-62d124167d3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fea1730>]}
[0m07:39:44.396698 [info ] [MainThread]: Found 5 models, 3 data tests, 2 sources, 458 macros
[0m07:39:44.397036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '557a82c4-f9ca-4a56-9e00-62d124167d3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94409280>]}
[0m07:39:44.397770 [info ] [MainThread]: 
[0m07:39:44.397984 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:39:44.398131 [info ] [MainThread]: 
[0m07:39:44.398361 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:39:44.400118 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH_analytics'
[0m07:39:44.406692 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_analytics"
[0m07:39:44.406865 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_analytics"} */
show terse objects in USER_DB_CATFISH.analytics limit 10000
[0m07:39:44.407004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:39:44.795327 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.388 seconds
[0m07:39:44.797695 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: Close
[0m07:39:44.946297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '557a82c4-f9ca-4a56-9e00-62d124167d3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94408a70>]}
[0m07:39:44.958741 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_rolling_average_calc_DATE.687edb0d17
[0m07:39:44.959291 [info ] [Thread-1 (]: 1 of 3 START test not_null_rolling_average_calc_DATE ........................... [RUN]
[0m07:39:44.960006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_analytics, now test.stock_elt_project.not_null_rolling_average_calc_DATE.687edb0d17)
[0m07:39:44.960230 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_rolling_average_calc_DATE.687edb0d17
[0m07:39:44.969052 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_rolling_average_calc_DATE.687edb0d17"
[0m07:39:44.970089 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_rolling_average_calc_DATE.687edb0d17"
[0m07:39:44.970954 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_rolling_average_calc_DATE.687edb0d17
[0m07:39:44.979235 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_rolling_average_calc_DATE.687edb0d17"
[0m07:39:44.980332 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_rolling_average_calc_DATE.687edb0d17"
[0m07:39:44.980521 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_rolling_average_calc_DATE.687edb0d17: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_rolling_average_calc_DATE.687edb0d17"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__rolling_average_calc as (


SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
) select DATE
from __dbt__cte__rolling_average_calc
where DATE is null



      
    ) dbt_internal_test
[0m07:39:44.980709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:39:45.412939 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.432 seconds
[0m07:39:45.427611 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_rolling_average_calc_DATE.687edb0d17: Close
[0m07:39:45.568425 [info ] [Thread-1 (]: 1 of 3 PASS not_null_rolling_average_calc_DATE ................................. [[32mPASS[0m in 0.61s]
[0m07:39:45.570405 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_rolling_average_calc_DATE.687edb0d17
[0m07:39:45.571294 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6
[0m07:39:45.572043 [info ] [Thread-1 (]: 2 of 3 START test not_null_rolling_average_calc_SYMBOL ......................... [RUN]
[0m07:39:45.573051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_rolling_average_calc_DATE.687edb0d17, now test.stock_elt_project.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6)
[0m07:39:45.573647 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6
[0m07:39:45.580808 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6"
[0m07:39:45.582880 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6
[0m07:39:45.585868 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6"
[0m07:39:45.588169 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6"
[0m07:39:45.588601 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__rolling_average_calc as (


SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
) select SYMBOL
from __dbt__cte__rolling_average_calc
where SYMBOL is null



      
    ) dbt_internal_test
[0m07:39:45.589030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:39:47.260651 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.671 seconds
[0m07:39:47.264162 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6: Close
[0m07:39:47.398917 [info ] [Thread-1 (]: 2 of 3 PASS not_null_rolling_average_calc_SYMBOL ............................... [[32mPASS[0m in 1.82s]
[0m07:39:47.400915 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6
[0m07:39:47.402421 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_rolling_average_calc_row_num.05f5f58c28
[0m07:39:47.403257 [info ] [Thread-1 (]: 3 of 3 START test not_null_rolling_average_calc_row_num ........................ [RUN]
[0m07:39:47.405019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6, now test.stock_elt_project.not_null_rolling_average_calc_row_num.05f5f58c28)
[0m07:39:47.405799 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_rolling_average_calc_row_num.05f5f58c28
[0m07:39:47.413869 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_rolling_average_calc_row_num.05f5f58c28"
[0m07:39:47.416638 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_rolling_average_calc_row_num.05f5f58c28
[0m07:39:47.419344 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_rolling_average_calc_row_num.05f5f58c28"
[0m07:39:47.421276 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_rolling_average_calc_row_num.05f5f58c28"
[0m07:39:47.421685 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_rolling_average_calc_row_num.05f5f58c28: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_rolling_average_calc_row_num.05f5f58c28"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__rolling_average_calc as (


SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
) select row_num
from __dbt__cte__rolling_average_calc
where row_num is null



      
    ) dbt_internal_test
[0m07:39:47.422026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:39:47.840438 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.418 seconds
[0m07:39:47.844195 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_rolling_average_calc_row_num.05f5f58c28: Close
[0m07:39:47.988566 [info ] [Thread-1 (]: 3 of 3 PASS not_null_rolling_average_calc_row_num .............................. [[32mPASS[0m in 0.58s]
[0m07:39:47.989943 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_rolling_average_calc_row_num.05f5f58c28
[0m07:39:47.992690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:39:47.993224 [debug] [MainThread]: Connection 'test.stock_elt_project.not_null_rolling_average_calc_row_num.05f5f58c28' was properly closed.
[0m07:39:47.996136 [info ] [MainThread]: 
[0m07:39:47.996584 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 3.60 seconds (3.60s).
[0m07:39:47.997792 [debug] [MainThread]: Command end result
[0m07:39:48.023919 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m07:39:48.025415 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m07:39:48.029228 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m07:39:48.029405 [info ] [MainThread]: 
[0m07:39:48.029787 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:39:48.030044 [info ] [MainThread]: 
[0m07:39:48.030224 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m07:39:48.030964 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.19849, "process_user_time": 2.137369, "process_kernel_time": 0.128022, "process_mem_max_rss": "210376", "process_in_blocks": "16", "process_out_blocks": "1897"}
[0m07:39:48.031267 [debug] [MainThread]: Command `dbt test` succeeded at 07:39:48.031211 after 4.20 seconds
[0m07:39:48.031499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0fbfbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0fbd940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fe73e00>]}
[0m07:39:48.031710 [debug] [MainThread]: Flushing usage events
[0m07:39:48.422759 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:39:49.937427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1021940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa09d8bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0f849e0>]}


============================== 07:39:49.940738 | 2230ca87-55ea-49a8-b2a4-e548b4f2b6dd ==============================
[0m07:39:49.940738 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m07:39:49.941147 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:39:50.319455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2230ca87-55ea-49a8-b2a4-e548b4f2b6dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87370920>]}
[0m07:39:50.340065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2230ca87-55ea-49a8-b2a4-e548b4f2b6dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff840e5100>]}
[0m07:39:50.340422 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m07:39:50.378062 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m07:39:50.431561 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:39:50.431790 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:39:50.449324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2230ca87-55ea-49a8-b2a4-e548b4f2b6dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fbdffe0>]}
[0m07:39:50.486681 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m07:39:50.487586 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m07:39:50.493900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2230ca87-55ea-49a8-b2a4-e548b4f2b6dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f9a7f80>]}
[0m07:39:50.494120 [info ] [MainThread]: Found 5 models, 3 data tests, 2 sources, 458 macros
[0m07:39:50.494468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2230ca87-55ea-49a8-b2a4-e548b4f2b6dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f95b9b0>]}
[0m07:39:50.495152 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:39:50.495980 [debug] [MainThread]: Command end result
[0m07:39:50.507512 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m07:39:50.508337 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m07:39:50.509642 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m07:39:50.510060 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.5919695, "process_user_time": 1.88656, "process_kernel_time": 0.091929, "process_mem_max_rss": "201008", "process_out_blocks": "1848", "process_in_blocks": "0"}
[0m07:39:50.510290 [debug] [MainThread]: Command `dbt snapshot` succeeded at 07:39:50.510236 after 0.59 seconds
[0m07:39:50.510472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa242b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fbddcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0853440>]}
[0m07:39:50.510628 [debug] [MainThread]: Flushing usage events
[0m07:39:50.896122 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:47:03.506795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6e0dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa66b25a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa66b1d30>]}


============================== 12:47:03.511019 | 3d3b95cb-f44e-483e-9a2f-76e6451a6779 ==============================
[0m12:47:03.511019 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m12:47:03.511588 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:47:03.955770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d3b95cb-f44e-483e-9a2f-76e6451a6779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6c39400>]}
[0m12:47:03.975579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d3b95cb-f44e-483e-9a2f-76e6451a6779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa652dc40>]}
[0m12:47:03.975938 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m12:47:04.011838 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m12:47:04.061095 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:47:04.061297 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:47:04.077699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d3b95cb-f44e-483e-9a2f-76e6451a6779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85f77320>]}
[0m12:47:04.111871 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m12:47:04.112721 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m12:47:04.118776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d3b95cb-f44e-483e-9a2f-76e6451a6779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8596ebd0>]}
[0m12:47:04.118977 [info ] [MainThread]: Found 5 models, 3 data tests, 2 sources, 458 macros
[0m12:47:04.119120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d3b95cb-f44e-483e-9a2f-76e6451a6779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85861880>]}
[0m12:47:04.119967 [info ] [MainThread]: 
[0m12:47:04.120226 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:47:04.120417 [info ] [MainThread]: 
[0m12:47:04.120696 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:47:04.122361 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH'
[0m12:47:04.128423 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH"
[0m12:47:04.128582 [debug] [ThreadPool]: On list_USER_DB_CATFISH: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH"} */
show terse schemas in database USER_DB_CATFISH
    limit 10000
[0m12:47:04.128704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:04.706649 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.578 seconds
[0m12:47:04.709767 [debug] [ThreadPool]: On list_USER_DB_CATFISH: Close
[0m12:47:04.882305 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH, now list_USER_DB_CATFISH_analytics)
[0m12:47:04.893449 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_analytics"
[0m12:47:04.894028 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_analytics"} */
show terse objects in USER_DB_CATFISH.analytics limit 10000
[0m12:47:04.894589 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:47:05.311068 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.416 seconds
[0m12:47:05.314212 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: Close
[0m12:47:05.522435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d3b95cb-f44e-483e-9a2f-76e6451a6779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85c97ce0>]}
[0m12:47:05.534828 [debug] [Thread-1 (]: Began running node model.stock_elt_project.lab1_stock_price_table
[0m12:47:05.535552 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.lab1_stock_price_table ................... [RUN]
[0m12:47:05.536620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_analytics, now model.stock_elt_project.lab1_stock_price_table)
[0m12:47:05.536959 [debug] [Thread-1 (]: Began compiling node model.stock_elt_project.lab1_stock_price_table
[0m12:47:05.543400 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt_project.lab1_stock_price_table"
[0m12:47:05.544919 [debug] [Thread-1 (]: Began executing node model.stock_elt_project.lab1_stock_price_table
[0m12:47:05.562219 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_elt_project.lab1_stock_price_table"
[0m12:47:05.563375 [debug] [Thread-1 (]: Using snowflake connection "model.stock_elt_project.lab1_stock_price_table"
[0m12:47:05.563613 [debug] [Thread-1 (]: On model.stock_elt_project.lab1_stock_price_table: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_elt_project.lab1_stock_price_table"} */
create or replace   view USER_DB_CATFISH.analytics.lab1_stock_price_table
  
   as (
    SELECT *
FROM USER_DB_CATFISH.raw.raw_stock_data
  );
[0m12:47:05.563845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:06.242865 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.679 seconds
[0m12:47:06.258511 [debug] [Thread-1 (]: On model.stock_elt_project.lab1_stock_price_table: Close
[0m12:47:06.391939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d3b95cb-f44e-483e-9a2f-76e6451a6779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6dc9e80>]}
[0m12:47:06.393316 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.lab1_stock_price_table .............. [[32mSUCCESS 1[0m in 0.85s]
[0m12:47:06.394279 [debug] [Thread-1 (]: Finished running node model.stock_elt_project.lab1_stock_price_table
[0m12:47:06.395638 [debug] [Thread-1 (]: Began running node model.stock_elt_project.price_gap_calc
[0m12:47:06.396450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt_project.lab1_stock_price_table, now model.stock_elt_project.price_gap_calc)
[0m12:47:06.397028 [debug] [Thread-1 (]: Began compiling node model.stock_elt_project.price_gap_calc
[0m12:47:06.400915 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt_project.price_gap_calc"
[0m12:47:06.403238 [debug] [Thread-1 (]: Finished running node model.stock_elt_project.price_gap_calc
[0m12:47:06.403782 [debug] [Thread-1 (]: Began running node model.stock_elt_project.rolling_average_calc
[0m12:47:06.404444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt_project.price_gap_calc, now model.stock_elt_project.rolling_average_calc)
[0m12:47:06.404909 [debug] [Thread-1 (]: Began compiling node model.stock_elt_project.rolling_average_calc
[0m12:47:06.407887 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt_project.rolling_average_calc"
[0m12:47:06.409029 [debug] [Thread-1 (]: Finished running node model.stock_elt_project.rolling_average_calc
[0m12:47:06.409388 [debug] [Thread-1 (]: Began running node model.stock_elt_project.price_gap_filtered
[0m12:47:06.409897 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.price_gap_filtered ...................... [RUN]
[0m12:47:06.410308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt_project.rolling_average_calc, now model.stock_elt_project.price_gap_filtered)
[0m12:47:06.410697 [debug] [Thread-1 (]: Began compiling node model.stock_elt_project.price_gap_filtered
[0m12:47:06.413794 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt_project.price_gap_filtered"
[0m12:47:06.414597 [debug] [Thread-1 (]: Began executing node model.stock_elt_project.price_gap_filtered
[0m12:47:06.429745 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_elt_project.price_gap_filtered"
[0m12:47:06.430700 [debug] [Thread-1 (]: Using snowflake connection "model.stock_elt_project.price_gap_filtered"
[0m12:47:06.430945 [debug] [Thread-1 (]: On model.stock_elt_project.price_gap_filtered: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_elt_project.price_gap_filtered"} */
create or replace transient table USER_DB_CATFISH.analytics.price_gap_filtered
         as
        (with __dbt__cte__price_gap_calc as (
SELECT SYMBOL,
        DT AS DATE,
        OPEN,
        LAG(CLOSE, 1) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DT) as LAST_CLOSING
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
ORDER BY SYMBOL, DATE
) SELECT *,
       (OPEN - LAST_CLOSING) AS PRICE_GAP
FROM __dbt__cte__price_gap_calc
WHERE LAST_CLOSING IS NOT NULL
        );
[0m12:47:06.431133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:23.304773 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 16.871 seconds
[0m12:47:23.324628 [debug] [Thread-1 (]: On model.stock_elt_project.price_gap_filtered: Close
[0m12:47:23.487845 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d3b95cb-f44e-483e-9a2f-76e6451a6779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84c87800>]}
[0m12:47:23.489835 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.price_gap_filtered ................. [[32mSUCCESS 1[0m in 17.08s]
[0m12:47:23.492239 [debug] [Thread-1 (]: Finished running node model.stock_elt_project.price_gap_filtered
[0m12:47:23.492893 [debug] [Thread-1 (]: Began running node model.stock_elt_project.rolling_avg_filtered
[0m12:47:23.494027 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.rolling_avg_filtered .................... [RUN]
[0m12:47:23.494937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt_project.price_gap_filtered, now model.stock_elt_project.rolling_avg_filtered)
[0m12:47:23.496278 [debug] [Thread-1 (]: Began compiling node model.stock_elt_project.rolling_avg_filtered
[0m12:47:23.508668 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt_project.rolling_avg_filtered"
[0m12:47:23.510020 [debug] [Thread-1 (]: Began executing node model.stock_elt_project.rolling_avg_filtered
[0m12:47:23.512029 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_elt_project.rolling_avg_filtered"
[0m12:47:23.513147 [debug] [Thread-1 (]: Using snowflake connection "model.stock_elt_project.rolling_avg_filtered"
[0m12:47:23.513353 [debug] [Thread-1 (]: On model.stock_elt_project.rolling_avg_filtered: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_elt_project.rolling_avg_filtered"} */
create or replace transient table USER_DB_CATFISH.analytics.rolling_avg_filtered
         as
        (with __dbt__cte__rolling_average_calc as (


SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
) SELECT SYMBOL,
       DATE,
       ROLLING_AVERAGE
FROM __dbt__cte__rolling_average_calc
WHERE row_num >= 7
ORDER BY SYMBOL, DATE, row_num
        );
[0m12:47:23.513563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:25.157304 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.644 seconds
[0m12:47:25.160607 [debug] [Thread-1 (]: On model.stock_elt_project.rolling_avg_filtered: Close
[0m12:47:25.310532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d3b95cb-f44e-483e-9a2f-76e6451a6779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84c915b0>]}
[0m12:47:25.311481 [info ] [Thread-1 (]: 3 of 3 OK created sql table model analytics.rolling_avg_filtered ............... [[32mSUCCESS 1[0m in 1.82s]
[0m12:47:25.312257 [debug] [Thread-1 (]: Finished running node model.stock_elt_project.rolling_avg_filtered
[0m12:47:25.315336 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:47:25.315870 [debug] [MainThread]: Connection 'model.stock_elt_project.rolling_avg_filtered' was properly closed.
[0m12:47:25.316847 [info ] [MainThread]: 
[0m12:47:25.317133 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 21.20 seconds (21.20s).
[0m12:47:25.317846 [debug] [MainThread]: Command end result
[0m12:47:25.343507 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m12:47:25.346232 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m12:47:25.351374 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m12:47:25.351634 [info ] [MainThread]: 
[0m12:47:25.353033 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:47:25.353570 [info ] [MainThread]: 
[0m12:47:25.353819 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:47:25.356329 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 21.86805, "process_user_time": 2.224401, "process_kernel_time": 0.248415, "process_mem_max_rss": "209168", "process_out_blocks": "1895", "process_in_blocks": "0"}
[0m12:47:25.356854 [debug] [MainThread]: Command `dbt run` succeeded at 12:47:25.356793 after 21.87 seconds
[0m12:47:25.357237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa62449b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6c848c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85bacaa0>]}
[0m12:47:25.357449 [debug] [MainThread]: Flushing usage events
[0m12:47:25.812837 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:47:27.480371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac5dda00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac0e6600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadbf3650>]}


============================== 12:47:27.483883 | b4eede8f-27da-4279-a8a1-0136184bb124 ==============================
[0m12:47:27.483883 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m12:47:27.484319 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m12:47:27.912764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4eede8f-27da-4279-a8a1-0136184bb124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac259370>]}
[0m12:47:27.932518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4eede8f-27da-4279-a8a1-0136184bb124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b2e5340>]}
[0m12:47:27.932876 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m12:47:27.972726 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m12:47:28.026374 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:47:28.026583 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:47:28.042781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4eede8f-27da-4279-a8a1-0136184bb124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b1d8830>]}
[0m12:47:28.077746 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m12:47:28.078599 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m12:47:28.090239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4eede8f-27da-4279-a8a1-0136184bb124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ac914c0>]}
[0m12:47:28.090439 [info ] [MainThread]: Found 5 models, 3 data tests, 2 sources, 458 macros
[0m12:47:28.090778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4eede8f-27da-4279-a8a1-0136184bb124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ad1b5f0>]}
[0m12:47:28.091519 [info ] [MainThread]: 
[0m12:47:28.091769 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:47:28.091969 [info ] [MainThread]: 
[0m12:47:28.092246 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:47:28.093864 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH_analytics'
[0m12:47:28.100433 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_analytics"
[0m12:47:28.100602 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_analytics"} */
show terse objects in USER_DB_CATFISH.analytics limit 10000
[0m12:47:28.100758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:28.659986 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.559 seconds
[0m12:47:28.662485 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: Close
[0m12:47:28.936456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4eede8f-27da-4279-a8a1-0136184bb124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aed4140>]}
[0m12:47:28.947326 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_rolling_average_calc_DATE.687edb0d17
[0m12:47:28.947928 [info ] [Thread-1 (]: 1 of 3 START test not_null_rolling_average_calc_DATE ........................... [RUN]
[0m12:47:28.948824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_analytics, now test.stock_elt_project.not_null_rolling_average_calc_DATE.687edb0d17)
[0m12:47:28.949237 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_rolling_average_calc_DATE.687edb0d17
[0m12:47:28.959083 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_rolling_average_calc_DATE.687edb0d17"
[0m12:47:28.960135 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_rolling_average_calc_DATE.687edb0d17"
[0m12:47:28.960675 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_rolling_average_calc_DATE.687edb0d17
[0m12:47:28.969052 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_rolling_average_calc_DATE.687edb0d17"
[0m12:47:28.969932 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_rolling_average_calc_DATE.687edb0d17"
[0m12:47:28.970137 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_rolling_average_calc_DATE.687edb0d17: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_rolling_average_calc_DATE.687edb0d17"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__rolling_average_calc as (


SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
) select DATE
from __dbt__cte__rolling_average_calc
where DATE is null



      
    ) dbt_internal_test
[0m12:47:28.970389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:29.861320 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.891 seconds
[0m12:47:29.867264 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_rolling_average_calc_DATE.687edb0d17: Close
[0m12:47:30.004843 [info ] [Thread-1 (]: 1 of 3 PASS not_null_rolling_average_calc_DATE ................................. [[32mPASS[0m in 1.06s]
[0m12:47:30.006267 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_rolling_average_calc_DATE.687edb0d17
[0m12:47:30.006748 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6
[0m12:47:30.007193 [info ] [Thread-1 (]: 2 of 3 START test not_null_rolling_average_calc_SYMBOL ......................... [RUN]
[0m12:47:30.007909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_rolling_average_calc_DATE.687edb0d17, now test.stock_elt_project.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6)
[0m12:47:30.008292 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6
[0m12:47:30.013270 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6"
[0m12:47:30.014461 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6
[0m12:47:30.016368 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6"
[0m12:47:30.017750 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6"
[0m12:47:30.018070 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__rolling_average_calc as (


SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
) select SYMBOL
from __dbt__cte__rolling_average_calc
where SYMBOL is null



      
    ) dbt_internal_test
[0m12:47:30.018400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:30.642007 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.623 seconds
[0m12:47:30.644375 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6: Close
[0m12:47:30.792384 [info ] [Thread-1 (]: 2 of 3 PASS not_null_rolling_average_calc_SYMBOL ............................... [[32mPASS[0m in 0.78s]
[0m12:47:30.794106 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6
[0m12:47:30.794865 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_rolling_average_calc_row_num.05f5f58c28
[0m12:47:30.795418 [info ] [Thread-1 (]: 3 of 3 START test not_null_rolling_average_calc_row_num ........................ [RUN]
[0m12:47:30.796088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6, now test.stock_elt_project.not_null_rolling_average_calc_row_num.05f5f58c28)
[0m12:47:30.796510 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_rolling_average_calc_row_num.05f5f58c28
[0m12:47:30.803182 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_rolling_average_calc_row_num.05f5f58c28"
[0m12:47:30.804659 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_rolling_average_calc_row_num.05f5f58c28
[0m12:47:30.806110 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_rolling_average_calc_row_num.05f5f58c28"
[0m12:47:30.807191 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_rolling_average_calc_row_num.05f5f58c28"
[0m12:47:30.807488 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_rolling_average_calc_row_num.05f5f58c28: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_rolling_average_calc_row_num.05f5f58c28"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__rolling_average_calc as (


SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
) select row_num
from __dbt__cte__rolling_average_calc
where row_num is null



      
    ) dbt_internal_test
[0m12:47:30.807893 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:31.222249 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.414 seconds
[0m12:47:31.226178 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_rolling_average_calc_row_num.05f5f58c28: Close
[0m12:47:31.377151 [info ] [Thread-1 (]: 3 of 3 PASS not_null_rolling_average_calc_row_num .............................. [[32mPASS[0m in 0.58s]
[0m12:47:31.379082 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_rolling_average_calc_row_num.05f5f58c28
[0m12:47:31.381931 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:47:31.382605 [debug] [MainThread]: Connection 'test.stock_elt_project.not_null_rolling_average_calc_row_num.05f5f58c28' was properly closed.
[0m12:47:31.383286 [info ] [MainThread]: 
[0m12:47:31.384248 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 3.29 seconds (3.29s).
[0m12:47:31.385647 [debug] [MainThread]: Command end result
[0m12:47:31.415207 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m12:47:31.416865 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m12:47:31.421171 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m12:47:31.421417 [info ] [MainThread]: 
[0m12:47:31.421948 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:47:31.422247 [info ] [MainThread]: 
[0m12:47:31.422474 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:47:31.423293 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.9668286, "process_user_time": 2.151463, "process_kernel_time": 0.207065, "process_mem_max_rss": "210256", "process_out_blocks": "1897", "process_in_blocks": "0"}
[0m12:47:31.423604 [debug] [MainThread]: Command `dbt test` succeeded at 12:47:31.423540 after 3.97 seconds
[0m12:47:31.423885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabf25400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac42c410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b2e70e0>]}
[0m12:47:31.424322 [debug] [MainThread]: Flushing usage events
[0m12:47:31.804286 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:33:44.897600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89a49880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8baf3bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89dfae40>]}


============================== 13:33:44.901414 | e04157fd-efa0-4222-865f-298ca3ebee85 ==============================
[0m13:33:44.901414 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m13:33:44.902024 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:33:45.345195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e04157fd-efa0-4222-865f-298ca3ebee85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a0193d0>]}
[0m13:33:45.364864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e04157fd-efa0-4222-865f-298ca3ebee85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff706d1eb0>]}
[0m13:33:45.365233 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m13:33:45.407127 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m13:33:45.460527 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:33:45.460764 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:33:45.477091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e04157fd-efa0-4222-865f-298ca3ebee85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d08faa0>]}
[0m13:33:45.513243 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m13:33:45.514346 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m13:33:45.521130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e04157fd-efa0-4222-865f-298ca3ebee85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ce8f140>]}
[0m13:33:45.521347 [info ] [MainThread]: Found 5 models, 3 data tests, 2 sources, 458 macros
[0m13:33:45.521910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e04157fd-efa0-4222-865f-298ca3ebee85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d0dc8c0>]}
[0m13:33:45.522613 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:33:45.523698 [debug] [MainThread]: Command end result
[0m13:33:45.534756 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m13:33:45.535511 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m13:33:45.537065 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m13:33:45.537576 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.65862024, "process_user_time": 2.107402, "process_kernel_time": 0.153742, "process_mem_max_rss": "200924", "process_out_blocks": "1848", "process_in_blocks": "0"}
[0m13:33:45.537803 [debug] [MainThread]: Command `dbt snapshot` succeeded at 13:33:45.537763 after 0.66 seconds
[0m13:33:45.537960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff894d27b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89fec440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d08fe00>]}
[0m13:33:45.538099 [debug] [MainThread]: Flushing usage events
[0m13:33:45.987028 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:12:20.820886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9857da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9983b860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98360710>]}


============================== 12:12:20.825136 | ee955cc4-de4b-49cb-89dd-169f593fabd2 ==============================
[0m12:12:20.825136 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m12:12:20.825629 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:12:21.316072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee955cc4-de4b-49cb-89dd-169f593fabd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9787bf20>]}
[0m12:12:21.336414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee955cc4-de4b-49cb-89dd-169f593fabd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7db88c50>]}
[0m12:12:21.336781 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m12:12:21.377469 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m12:12:21.425731 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:12:21.426226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ee955cc4-de4b-49cb-89dd-169f593fabd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76efb140>]}
[0m12:12:21.865205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee955cc4-de4b-49cb-89dd-169f593fabd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75bfbd70>]}
[0m12:12:21.940618 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m12:12:21.941794 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m12:12:21.949744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee955cc4-de4b-49cb-89dd-169f593fabd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76cfde80>]}
[0m12:12:21.949983 [info ] [MainThread]: Found 5 models, 3 data tests, 2 sources, 458 macros
[0m12:12:21.950377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee955cc4-de4b-49cb-89dd-169f593fabd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75ade810>]}
[0m12:12:21.951150 [info ] [MainThread]: 
[0m12:12:21.951357 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:12:21.951525 [info ] [MainThread]: 
[0m12:12:21.951824 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:12:21.953974 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH'
[0m12:12:21.960474 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH"
[0m12:12:21.960645 [debug] [ThreadPool]: On list_USER_DB_CATFISH: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH"} */
show terse schemas in database USER_DB_CATFISH
    limit 10000
[0m12:12:21.960771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:22.424048 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.463 seconds
[0m12:12:22.426358 [debug] [ThreadPool]: On list_USER_DB_CATFISH: Close
[0m12:12:22.582315 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH, now list_USER_DB_CATFISH_analytics)
[0m12:12:22.594653 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_analytics"
[0m12:12:22.595175 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_analytics"} */
show terse objects in USER_DB_CATFISH.analytics limit 10000
[0m12:12:22.595557 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:12:23.246357 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.651 seconds
[0m12:12:23.250438 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: Close
[0m12:12:23.419718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee955cc4-de4b-49cb-89dd-169f593fabd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76cbcc80>]}
[0m12:12:23.434238 [debug] [Thread-1 (]: Began running node model.stock_elt_project.lab1_stock_price_table
[0m12:12:23.435169 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.lab1_stock_price_table ................... [RUN]
[0m12:12:23.436220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_analytics, now model.stock_elt_project.lab1_stock_price_table)
[0m12:12:23.436627 [debug] [Thread-1 (]: Began compiling node model.stock_elt_project.lab1_stock_price_table
[0m12:12:23.445171 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt_project.lab1_stock_price_table"
[0m12:12:23.447072 [debug] [Thread-1 (]: Began executing node model.stock_elt_project.lab1_stock_price_table
[0m12:12:23.465163 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_elt_project.lab1_stock_price_table"
[0m12:12:23.466776 [debug] [Thread-1 (]: Using snowflake connection "model.stock_elt_project.lab1_stock_price_table"
[0m12:12:23.467042 [debug] [Thread-1 (]: On model.stock_elt_project.lab1_stock_price_table: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_elt_project.lab1_stock_price_table"} */
create or replace   view USER_DB_CATFISH.analytics.lab1_stock_price_table
  
   as (
    SELECT *
FROM USER_DB_CATFISH.raw.raw_stock_data
  );
[0m12:12:23.467311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:12:24.627852 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.160 seconds
[0m12:12:24.656249 [debug] [Thread-1 (]: On model.stock_elt_project.lab1_stock_price_table: Close
[0m12:12:24.795114 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee955cc4-de4b-49cb-89dd-169f593fabd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76ef98e0>]}
[0m12:12:24.795620 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.lab1_stock_price_table .............. [[32mSUCCESS 1[0m in 1.36s]
[0m12:12:24.796110 [debug] [Thread-1 (]: Finished running node model.stock_elt_project.lab1_stock_price_table
[0m12:12:24.796540 [debug] [Thread-1 (]: Began running node model.stock_elt_project.price_gap_calc
[0m12:12:24.796806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt_project.lab1_stock_price_table, now model.stock_elt_project.price_gap_calc)
[0m12:12:24.797003 [debug] [Thread-1 (]: Began compiling node model.stock_elt_project.price_gap_calc
[0m12:12:24.798505 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt_project.price_gap_calc"
[0m12:12:24.799587 [debug] [Thread-1 (]: Finished running node model.stock_elt_project.price_gap_calc
[0m12:12:24.799786 [debug] [Thread-1 (]: Began running node model.stock_elt_project.rolling_average_calc
[0m12:12:24.799986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt_project.price_gap_calc, now model.stock_elt_project.rolling_average_calc)
[0m12:12:24.800187 [debug] [Thread-1 (]: Began compiling node model.stock_elt_project.rolling_average_calc
[0m12:12:24.801374 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt_project.rolling_average_calc"
[0m12:12:24.802217 [debug] [Thread-1 (]: Finished running node model.stock_elt_project.rolling_average_calc
[0m12:12:24.802368 [debug] [Thread-1 (]: Began running node model.stock_elt_project.price_gap_filtered
[0m12:12:24.802617 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.price_gap_filtered ...................... [RUN]
[0m12:12:24.802916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt_project.rolling_average_calc, now model.stock_elt_project.price_gap_filtered)
[0m12:12:24.803073 [debug] [Thread-1 (]: Began compiling node model.stock_elt_project.price_gap_filtered
[0m12:12:24.804560 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt_project.price_gap_filtered"
[0m12:12:24.805053 [debug] [Thread-1 (]: Began executing node model.stock_elt_project.price_gap_filtered
[0m12:12:24.814352 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_elt_project.price_gap_filtered"
[0m12:12:24.815572 [debug] [Thread-1 (]: Using snowflake connection "model.stock_elt_project.price_gap_filtered"
[0m12:12:24.815742 [debug] [Thread-1 (]: On model.stock_elt_project.price_gap_filtered: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_elt_project.price_gap_filtered"} */
create or replace transient table USER_DB_CATFISH.analytics.price_gap_filtered
         as
        (with __dbt__cte__price_gap_calc as (
SELECT SYMBOL,
        DT AS DATE,
        OPEN,
        LAG(CLOSE, 1) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DT) as LAST_CLOSING
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
ORDER BY SYMBOL, DATE
) SELECT *,
       (OPEN - LAST_CLOSING) AS PRICE_GAP
FROM __dbt__cte__price_gap_calc
WHERE LAST_CLOSING IS NOT NULL
        );
[0m12:12:24.815889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:12:26.533232 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.717 seconds
[0m12:12:26.534726 [debug] [Thread-1 (]: On model.stock_elt_project.price_gap_filtered: Close
[0m12:12:26.684966 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee955cc4-de4b-49cb-89dd-169f593fabd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff989faff0>]}
[0m12:12:26.687017 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.price_gap_filtered ................. [[32mSUCCESS 1[0m in 1.88s]
[0m12:12:26.689143 [debug] [Thread-1 (]: Finished running node model.stock_elt_project.price_gap_filtered
[0m12:12:26.690110 [debug] [Thread-1 (]: Began running node model.stock_elt_project.rolling_avg_filtered
[0m12:12:26.691192 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.rolling_avg_filtered .................... [RUN]
[0m12:12:26.692646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt_project.price_gap_filtered, now model.stock_elt_project.rolling_avg_filtered)
[0m12:12:26.693244 [debug] [Thread-1 (]: Began compiling node model.stock_elt_project.rolling_avg_filtered
[0m12:12:26.699597 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt_project.rolling_avg_filtered"
[0m12:12:26.702108 [debug] [Thread-1 (]: Began executing node model.stock_elt_project.rolling_avg_filtered
[0m12:12:26.704754 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_elt_project.rolling_avg_filtered"
[0m12:12:26.706560 [debug] [Thread-1 (]: Using snowflake connection "model.stock_elt_project.rolling_avg_filtered"
[0m12:12:26.706972 [debug] [Thread-1 (]: On model.stock_elt_project.rolling_avg_filtered: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_elt_project.rolling_avg_filtered"} */
create or replace transient table USER_DB_CATFISH.analytics.rolling_avg_filtered
         as
        (with __dbt__cte__rolling_average_calc as (


SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
) SELECT SYMBOL,
       DATE,
       ROLLING_AVERAGE
FROM __dbt__cte__rolling_average_calc
WHERE row_num >= 7
ORDER BY SYMBOL, DATE, row_num
        );
[0m12:12:26.707349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:12:28.117052 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.410 seconds
[0m12:12:28.119635 [debug] [Thread-1 (]: On model.stock_elt_project.rolling_avg_filtered: Close
[0m12:12:28.271346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee955cc4-de4b-49cb-89dd-169f593fabd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75b3bf80>]}
[0m12:12:28.273160 [info ] [Thread-1 (]: 3 of 3 OK created sql table model analytics.rolling_avg_filtered ............... [[32mSUCCESS 1[0m in 1.58s]
[0m12:12:28.274855 [debug] [Thread-1 (]: Finished running node model.stock_elt_project.rolling_avg_filtered
[0m12:12:28.277278 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:12:28.277949 [debug] [MainThread]: Connection 'model.stock_elt_project.rolling_avg_filtered' was properly closed.
[0m12:12:28.278704 [info ] [MainThread]: 
[0m12:12:28.279328 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 6.33 seconds (6.33s).
[0m12:12:28.282451 [debug] [MainThread]: Command end result
[0m12:12:28.303187 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m12:12:28.305418 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m12:12:28.310080 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m12:12:28.310576 [info ] [MainThread]: 
[0m12:12:28.311406 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:12:28.311710 [info ] [MainThread]: 
[0m12:12:28.312117 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:12:28.313140 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.5122337, "process_user_time": 2.702279, "process_kernel_time": 0.401717, "process_mem_max_rss": "212320", "process_out_blocks": "2814", "process_in_blocks": "0"}
[0m12:12:28.313484 [debug] [MainThread]: Command `dbt run` succeeded at 12:12:28.313408 after 7.51 seconds
[0m12:12:28.313847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99f37d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75b0c680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75b0d730>]}
[0m12:12:28.314152 [debug] [MainThread]: Flushing usage events
[0m12:12:28.747359 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:12:30.032201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa7cfbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9afb140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab5df380>]}


============================== 12:12:30.035134 | ef252dc8-1f67-4afb-9f6f-74339ba0af31 ==============================
[0m12:12:30.035134 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m12:12:30.035425 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:12:30.396863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef252dc8-1f67-4afb-9f6f-74339ba0af31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d4ca720>]}
[0m12:12:30.417276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef252dc8-1f67-4afb-9f6f-74339ba0af31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d85d760>]}
[0m12:12:30.417670 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m12:12:30.455659 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m12:12:30.506476 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:12:30.506692 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:12:30.523593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef252dc8-1f67-4afb-9f6f-74339ba0af31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d3cdf70>]}
[0m12:12:30.559546 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m12:12:30.560487 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m12:12:30.575221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef252dc8-1f67-4afb-9f6f-74339ba0af31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d3835f0>]}
[0m12:12:30.575505 [info ] [MainThread]: Found 5 models, 3 data tests, 2 sources, 458 macros
[0m12:12:30.575862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef252dc8-1f67-4afb-9f6f-74339ba0af31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d40cd40>]}
[0m12:12:30.576574 [info ] [MainThread]: 
[0m12:12:30.576810 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:12:30.577002 [info ] [MainThread]: 
[0m12:12:30.577311 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:12:30.578997 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH_analytics'
[0m12:12:30.585551 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_analytics"
[0m12:12:30.585717 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_analytics"} */
show terse objects in USER_DB_CATFISH.analytics limit 10000
[0m12:12:30.585848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:31.045943 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.460 seconds
[0m12:12:31.049944 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: Close
[0m12:12:31.213487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef252dc8-1f67-4afb-9f6f-74339ba0af31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa60ad20>]}
[0m12:12:31.224458 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_rolling_average_calc_DATE.687edb0d17
[0m12:12:31.224934 [info ] [Thread-1 (]: 1 of 3 START test not_null_rolling_average_calc_DATE ........................... [RUN]
[0m12:12:31.226015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_analytics, now test.stock_elt_project.not_null_rolling_average_calc_DATE.687edb0d17)
[0m12:12:31.226333 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_rolling_average_calc_DATE.687edb0d17
[0m12:12:31.240279 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_rolling_average_calc_DATE.687edb0d17"
[0m12:12:31.241730 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_rolling_average_calc_DATE.687edb0d17"
[0m12:12:31.242381 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_rolling_average_calc_DATE.687edb0d17
[0m12:12:31.253417 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_rolling_average_calc_DATE.687edb0d17"
[0m12:12:31.254534 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_rolling_average_calc_DATE.687edb0d17"
[0m12:12:31.254752 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_rolling_average_calc_DATE.687edb0d17: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_rolling_average_calc_DATE.687edb0d17"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__rolling_average_calc as (


SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
) select DATE
from __dbt__cte__rolling_average_calc
where DATE is null



      
    ) dbt_internal_test
[0m12:12:31.254932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:12:32.001683 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.746 seconds
[0m12:12:32.015746 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_rolling_average_calc_DATE.687edb0d17: Close
[0m12:12:32.166529 [info ] [Thread-1 (]: 1 of 3 PASS not_null_rolling_average_calc_DATE ................................. [[32mPASS[0m in 0.94s]
[0m12:12:32.167665 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_rolling_average_calc_DATE.687edb0d17
[0m12:12:32.168157 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6
[0m12:12:32.168630 [info ] [Thread-1 (]: 2 of 3 START test not_null_rolling_average_calc_SYMBOL ......................... [RUN]
[0m12:12:32.169358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_rolling_average_calc_DATE.687edb0d17, now test.stock_elt_project.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6)
[0m12:12:32.169736 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6
[0m12:12:32.174677 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6"
[0m12:12:32.175590 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6
[0m12:12:32.177325 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6"
[0m12:12:32.178644 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6"
[0m12:12:32.178916 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__rolling_average_calc as (


SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
) select SYMBOL
from __dbt__cte__rolling_average_calc
where SYMBOL is null



      
    ) dbt_internal_test
[0m12:12:32.179169 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:12:32.903339 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.724 seconds
[0m12:12:32.908684 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6: Close
[0m12:12:33.078008 [info ] [Thread-1 (]: 2 of 3 PASS not_null_rolling_average_calc_SYMBOL ............................... [[32mPASS[0m in 0.91s]
[0m12:12:33.080320 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6
[0m12:12:33.081242 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_rolling_average_calc_row_num.05f5f58c28
[0m12:12:33.081999 [info ] [Thread-1 (]: 3 of 3 START test not_null_rolling_average_calc_row_num ........................ [RUN]
[0m12:12:33.083195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_rolling_average_calc_SYMBOL.3d93d2f9b6, now test.stock_elt_project.not_null_rolling_average_calc_row_num.05f5f58c28)
[0m12:12:33.083620 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_rolling_average_calc_row_num.05f5f58c28
[0m12:12:33.090352 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_rolling_average_calc_row_num.05f5f58c28"
[0m12:12:33.092024 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_rolling_average_calc_row_num.05f5f58c28
[0m12:12:33.095891 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_rolling_average_calc_row_num.05f5f58c28"
[0m12:12:33.097335 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_rolling_average_calc_row_num.05f5f58c28"
[0m12:12:33.097657 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_rolling_average_calc_row_num.05f5f58c28: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_rolling_average_calc_row_num.05f5f58c28"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__rolling_average_calc as (


SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
) select row_num
from __dbt__cte__rolling_average_calc
where row_num is null



      
    ) dbt_internal_test
[0m12:12:33.097967 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:12:33.557564 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.459 seconds
[0m12:12:33.559828 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_rolling_average_calc_row_num.05f5f58c28: Close
[0m12:12:33.707882 [info ] [Thread-1 (]: 3 of 3 PASS not_null_rolling_average_calc_row_num .............................. [[32mPASS[0m in 0.62s]
[0m12:12:33.710190 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_rolling_average_calc_row_num.05f5f58c28
[0m12:12:33.712931 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:12:33.713584 [debug] [MainThread]: Connection 'test.stock_elt_project.not_null_rolling_average_calc_row_num.05f5f58c28' was properly closed.
[0m12:12:33.714187 [info ] [MainThread]: 
[0m12:12:33.714800 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 3.14 seconds (3.14s).
[0m12:12:33.716354 [debug] [MainThread]: Command end result
[0m12:12:33.745278 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m12:12:33.746873 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m12:12:33.751469 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m12:12:33.751655 [info ] [MainThread]: 
[0m12:12:33.752205 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:12:33.752551 [info ] [MainThread]: 
[0m12:12:33.752916 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:12:33.753805 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.7411096, "process_user_time": 2.125205, "process_kernel_time": 0.140881, "process_mem_max_rss": "210272", "process_out_blocks": "1897", "process_in_blocks": "0"}
[0m12:12:33.754129 [debug] [MainThread]: Command `dbt test` succeeded at 12:12:33.754068 after 3.74 seconds
[0m12:12:33.754390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabe13560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa98be150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9ef16d0>]}
[0m12:12:33.754640 [debug] [MainThread]: Flushing usage events
[0m12:12:34.143389 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:12:35.558247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eb24f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eb25b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ebd7bf0>]}


============================== 12:12:35.562592 | 5f14cd4a-ae9a-4a79-af9a-3b8294c98fd8 ==============================
[0m12:12:35.562592 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m12:12:35.563010 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:12:35.918970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f14cd4a-ae9a-4a79-af9a-3b8294c98fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f0f8470>]}
[0m12:12:35.938766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f14cd4a-ae9a-4a79-af9a-3b8294c98fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fa28830>]}
[0m12:12:35.939173 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m12:12:35.975341 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m12:12:36.027179 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:12:36.027408 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:12:36.044395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f14cd4a-ae9a-4a79-af9a-3b8294c98fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e14c530>]}
[0m12:12:36.082861 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m12:12:36.084091 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m12:12:36.091372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f14cd4a-ae9a-4a79-af9a-3b8294c98fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7df087d0>]}
[0m12:12:36.091923 [info ] [MainThread]: Found 5 models, 3 data tests, 2 sources, 458 macros
[0m12:12:36.092383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f14cd4a-ae9a-4a79-af9a-3b8294c98fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f17a270>]}
[0m12:12:36.093267 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:12:36.094428 [debug] [MainThread]: Command end result
[0m12:12:36.107689 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m12:12:36.108825 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m12:12:36.110897 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m12:12:36.111429 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.5718033, "process_user_time": 1.79482, "process_kernel_time": 0.124443, "process_mem_max_rss": "201060", "process_out_blocks": "1848", "process_in_blocks": "0"}
[0m12:12:36.111685 [debug] [MainThread]: Command `dbt snapshot` succeeded at 12:12:36.111629 after 0.57 seconds
[0m12:12:36.111901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f231760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0bd6f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f0cc410>]}
[0m12:12:36.112115 [debug] [MainThread]: Flushing usage events
[0m12:12:36.503677 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:31:55.608909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff945b1850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff947a8ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff945b2e70>]}


============================== 17:31:55.612880 | 2272486e-4ca8-464f-a817-0574a28828c9 ==============================
[0m17:31:55.612880 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m17:31:55.613384 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:31:56.098865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2272486e-4ca8-464f-a817-0574a28828c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a51b590>]}
[0m17:31:56.122385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2272486e-4ca8-464f-a817-0574a28828c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a54f860>]}
[0m17:31:56.122887 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m17:31:56.167275 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m17:31:56.230081 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:31:56.230607 [debug] [MainThread]: Partial parsing: updated file: stock_elt_project://models/schema.yml
[0m17:31:56.403803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2272486e-4ca8-464f-a817-0574a28828c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7269c650>]}
[0m17:31:56.443155 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m17:31:56.444284 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m17:31:56.450977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2272486e-4ca8-464f-a817-0574a28828c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72771430>]}
[0m17:31:56.451180 [info ] [MainThread]: Found 5 models, 7 data tests, 2 sources, 458 macros
[0m17:31:56.451569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2272486e-4ca8-464f-a817-0574a28828c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff736ddd30>]}
[0m17:31:56.452342 [info ] [MainThread]: 
[0m17:31:56.452543 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:31:56.452703 [info ] [MainThread]: 
[0m17:31:56.452962 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:31:56.454751 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH'
[0m17:31:56.460247 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH"
[0m17:31:56.460419 [debug] [ThreadPool]: On list_USER_DB_CATFISH: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH"} */
show terse schemas in database USER_DB_CATFISH
    limit 10000
[0m17:31:56.460571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:58.381302 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.920 seconds
[0m17:31:58.384665 [debug] [ThreadPool]: On list_USER_DB_CATFISH: Close
[0m17:31:58.550838 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH, now list_USER_DB_CATFISH_analytics)
[0m17:31:58.563290 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_analytics"
[0m17:31:58.563931 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_analytics"} */
show terse objects in USER_DB_CATFISH.analytics limit 10000
[0m17:31:58.564357 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:31:59.045653 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.481 seconds
[0m17:31:59.049366 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: Close
[0m17:31:59.206756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2272486e-4ca8-464f-a817-0574a28828c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73b48c20>]}
[0m17:31:59.221333 [debug] [Thread-1 (]: Began running node model.stock_elt_project.lab1_stock_price_table
[0m17:31:59.222148 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.lab1_stock_price_table ................... [RUN]
[0m17:31:59.223238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_analytics, now model.stock_elt_project.lab1_stock_price_table)
[0m17:31:59.223620 [debug] [Thread-1 (]: Began compiling node model.stock_elt_project.lab1_stock_price_table
[0m17:31:59.230381 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt_project.lab1_stock_price_table"
[0m17:31:59.232491 [debug] [Thread-1 (]: Began executing node model.stock_elt_project.lab1_stock_price_table
[0m17:31:59.250047 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_elt_project.lab1_stock_price_table"
[0m17:31:59.251248 [debug] [Thread-1 (]: Using snowflake connection "model.stock_elt_project.lab1_stock_price_table"
[0m17:31:59.251522 [debug] [Thread-1 (]: On model.stock_elt_project.lab1_stock_price_table: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_elt_project.lab1_stock_price_table"} */
create or replace   view USER_DB_CATFISH.analytics.lab1_stock_price_table
  
   as (
    SELECT *
FROM USER_DB_CATFISH.raw.raw_stock_data
  );
[0m17:31:59.251750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:59.902169 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.650 seconds
[0m17:31:59.930958 [debug] [Thread-1 (]: On model.stock_elt_project.lab1_stock_price_table: Close
[0m17:32:00.076581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2272486e-4ca8-464f-a817-0574a28828c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94d2d2b0>]}
[0m17:32:00.077398 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.lab1_stock_price_table .............. [[32mSUCCESS 1[0m in 0.85s]
[0m17:32:00.078274 [debug] [Thread-1 (]: Finished running node model.stock_elt_project.lab1_stock_price_table
[0m17:32:00.078980 [debug] [Thread-1 (]: Began running node model.stock_elt_project.price_gap_calc
[0m17:32:00.079392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt_project.lab1_stock_price_table, now model.stock_elt_project.price_gap_calc)
[0m17:32:00.079591 [debug] [Thread-1 (]: Began compiling node model.stock_elt_project.price_gap_calc
[0m17:32:00.081665 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt_project.price_gap_calc"
[0m17:32:00.082635 [debug] [Thread-1 (]: Finished running node model.stock_elt_project.price_gap_calc
[0m17:32:00.082815 [debug] [Thread-1 (]: Began running node model.stock_elt_project.rolling_average_calc
[0m17:32:00.083044 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt_project.price_gap_calc, now model.stock_elt_project.rolling_average_calc)
[0m17:32:00.083289 [debug] [Thread-1 (]: Began compiling node model.stock_elt_project.rolling_average_calc
[0m17:32:00.084793 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt_project.rolling_average_calc"
[0m17:32:00.085523 [debug] [Thread-1 (]: Finished running node model.stock_elt_project.rolling_average_calc
[0m17:32:00.085682 [debug] [Thread-1 (]: Began running node model.stock_elt_project.price_gap_filtered
[0m17:32:00.085938 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.price_gap_filtered ...................... [RUN]
[0m17:32:00.086349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt_project.rolling_average_calc, now model.stock_elt_project.price_gap_filtered)
[0m17:32:00.086487 [debug] [Thread-1 (]: Began compiling node model.stock_elt_project.price_gap_filtered
[0m17:32:00.088051 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt_project.price_gap_filtered"
[0m17:32:00.088594 [debug] [Thread-1 (]: Began executing node model.stock_elt_project.price_gap_filtered
[0m17:32:00.098080 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_elt_project.price_gap_filtered"
[0m17:32:00.098909 [debug] [Thread-1 (]: Using snowflake connection "model.stock_elt_project.price_gap_filtered"
[0m17:32:00.099132 [debug] [Thread-1 (]: On model.stock_elt_project.price_gap_filtered: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_elt_project.price_gap_filtered"} */
create or replace transient table USER_DB_CATFISH.analytics.price_gap_filtered
         as
        (with __dbt__cte__price_gap_calc as (
SELECT SYMBOL,
        DT AS DATE,
        OPEN,
        LAG(CLOSE, 1) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DT) as LAST_CLOSING
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
ORDER BY SYMBOL, DATE
) SELECT *,
       (OPEN - LAST_CLOSING) AS PRICE_GAP
FROM __dbt__cte__price_gap_calc
WHERE LAST_CLOSING IS NOT NULL
        );
[0m17:32:00.099314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:01.557628 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.458 seconds
[0m17:32:01.562569 [debug] [Thread-1 (]: On model.stock_elt_project.price_gap_filtered: Close
[0m17:32:01.717839 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2272486e-4ca8-464f-a817-0574a28828c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95392db0>]}
[0m17:32:01.719214 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.price_gap_filtered ................. [[32mSUCCESS 1[0m in 1.63s]
[0m17:32:01.721083 [debug] [Thread-1 (]: Finished running node model.stock_elt_project.price_gap_filtered
[0m17:32:01.721563 [debug] [Thread-1 (]: Began running node model.stock_elt_project.rolling_avg_filtered
[0m17:32:01.722001 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.rolling_avg_filtered .................... [RUN]
[0m17:32:01.722572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt_project.price_gap_filtered, now model.stock_elt_project.rolling_avg_filtered)
[0m17:32:01.722949 [debug] [Thread-1 (]: Began compiling node model.stock_elt_project.rolling_avg_filtered
[0m17:32:01.726532 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt_project.rolling_avg_filtered"
[0m17:32:01.727560 [debug] [Thread-1 (]: Began executing node model.stock_elt_project.rolling_avg_filtered
[0m17:32:01.729307 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_elt_project.rolling_avg_filtered"
[0m17:32:01.730520 [debug] [Thread-1 (]: Using snowflake connection "model.stock_elt_project.rolling_avg_filtered"
[0m17:32:01.730769 [debug] [Thread-1 (]: On model.stock_elt_project.rolling_avg_filtered: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_elt_project.rolling_avg_filtered"} */
create or replace transient table USER_DB_CATFISH.analytics.rolling_avg_filtered
         as
        (with __dbt__cte__rolling_average_calc as (


SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
) SELECT SYMBOL,
       DATE,
       ROLLING_AVERAGE
FROM __dbt__cte__rolling_average_calc
WHERE row_num >= 7
ORDER BY SYMBOL, DATE, row_num
        );
[0m17:32:01.730984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:02.917669 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.186 seconds
[0m17:32:02.921746 [debug] [Thread-1 (]: On model.stock_elt_project.rolling_avg_filtered: Close
[0m17:32:03.072837 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2272486e-4ca8-464f-a817-0574a28828c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71aa8200>]}
[0m17:32:03.074854 [info ] [Thread-1 (]: 3 of 3 OK created sql table model analytics.rolling_avg_filtered ............... [[32mSUCCESS 1[0m in 1.35s]
[0m17:32:03.076784 [debug] [Thread-1 (]: Finished running node model.stock_elt_project.rolling_avg_filtered
[0m17:32:03.079631 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:32:03.080333 [debug] [MainThread]: Connection 'model.stock_elt_project.rolling_avg_filtered' was properly closed.
[0m17:32:03.081161 [info ] [MainThread]: 
[0m17:32:03.082385 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 6.63 seconds (6.63s).
[0m17:32:03.084186 [debug] [MainThread]: Command end result
[0m17:32:03.113857 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m17:32:03.115851 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m17:32:03.119922 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m17:32:03.120123 [info ] [MainThread]: 
[0m17:32:03.120712 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:32:03.120970 [info ] [MainThread]: 
[0m17:32:03.121189 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:32:03.121999 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.533217, "process_user_time": 2.493123, "process_kernel_time": 0.297761, "process_mem_max_rss": "214036", "process_out_blocks": "2872", "process_in_blocks": "0"}
[0m17:32:03.122324 [debug] [MainThread]: Command `dbt run` succeeded at 17:32:03.122259 after 7.53 seconds
[0m17:32:03.122718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94731370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a5aae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff947a8ec0>]}
[0m17:32:03.122999 [debug] [MainThread]: Flushing usage events
[0m17:32:03.567576 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:32:05.452285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99a732f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97b516a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97b50680>]}


============================== 17:32:05.455190 | c4d676f9-c49a-4cd3-9b51-ae9c475f9802 ==============================
[0m17:32:05.455190 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m17:32:05.455656 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:32:05.823680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4d676f9-c49a-4cd3-9b51-ae9c475f9802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff980d8320>]}
[0m17:32:05.843555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4d676f9-c49a-4cd3-9b51-ae9c475f9802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e5b7d70>]}
[0m17:32:05.843911 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m17:32:05.881649 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m17:32:05.936287 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:32:05.936515 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:32:05.953180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4d676f9-c49a-4cd3-9b51-ae9c475f9802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76fdc2f0>]}
[0m17:32:05.990073 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m17:32:05.990951 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m17:32:06.001960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4d676f9-c49a-4cd3-9b51-ae9c475f9802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76aca2a0>]}
[0m17:32:06.002204 [info ] [MainThread]: Found 5 models, 7 data tests, 2 sources, 458 macros
[0m17:32:06.002569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4d676f9-c49a-4cd3-9b51-ae9c475f9802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98245b20>]}
[0m17:32:06.003408 [info ] [MainThread]: 
[0m17:32:06.003675 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:32:06.003884 [info ] [MainThread]: 
[0m17:32:06.004237 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:32:06.006027 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH_analytics'
[0m17:32:06.012954 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_analytics"
[0m17:32:06.013131 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_analytics"} */
show terse objects in USER_DB_CATFISH.analytics limit 10000
[0m17:32:06.013351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:06.526075 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.512 seconds
[0m17:32:06.530655 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: Close
[0m17:32:06.673147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4d676f9-c49a-4cd3-9b51-ae9c475f9802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76d25e20>]}
[0m17:32:06.684173 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950
[0m17:32:06.684621 [info ] [Thread-1 (]: 1 of 7 START test not_null_lab1_stock_price_table_CLOSE ........................ [RUN]
[0m17:32:06.685723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_analytics, now test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950)
[0m17:32:06.686029 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950
[0m17:32:06.698561 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950"
[0m17:32:06.700193 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950
[0m17:32:06.710830 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950"
[0m17:32:06.712231 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950"
[0m17:32:06.712474 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select CLOSE
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where CLOSE is null



      
    ) dbt_internal_test
[0m17:32:06.712694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:07.343586 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.630 seconds
[0m17:32:07.359266 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950: Close
[0m17:32:07.493722 [info ] [Thread-1 (]: 1 of 7 PASS not_null_lab1_stock_price_table_CLOSE .............................. [[32mPASS[0m in 0.81s]
[0m17:32:07.494461 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950
[0m17:32:07.494879 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7
[0m17:32:07.495321 [info ] [Thread-1 (]: 2 of 7 START test not_null_lab1_stock_price_table_DT ........................... [RUN]
[0m17:32:07.495943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950, now test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7)
[0m17:32:07.496280 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7
[0m17:32:07.499821 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7"
[0m17:32:07.500895 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7
[0m17:32:07.502792 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7"
[0m17:32:07.504130 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7"
[0m17:32:07.504421 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DT
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where DT is null



      
    ) dbt_internal_test
[0m17:32:07.504643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:08.190773 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.686 seconds
[0m17:32:08.195466 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7: Close
[0m17:32:08.368319 [info ] [Thread-1 (]: 2 of 7 PASS not_null_lab1_stock_price_table_DT ................................. [[32mPASS[0m in 0.87s]
[0m17:32:08.369058 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7
[0m17:32:08.369342 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d
[0m17:32:08.369655 [info ] [Thread-1 (]: 3 of 7 START test not_null_lab1_stock_price_table_HIGH ......................... [RUN]
[0m17:32:08.370041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7, now test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d)
[0m17:32:08.370257 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d
[0m17:32:08.372855 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d"
[0m17:32:08.373917 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d
[0m17:32:08.375119 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d"
[0m17:32:08.375966 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d"
[0m17:32:08.376238 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select HIGH
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where HIGH is null



      
    ) dbt_internal_test
[0m17:32:08.376480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:09.235229 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.858 seconds
[0m17:32:09.238172 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d: Close
[0m17:32:09.383515 [info ] [Thread-1 (]: 3 of 7 PASS not_null_lab1_stock_price_table_HIGH ............................... [[32mPASS[0m in 1.01s]
[0m17:32:09.384655 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d
[0m17:32:09.385354 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8
[0m17:32:09.386176 [info ] [Thread-1 (]: 4 of 7 START test not_null_lab1_stock_price_table_LOW .......................... [RUN]
[0m17:32:09.386680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d, now test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8)
[0m17:32:09.387088 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8
[0m17:32:09.391993 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8"
[0m17:32:09.393344 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8
[0m17:32:09.395408 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8"
[0m17:32:09.397346 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8"
[0m17:32:09.397650 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select LOW
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where LOW is null



      
    ) dbt_internal_test
[0m17:32:09.397938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:09.836943 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.439 seconds
[0m17:32:09.841219 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8: Close
[0m17:32:09.988238 [info ] [Thread-1 (]: 4 of 7 PASS not_null_lab1_stock_price_table_LOW ................................ [[32mPASS[0m in 0.60s]
[0m17:32:09.989871 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8
[0m17:32:09.990528 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0
[0m17:32:09.991037 [info ] [Thread-1 (]: 5 of 7 START test not_null_lab1_stock_price_table_OPEN ......................... [RUN]
[0m17:32:09.991807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8, now test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0)
[0m17:32:09.992267 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0
[0m17:32:09.997174 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0"
[0m17:32:09.999627 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0
[0m17:32:10.001779 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0"
[0m17:32:10.003219 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0"
[0m17:32:10.003598 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select OPEN
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where OPEN is null



      
    ) dbt_internal_test
[0m17:32:10.003917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:10.771528 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.767 seconds
[0m17:32:10.775430 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0: Close
[0m17:32:10.940759 [info ] [Thread-1 (]: 5 of 7 PASS not_null_lab1_stock_price_table_OPEN ............................... [[32mPASS[0m in 0.95s]
[0m17:32:10.943434 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0
[0m17:32:10.944283 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c
[0m17:32:10.944759 [info ] [Thread-1 (]: 6 of 7 START test not_null_lab1_stock_price_table_SYMBOL ....................... [RUN]
[0m17:32:10.945591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0, now test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c)
[0m17:32:10.945994 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c
[0m17:32:10.950737 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c"
[0m17:32:10.952344 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c
[0m17:32:10.954282 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c"
[0m17:32:10.955471 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c"
[0m17:32:10.955779 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SYMBOL
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where SYMBOL is null



      
    ) dbt_internal_test
[0m17:32:10.956051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:11.409903 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.453 seconds
[0m17:32:11.413018 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c: Close
[0m17:32:11.570978 [info ] [Thread-1 (]: 6 of 7 PASS not_null_lab1_stock_price_table_SYMBOL ............................. [[32mPASS[0m in 0.62s]
[0m17:32:11.572905 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c
[0m17:32:11.573784 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8
[0m17:32:11.574491 [info ] [Thread-1 (]: 7 of 7 START test not_null_lab1_stock_price_table_VOLUME ....................... [RUN]
[0m17:32:11.575525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c, now test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8)
[0m17:32:11.576166 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8
[0m17:32:11.582522 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8"
[0m17:32:11.584708 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8
[0m17:32:11.587723 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8"
[0m17:32:11.589711 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8"
[0m17:32:11.590122 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VOLUME
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where VOLUME is null



      
    ) dbt_internal_test
[0m17:32:11.590566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:12.309574 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.719 seconds
[0m17:32:12.313042 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8: Close
[0m17:32:12.460004 [info ] [Thread-1 (]: 7 of 7 PASS not_null_lab1_stock_price_table_VOLUME ............................. [[32mPASS[0m in 0.88s]
[0m17:32:12.463200 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8
[0m17:32:12.474381 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:32:12.476070 [debug] [MainThread]: Connection 'test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8' was properly closed.
[0m17:32:12.478054 [info ] [MainThread]: 
[0m17:32:12.479540 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 6.47 seconds (6.47s).
[0m17:32:12.481840 [debug] [MainThread]: Command end result
[0m17:32:12.505708 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m17:32:12.508018 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m17:32:12.513965 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m17:32:12.514291 [info ] [MainThread]: 
[0m17:32:12.514811 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:32:12.515088 [info ] [MainThread]: 
[0m17:32:12.515420 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m17:32:12.516588 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 7.084182, "process_user_time": 2.336139, "process_kernel_time": 0.130174, "process_mem_max_rss": "210420", "process_out_blocks": "1959", "process_in_blocks": "0"}
[0m17:32:12.517125 [debug] [MainThread]: Command `dbt test` succeeded at 17:32:12.517043 after 7.08 seconds
[0m17:32:12.517590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9767f3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97af0dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76aaf890>]}
[0m17:32:12.517957 [debug] [MainThread]: Flushing usage events
[0m17:32:12.906325 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:32:14.597399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9757050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9757560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9756ea0>]}


============================== 17:32:14.600937 | d25ec39c-5249-4c26-83a9-be0b1518c772 ==============================
[0m17:32:14.600937 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m17:32:14.601444 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:32:15.001123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd25ec39c-5249-4c26-83a9-be0b1518c772', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dad35c0>]}
[0m17:32:15.021455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd25ec39c-5249-4c26-83a9-be0b1518c772', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d0fd460>]}
[0m17:32:15.021841 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m17:32:15.060980 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m17:32:15.118890 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:32:15.119142 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:32:15.136276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd25ec39c-5249-4c26-83a9-be0b1518c772', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d0b1730>]}
[0m17:32:15.174000 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m17:32:15.174899 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m17:32:15.183191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd25ec39c-5249-4c26-83a9-be0b1518c772', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cdf5b80>]}
[0m17:32:15.187336 [info ] [MainThread]: Found 5 models, 7 data tests, 2 sources, 458 macros
[0m17:32:15.187786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd25ec39c-5249-4c26-83a9-be0b1518c772', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cc3d8b0>]}
[0m17:32:15.188497 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m17:32:15.189356 [debug] [MainThread]: Command end result
[0m17:32:15.202415 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m17:32:15.203279 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m17:32:15.204772 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m17:32:15.205293 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.6270206, "process_user_time": 1.884251, "process_kernel_time": 0.162452, "process_mem_max_rss": "201052", "process_out_blocks": "1894", "process_in_blocks": "0"}
[0m17:32:15.205525 [debug] [MainThread]: Command `dbt snapshot` succeeded at 17:32:15.205480 after 0.63 seconds
[0m17:32:15.205700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba08e000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9757050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba25aed0>]}
[0m17:32:15.205855 [debug] [MainThread]: Flushing usage events
[0m17:32:15.591560 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:56:14.504375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9787da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff976629f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97608d70>]}


============================== 22:56:14.508827 | 0dd6980a-62f8-478b-ba03-96ccf440eb9d ==============================
[0m22:56:14.508827 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m22:56:14.509171 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:56:15.226291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0dd6980a-62f8-478b-ba03-96ccf440eb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff974f9520>]}
[0m22:56:15.248980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0dd6980a-62f8-478b-ba03-96ccf440eb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff774888c0>]}
[0m22:56:15.249472 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m22:56:15.295489 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m22:56:15.363953 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:56:15.364203 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:56:15.382366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0dd6980a-62f8-478b-ba03-96ccf440eb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7643b3e0>]}
[0m22:56:15.424249 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m22:56:15.425630 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m22:56:15.436450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0dd6980a-62f8-478b-ba03-96ccf440eb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7621fe00>]}
[0m22:56:15.436727 [info ] [MainThread]: Found 5 models, 7 data tests, 2 sources, 458 macros
[0m22:56:15.436886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0dd6980a-62f8-478b-ba03-96ccf440eb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cea2690>]}
[0m22:56:15.437778 [info ] [MainThread]: 
[0m22:56:15.437966 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:56:15.438166 [info ] [MainThread]: 
[0m22:56:15.438442 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:56:15.440426 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH'
[0m22:56:15.447382 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH"
[0m22:56:15.447575 [debug] [ThreadPool]: On list_USER_DB_CATFISH: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH"} */
show terse schemas in database USER_DB_CATFISH
    limit 10000
[0m22:56:15.447698 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:56:16.031913 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.584 seconds
[0m22:56:16.034202 [debug] [ThreadPool]: On list_USER_DB_CATFISH: Close
[0m22:56:16.185559 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH, now list_USER_DB_CATFISH_analytics)
[0m22:56:16.196535 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_analytics"
[0m22:56:16.196915 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_analytics"} */
show terse objects in USER_DB_CATFISH.analytics limit 10000
[0m22:56:16.197148 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:56:16.695117 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.498 seconds
[0m22:56:16.698168 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: Close
[0m22:56:16.858825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0dd6980a-62f8-478b-ba03-96ccf440eb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff764e5190>]}
[0m22:56:16.871758 [debug] [Thread-1 (]: Began running node model.stock_elt_project.lab1_stock_price_table
[0m22:56:16.872322 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.lab1_stock_price_table ................... [RUN]
[0m22:56:16.872722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_analytics, now model.stock_elt_project.lab1_stock_price_table)
[0m22:56:16.873035 [debug] [Thread-1 (]: Began compiling node model.stock_elt_project.lab1_stock_price_table
[0m22:56:16.878587 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt_project.lab1_stock_price_table"
[0m22:56:16.880299 [debug] [Thread-1 (]: Began executing node model.stock_elt_project.lab1_stock_price_table
[0m22:56:16.897567 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_elt_project.lab1_stock_price_table"
[0m22:56:16.898892 [debug] [Thread-1 (]: Using snowflake connection "model.stock_elt_project.lab1_stock_price_table"
[0m22:56:16.899124 [debug] [Thread-1 (]: On model.stock_elt_project.lab1_stock_price_table: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_elt_project.lab1_stock_price_table"} */
create or replace   view USER_DB_CATFISH.analytics.lab1_stock_price_table
  
   as (
    SELECT *
FROM USER_DB_CATFISH.raw.raw_stock_data
  );
[0m22:56:16.899355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:56:17.485944 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.586 seconds
[0m22:56:17.515197 [debug] [Thread-1 (]: On model.stock_elt_project.lab1_stock_price_table: Close
[0m22:56:17.662494 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dd6980a-62f8-478b-ba03-96ccf440eb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff764b4f50>]}
[0m22:56:17.664109 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.lab1_stock_price_table .............. [[32mSUCCESS 1[0m in 0.79s]
[0m22:56:17.665286 [debug] [Thread-1 (]: Finished running node model.stock_elt_project.lab1_stock_price_table
[0m22:56:17.666957 [debug] [Thread-1 (]: Began running node model.stock_elt_project.price_gap_calc
[0m22:56:17.667902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt_project.lab1_stock_price_table, now model.stock_elt_project.price_gap_calc)
[0m22:56:17.668432 [debug] [Thread-1 (]: Began compiling node model.stock_elt_project.price_gap_calc
[0m22:56:17.673149 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt_project.price_gap_calc"
[0m22:56:17.674640 [debug] [Thread-1 (]: Finished running node model.stock_elt_project.price_gap_calc
[0m22:56:17.674967 [debug] [Thread-1 (]: Began running node model.stock_elt_project.rolling_average_calc
[0m22:56:17.675368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt_project.price_gap_calc, now model.stock_elt_project.rolling_average_calc)
[0m22:56:17.675695 [debug] [Thread-1 (]: Began compiling node model.stock_elt_project.rolling_average_calc
[0m22:56:17.678208 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt_project.rolling_average_calc"
[0m22:56:17.679263 [debug] [Thread-1 (]: Finished running node model.stock_elt_project.rolling_average_calc
[0m22:56:17.679552 [debug] [Thread-1 (]: Began running node model.stock_elt_project.price_gap_filtered
[0m22:56:17.680067 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.price_gap_filtered ...................... [RUN]
[0m22:56:17.680461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt_project.rolling_average_calc, now model.stock_elt_project.price_gap_filtered)
[0m22:56:17.680710 [debug] [Thread-1 (]: Began compiling node model.stock_elt_project.price_gap_filtered
[0m22:56:17.683496 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt_project.price_gap_filtered"
[0m22:56:17.684348 [debug] [Thread-1 (]: Began executing node model.stock_elt_project.price_gap_filtered
[0m22:56:17.700472 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_elt_project.price_gap_filtered"
[0m22:56:17.701821 [debug] [Thread-1 (]: Using snowflake connection "model.stock_elt_project.price_gap_filtered"
[0m22:56:17.702154 [debug] [Thread-1 (]: On model.stock_elt_project.price_gap_filtered: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_elt_project.price_gap_filtered"} */
create or replace transient table USER_DB_CATFISH.analytics.price_gap_filtered
         as
        (with __dbt__cte__price_gap_calc as (
SELECT SYMBOL,
        DT AS DATE,
        OPEN,
        LAG(CLOSE, 1) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DT) as LAST_CLOSING
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
ORDER BY SYMBOL, DATE
) SELECT *,
       (OPEN - LAST_CLOSING) AS PRICE_GAP
FROM __dbt__cte__price_gap_calc
WHERE LAST_CLOSING IS NOT NULL
        );
[0m22:56:17.702392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:56:19.663333 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.961 seconds
[0m22:56:19.665399 [debug] [Thread-1 (]: On model.stock_elt_project.price_gap_filtered: Close
[0m22:56:19.800338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dd6980a-62f8-478b-ba03-96ccf440eb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97cfad80>]}
[0m22:56:19.802509 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.price_gap_filtered ................. [[32mSUCCESS 1[0m in 2.12s]
[0m22:56:19.803733 [debug] [Thread-1 (]: Finished running node model.stock_elt_project.price_gap_filtered
[0m22:56:19.804798 [debug] [Thread-1 (]: Began running node model.stock_elt_project.rolling_avg_filtered
[0m22:56:19.805838 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.rolling_avg_filtered .................... [RUN]
[0m22:56:19.806455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt_project.price_gap_filtered, now model.stock_elt_project.rolling_avg_filtered)
[0m22:56:19.807024 [debug] [Thread-1 (]: Began compiling node model.stock_elt_project.rolling_avg_filtered
[0m22:56:19.812248 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt_project.rolling_avg_filtered"
[0m22:56:19.814428 [debug] [Thread-1 (]: Began executing node model.stock_elt_project.rolling_avg_filtered
[0m22:56:19.816616 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_elt_project.rolling_avg_filtered"
[0m22:56:19.818065 [debug] [Thread-1 (]: Using snowflake connection "model.stock_elt_project.rolling_avg_filtered"
[0m22:56:19.818382 [debug] [Thread-1 (]: On model.stock_elt_project.rolling_avg_filtered: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_elt_project.rolling_avg_filtered"} */
create or replace transient table USER_DB_CATFISH.analytics.rolling_avg_filtered
         as
        (with __dbt__cte__rolling_average_calc as (


SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
) SELECT SYMBOL,
       DATE,
       ROLLING_AVERAGE
FROM __dbt__cte__rolling_average_calc
WHERE row_num >= 7
ORDER BY SYMBOL, DATE, row_num
        );
[0m22:56:19.818717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:56:20.957910 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.138 seconds
[0m22:56:20.963394 [debug] [Thread-1 (]: On model.stock_elt_project.rolling_avg_filtered: Close
[0m22:56:21.106019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dd6980a-62f8-478b-ba03-96ccf440eb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75566990>]}
[0m22:56:21.109286 [info ] [Thread-1 (]: 3 of 3 OK created sql table model analytics.rolling_avg_filtered ............... [[32mSUCCESS 1[0m in 1.30s]
[0m22:56:21.111168 [debug] [Thread-1 (]: Finished running node model.stock_elt_project.rolling_avg_filtered
[0m22:56:21.114429 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:56:21.114860 [debug] [MainThread]: Connection 'model.stock_elt_project.rolling_avg_filtered' was properly closed.
[0m22:56:21.115551 [info ] [MainThread]: 
[0m22:56:21.116013 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 5.68 seconds (5.68s).
[0m22:56:21.117370 [debug] [MainThread]: Command end result
[0m22:56:21.141384 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m22:56:21.143059 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m22:56:21.146987 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m22:56:21.147187 [info ] [MainThread]: 
[0m22:56:21.147400 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:56:21.147766 [info ] [MainThread]: 
[0m22:56:21.148117 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:56:21.149923 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.668696, "process_user_time": 2.459816, "process_kernel_time": 0.660413, "process_mem_max_rss": "208216", "process_out_blocks": "1940", "process_in_blocks": "0"}
[0m22:56:21.150276 [debug] [MainThread]: Command `dbt run` succeeded at 22:56:21.150220 after 6.67 seconds
[0m22:56:21.150536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98e93f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7621fda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96fb1e50>]}
[0m22:56:21.150724 [debug] [MainThread]: Flushing usage events
[0m22:56:21.602441 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:56:24.094444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9883d7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99b47b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff991eebd0>]}


============================== 22:56:24.097476 | 33996594-520f-472f-b428-cf07578717e4 ==============================
[0m22:56:24.097476 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m22:56:24.097801 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:56:24.524504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33996594-520f-472f-b428-cf07578717e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9910d430>]}
[0m22:56:24.545582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33996594-520f-472f-b428-cf07578717e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c098d10>]}
[0m22:56:24.546013 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m22:56:24.586099 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m22:56:24.640914 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:56:24.641146 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:56:24.658232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33996594-520f-472f-b428-cf07578717e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77f9ce90>]}
[0m22:56:24.695811 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m22:56:24.696674 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m22:56:24.715115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33996594-520f-472f-b428-cf07578717e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77a9f080>]}
[0m22:56:24.715375 [info ] [MainThread]: Found 5 models, 7 data tests, 2 sources, 458 macros
[0m22:56:24.715529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33996594-520f-472f-b428-cf07578717e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77fd0620>]}
[0m22:56:24.716401 [info ] [MainThread]: 
[0m22:56:24.716676 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:56:24.716901 [info ] [MainThread]: 
[0m22:56:24.717143 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:56:24.719054 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH_analytics'
[0m22:56:24.726835 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_analytics"
[0m22:56:24.727019 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_analytics"} */
show terse objects in USER_DB_CATFISH.analytics limit 10000
[0m22:56:24.727162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:56:25.163276 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.436 seconds
[0m22:56:25.165841 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: Close
[0m22:56:25.353787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33996594-520f-472f-b428-cf07578717e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff771ed850>]}
[0m22:56:25.365408 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950
[0m22:56:25.365826 [info ] [Thread-1 (]: 1 of 7 START test not_null_lab1_stock_price_table_CLOSE ........................ [RUN]
[0m22:56:25.366253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_analytics, now test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950)
[0m22:56:25.366567 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950
[0m22:56:25.378180 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950"
[0m22:56:25.380459 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950
[0m22:56:25.393788 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950"
[0m22:56:25.394980 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950"
[0m22:56:25.395249 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select CLOSE
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where CLOSE is null



      
    ) dbt_internal_test
[0m22:56:25.395456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:56:26.217273 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.821 seconds
[0m22:56:26.231031 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950: Close
[0m22:56:26.400028 [info ] [Thread-1 (]: 1 of 7 PASS not_null_lab1_stock_price_table_CLOSE .............................. [[32mPASS[0m in 1.03s]
[0m22:56:26.401766 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950
[0m22:56:26.402806 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7
[0m22:56:26.403798 [info ] [Thread-1 (]: 2 of 7 START test not_null_lab1_stock_price_table_DT ........................... [RUN]
[0m22:56:26.404984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950, now test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7)
[0m22:56:26.405868 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7
[0m22:56:26.412556 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7"
[0m22:56:26.413996 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7
[0m22:56:26.415629 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7"
[0m22:56:26.416667 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7"
[0m22:56:26.416826 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DT
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where DT is null



      
    ) dbt_internal_test
[0m22:56:26.417023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:56:27.097786 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.680 seconds
[0m22:56:27.108536 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7: Close
[0m22:56:27.257816 [info ] [Thread-1 (]: 2 of 7 PASS not_null_lab1_stock_price_table_DT ................................. [[32mPASS[0m in 0.85s]
[0m22:56:27.264283 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7
[0m22:56:27.265374 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d
[0m22:56:27.266927 [info ] [Thread-1 (]: 3 of 7 START test not_null_lab1_stock_price_table_HIGH ......................... [RUN]
[0m22:56:27.267727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7, now test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d)
[0m22:56:27.268330 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d
[0m22:56:27.280975 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d"
[0m22:56:27.282000 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d
[0m22:56:27.283789 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d"
[0m22:56:27.284838 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d"
[0m22:56:27.285107 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select HIGH
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where HIGH is null



      
    ) dbt_internal_test
[0m22:56:27.285329 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:56:28.051554 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.766 seconds
[0m22:56:28.053241 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d: Close
[0m22:56:28.204188 [info ] [Thread-1 (]: 3 of 7 PASS not_null_lab1_stock_price_table_HIGH ............................... [[32mPASS[0m in 0.94s]
[0m22:56:28.205163 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d
[0m22:56:28.205423 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8
[0m22:56:28.205699 [info ] [Thread-1 (]: 4 of 7 START test not_null_lab1_stock_price_table_LOW .......................... [RUN]
[0m22:56:28.206091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d, now test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8)
[0m22:56:28.206338 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8
[0m22:56:28.209050 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8"
[0m22:56:28.209779 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8
[0m22:56:28.210884 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8"
[0m22:56:28.211482 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8"
[0m22:56:28.211648 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select LOW
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where LOW is null



      
    ) dbt_internal_test
[0m22:56:28.211837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:56:28.693313 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.481 seconds
[0m22:56:28.697776 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8: Close
[0m22:56:28.844250 [info ] [Thread-1 (]: 4 of 7 PASS not_null_lab1_stock_price_table_LOW ................................ [[32mPASS[0m in 0.64s]
[0m22:56:28.847604 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8
[0m22:56:28.848308 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0
[0m22:56:28.848904 [info ] [Thread-1 (]: 5 of 7 START test not_null_lab1_stock_price_table_OPEN ......................... [RUN]
[0m22:56:28.850068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8, now test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0)
[0m22:56:28.850564 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0
[0m22:56:28.856391 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0"
[0m22:56:28.857829 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0
[0m22:56:28.859958 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0"
[0m22:56:28.861108 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0"
[0m22:56:28.861438 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select OPEN
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where OPEN is null



      
    ) dbt_internal_test
[0m22:56:28.861729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:56:29.333513 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.472 seconds
[0m22:56:29.336420 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0: Close
[0m22:56:29.479663 [info ] [Thread-1 (]: 5 of 7 PASS not_null_lab1_stock_price_table_OPEN ............................... [[32mPASS[0m in 0.63s]
[0m22:56:29.482444 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0
[0m22:56:29.483309 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c
[0m22:56:29.483921 [info ] [Thread-1 (]: 6 of 7 START test not_null_lab1_stock_price_table_SYMBOL ....................... [RUN]
[0m22:56:29.485522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0, now test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c)
[0m22:56:29.486122 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c
[0m22:56:29.492777 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c"
[0m22:56:29.495151 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c
[0m22:56:29.497657 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c"
[0m22:56:29.499353 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c"
[0m22:56:29.499683 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SYMBOL
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where SYMBOL is null



      
    ) dbt_internal_test
[0m22:56:29.500075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:56:29.870197 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.370 seconds
[0m22:56:29.874183 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c: Close
[0m22:56:30.013597 [info ] [Thread-1 (]: 6 of 7 PASS not_null_lab1_stock_price_table_SYMBOL ............................. [[32mPASS[0m in 0.53s]
[0m22:56:30.016420 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c
[0m22:56:30.016980 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8
[0m22:56:30.017480 [info ] [Thread-1 (]: 7 of 7 START test not_null_lab1_stock_price_table_VOLUME ....................... [RUN]
[0m22:56:30.018417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c, now test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8)
[0m22:56:30.019088 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8
[0m22:56:30.023932 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8"
[0m22:56:30.025367 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8
[0m22:56:30.027617 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8"
[0m22:56:30.028822 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8"
[0m22:56:30.029098 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VOLUME
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where VOLUME is null



      
    ) dbt_internal_test
[0m22:56:30.029390 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:56:30.482710 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.453 seconds
[0m22:56:30.489447 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8: Close
[0m22:56:30.630598 [info ] [Thread-1 (]: 7 of 7 PASS not_null_lab1_stock_price_table_VOLUME ............................. [[32mPASS[0m in 0.61s]
[0m22:56:30.631896 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8
[0m22:56:30.633993 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:56:30.634355 [debug] [MainThread]: Connection 'test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8' was properly closed.
[0m22:56:30.634718 [info ] [MainThread]: 
[0m22:56:30.635035 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 5.92 seconds (5.92s).
[0m22:56:30.636618 [debug] [MainThread]: Command end result
[0m22:56:30.670023 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m22:56:30.673904 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m22:56:30.686227 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m22:56:30.687308 [info ] [MainThread]: 
[0m22:56:30.688349 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:56:30.688726 [info ] [MainThread]: 
[0m22:56:30.689090 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m22:56:30.696168 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.6217346, "process_user_time": 2.521916, "process_kernel_time": 0.2289, "process_mem_max_rss": "210728", "process_out_blocks": "1959", "process_in_blocks": "0"}
[0m22:56:30.700291 [debug] [MainThread]: Command `dbt test` succeeded at 22:56:30.699971 after 6.63 seconds
[0m22:56:30.703481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99b47b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c14b3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff999844a0>]}
[0m22:56:30.704502 [debug] [MainThread]: Flushing usage events
[0m22:56:31.114621 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:56:33.301656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9bbd9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab2a3800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9a12240>]}


============================== 22:56:33.307119 | 3198e342-9465-4d99-b88c-b67ad23649d8 ==============================
[0m22:56:33.307119 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m22:56:33.307846 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:56:33.873345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3198e342-9465-4d99-b88c-b67ad23649d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d88a750>]}
[0m22:56:33.898276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3198e342-9465-4d99-b88c-b67ad23649d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d23e240>]}
[0m22:56:33.898798 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m22:56:33.944387 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m22:56:34.004236 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:56:34.004490 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:56:34.021788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3198e342-9465-4d99-b88c-b67ad23649d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93ff02f0>]}
[0m22:56:34.064608 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m22:56:34.066082 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m22:56:34.077998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3198e342-9465-4d99-b88c-b67ad23649d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa0ee330>]}
[0m22:56:34.078561 [info ] [MainThread]: Found 5 models, 7 data tests, 2 sources, 458 macros
[0m22:56:34.079380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3198e342-9465-4d99-b88c-b67ad23649d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c85c440>]}
[0m22:56:34.080510 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:56:34.081882 [debug] [MainThread]: Command end result
[0m22:56:34.099402 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m22:56:34.100634 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m22:56:34.102487 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m22:56:34.103325 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.82587695, "process_user_time": 2.123119, "process_kernel_time": 0.263595, "process_mem_max_rss": "200980", "process_out_blocks": "1894", "process_in_blocks": "0"}
[0m22:56:34.103633 [debug] [MainThread]: Command `dbt snapshot` succeeded at 22:56:34.103581 after 0.83 seconds
[0m22:56:34.103898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa93ee960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d7a3a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c51a1b0>]}
[0m22:56:34.104154 [debug] [MainThread]: Flushing usage events
[0m22:56:34.496101 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:35:56.930174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065e17f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10732fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10732fed0>]}


============================== 00:35:56.932797 | 8d6c29a3-7254-4fec-aba6-9f7402d75827 ==============================
[0m00:35:56.932797 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:35:56.933050 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:35:56.935106 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_ACCOUNT'
[0m00:35:56.936263 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.03304275, "process_in_blocks": "0", "process_kernel_time": 0.087029, "process_mem_max_rss": "99123200", "process_out_blocks": "0", "process_user_time": 0.474997}
[0m00:35:56.936456 [debug] [MainThread]: Command `dbt snapshot` failed at 00:35:56.936415 after 0.03 seconds
[0m00:35:56.936581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073d4770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c8b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072169c0>]}
[0m00:35:56.936705 [debug] [MainThread]: Flushing usage events
[0m00:35:57.337160 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:38:19.513403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037a97f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044f3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044f3ed0>]}


============================== 00:38:19.516012 | e40350e8-6535-4591-9737-ad967b6b8ab4 ==============================
[0m00:38:19.516012 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:38:19.516279 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m00:38:19.518316 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_ACCOUNT'
[0m00:38:19.519429 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.03461221, "process_in_blocks": "0", "process_kernel_time": 0.087101, "process_mem_max_rss": "100794368", "process_out_blocks": "0", "process_user_time": 0.477813}
[0m00:38:19.519595 [debug] [MainThread]: Command `dbt snapshot` failed at 00:38:19.519555 after 0.03 seconds
[0m00:38:19.519714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104598770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10458cb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043da9c0>]}
[0m00:38:19.519837 [debug] [MainThread]: Flushing usage events
[0m00:38:20.006240 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:42:22.997429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11827d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1194c7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1194c7ed0>]}


============================== 00:42:23.000075 | fe2a1ece-caea-4a93-b7bf-304d02435bbf ==============================
[0m00:42:23.000075 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:42:23.000330 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:42:23.002871 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_ROLE'
[0m00:42:23.004006 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.0331255, "process_in_blocks": "0", "process_kernel_time": 0.078275, "process_mem_max_rss": "100679680", "process_out_blocks": "0", "process_user_time": 0.464675}
[0m00:42:23.004199 [debug] [MainThread]: Command `dbt snapshot` failed at 00:42:23.004159 after 0.03 seconds
[0m00:42:23.004330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11956cd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119561370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1192af350>]}
[0m00:42:23.004464 [debug] [MainThread]: Flushing usage events
[0m00:42:23.437113 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:46:58.122012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041f57f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f3fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f3fed0>]}


============================== 00:46:58.125088 | 6ce72e64-0bab-49b7-be9e-b604cfda760d ==============================
[0m00:46:58.125088 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:46:58.125379 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt', 'log_path': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:46:58.128172 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_ROLE'
[0m00:46:58.129383 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.040079292, "process_in_blocks": "0", "process_kernel_time": 0.096576, "process_mem_max_rss": "101941248", "process_out_blocks": "0", "process_user_time": 0.512068}
[0m00:46:58.129563 [debug] [MainThread]: Command `dbt snapshot` failed at 00:46:58.129522 after 0.04 seconds
[0m00:46:58.129705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe4d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fd9370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e27350>]}
[0m00:46:58.129848 [debug] [MainThread]: Flushing usage events
[0m00:46:58.907136 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:48:46.421819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bad7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088f3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088f3ed0>]}


============================== 00:48:46.424561 | 5dce1856-2915-4fb6-9a82-000b098ad64a ==============================
[0m00:48:46.424561 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:48:46.424825 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/logs', 'profiles_dir': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:48:46.819813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5dce1856-2915-4fb6-9a82-000b098ad64a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095c4b00>]}
[0m00:48:46.839265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5dce1856-2915-4fb6-9a82-000b098ad64a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109356cf0>]}
[0m00:48:46.839841 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m00:48:46.894196 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:48:46.931214 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m00:48:46.931442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5dce1856-2915-4fb6-9a82-000b098ad64a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109345e50>]}
[0m00:48:47.466540 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.stock_elt_project.snapshot_raw_stock_price' (snapshots/snapshot_session_summary.sql) depends on a node named 'RAW_STOCK_DATA' which was not found
[0m00:48:47.468347 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 1.0755403, "process_in_blocks": "0", "process_kernel_time": 0.152269, "process_mem_max_rss": "136265728", "process_out_blocks": "0", "process_user_time": 1.168213}
[0m00:48:47.468547 [debug] [MainThread]: Command `dbt snapshot` failed at 00:48:47.468506 after 1.08 seconds
[0m00:48:47.468712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ae3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ae0f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108817e70>]}
[0m00:48:47.468860 [debug] [MainThread]: Flushing usage events
[0m00:48:47.926453 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:50:08.113823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a917f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047d7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047d7ed0>]}


============================== 00:50:08.116416 | 670bc2ab-8f48-4e8a-b6d1-a6d9d3b2d8ae ==============================
[0m00:50:08.116416 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:50:08.116669 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:50:08.316213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '670bc2ab-8f48-4e8a-b6d1-a6d9d3b2d8ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054a8b00>]}
[0m00:50:08.335721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '670bc2ab-8f48-4e8a-b6d1-a6d9d3b2d8ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10523acf0>]}
[0m00:50:08.336298 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m00:50:08.387242 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:50:08.423808 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m00:50:08.424032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '670bc2ab-8f48-4e8a-b6d1-a6d9d3b2d8ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105229e50>]}
[0m00:50:08.927977 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.stock_elt_project.snapshot_raw_stock_price' (snapshots/snapshot_session_summary.sql) depends on a source named 'RAW.RAW_STOCK_DATA' which was not found
[0m00:50:08.929719 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.8448282, "process_in_blocks": "0", "process_kernel_time": 0.153578, "process_mem_max_rss": "137805824", "process_out_blocks": "0", "process_user_time": 1.140259}
[0m00:50:08.929892 [debug] [MainThread]: Command `dbt snapshot` failed at 00:50:08.929856 after 0.85 seconds
[0m00:50:08.930036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059c4f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059c7a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104703e70>]}
[0m00:50:08.930170 [debug] [MainThread]: Flushing usage events
[0m00:50:10.388327 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:51:51.279245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058c17f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10660fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10660fed0>]}


============================== 00:51:51.281826 | 75b2de3e-b303-4075-86b4-b822f997c7fa ==============================
[0m00:51:51.281826 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:51:51.282073 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:51:51.472925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75b2de3e-b303-4075-86b4-b822f997c7fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072d0b00>]}
[0m00:51:51.492250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75b2de3e-b303-4075-86b4-b822f997c7fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107072cf0>]}
[0m00:51:51.492797 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m00:51:51.544086 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:51:51.580157 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m00:51:51.580382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '75b2de3e-b303-4075-86b4-b822f997c7fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107065e50>]}
[0m00:51:52.123531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75b2de3e-b303-4075-86b4-b822f997c7fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075dfe30>]}
[0m00:51:52.158925 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/manifest.json
[0m00:51:52.160331 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/semantic_manifest.json
[0m00:51:52.171749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75b2de3e-b303-4075-86b4-b822f997c7fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10752e5f0>]}
[0m00:51:52.171931 [info ] [MainThread]: Found 5 models, 1 snapshot, 7 data tests, 2 sources, 462 macros
[0m00:51:52.172064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75b2de3e-b303-4075-86b4-b822f997c7fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079a8390>]}
[0m00:51:52.172736 [info ] [MainThread]: 
[0m00:51:52.172871 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:51:52.172976 [info ] [MainThread]: 
[0m00:51:52.173153 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:51:52.173479 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_your_database'
[0m00:51:52.177936 [debug] [ThreadPool]: Using snowflake connection "list_your_database"
[0m00:51:52.178086 [debug] [ThreadPool]: On list_your_database: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_your_database"} */
show terse schemas in database your_database
    limit 10000
[0m00:51:52.178209 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:51:53.144514 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_your_database"} */
show terse schemas in database your_database
    limit 10000
[0m00:51:53.144816 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:51:53.145042 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m00:51:53.145205 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:51:53.145422 [debug] [ThreadPool]: On list_your_database: No close available on handle
[0m00:51:53.145875 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:51:53.146090 [debug] [MainThread]: Connection 'list_your_database' was properly closed.
[0m00:51:53.146274 [info ] [MainThread]: 
[0m00:51:53.146468 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.97 seconds (0.97s).
[0m00:51:53.146758 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "your_database"
  Database Error
    250003 (08001): 404 Not Found: post https://my_snowflake_account.snowflakecomputing.com:443/session/v1/login-request?request_id=51b5d0aa-1d77-4f94-b2ed-76d2398335f5&databaseName=your_database&schemaName=analytics&warehouse=your_warehouse&roleName=TRAINING_ROLE&request_guid=8950bb24-d05a-45c7-967b-ea69008db0b6
[0m00:51:53.148053 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 1.8970004, "process_in_blocks": "0", "process_kernel_time": 0.236882, "process_mem_max_rss": "151519232", "process_out_blocks": "0", "process_user_time": 1.410568}
[0m00:51:53.148298 [debug] [MainThread]: Command `dbt snapshot` failed at 00:51:53.148243 after 1.90 seconds
[0m00:51:53.148518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106417890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a59020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a594f0>]}
[0m00:51:53.148733 [debug] [MainThread]: Flushing usage events
[0m00:51:53.583358 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:53:44.667164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f497f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c93c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c93ed0>]}


============================== 00:53:44.669818 | 6b810583-cea0-40b8-97d1-f8994a049cb4 ==============================
[0m00:53:44.669818 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:53:44.670064 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:53:44.880288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b810583-cea0-40b8-97d1-f8994a049cb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107960b00>]}
[0m00:53:44.900669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b810583-cea0-40b8-97d1-f8994a049cb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076f6cf0>]}
[0m00:53:44.901393 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m00:53:44.952527 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:53:44.995803 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:53:44.996065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6b810583-cea0-40b8-97d1-f8994a049cb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c5d250>]}
[0m00:53:45.524016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b810583-cea0-40b8-97d1-f8994a049cb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c699a0>]}
[0m00:53:45.558629 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/manifest.json
[0m00:53:45.560481 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/semantic_manifest.json
[0m00:53:45.570861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b810583-cea0-40b8-97d1-f8994a049cb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b0b850>]}
[0m00:53:45.571042 [info ] [MainThread]: Found 5 models, 1 snapshot, 7 data tests, 2 sources, 462 macros
[0m00:53:45.571175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b810583-cea0-40b8-97d1-f8994a049cb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108020390>]}
[0m00:53:45.571851 [info ] [MainThread]: 
[0m00:53:45.571991 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:53:45.572099 [info ] [MainThread]: 
[0m00:53:45.572276 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:53:45.572596 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH'
[0m00:53:45.577179 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH"
[0m00:53:45.577345 [debug] [ThreadPool]: On list_USER_DB_CATFISH: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH"} */
show terse schemas in database USER_DB_CATFISH
    limit 10000
[0m00:53:45.577508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:53:45.959363 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH"} */
show terse schemas in database USER_DB_CATFISH
    limit 10000
[0m00:53:45.959666 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:53:45.959907 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m00:53:45.960073 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:53:45.960285 [debug] [ThreadPool]: On list_USER_DB_CATFISH: No close available on handle
[0m00:53:45.960712 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:53:45.960920 [debug] [MainThread]: Connection 'list_USER_DB_CATFISH' was properly closed.
[0m00:53:45.961093 [info ] [MainThread]: 
[0m00:53:45.961281 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m00:53:45.961559 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "USER_DB_CATFISH"
  Database Error
    250003 (08001): 404 Not Found: post https://my_snowflake_account.snowflakecomputing.com:443/session/v1/login-request?request_id=ae1b5468-7099-4b1e-97c9-ef28802673ce&databaseName=USER_DB_CATFISH&schemaName=analytics&warehouse=CATFISH_QUERY_WH&roleName=TRAINING_ROLE&request_guid=b15db5b6-009d-480d-b5b3-4ed84919696d
[0m00:53:45.962835 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 1.3234347, "process_in_blocks": "0", "process_kernel_time": 0.171648, "process_mem_max_rss": "145768448", "process_out_blocks": "0", "process_user_time": 1.280436}
[0m00:53:45.963072 [debug] [MainThread]: Command `dbt snapshot` failed at 00:53:45.963020 after 1.32 seconds
[0m00:53:45.963277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a9b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080d01b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080d0aa0>]}
[0m00:53:45.963484 [debug] [MainThread]: Flushing usage events
[0m00:53:46.397909 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:55:28.330973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038397f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104583c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104583ed0>]}


============================== 00:55:28.333578 | 78e910dd-68a7-42fc-b94d-be530f609ffd ==============================
[0m00:55:28.333578 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:55:28.333866 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:55:28.517670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78e910dd-68a7-42fc-b94d-be530f609ffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105250b00>]}
[0m00:55:28.536852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78e910dd-68a7-42fc-b94d-be530f609ffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe2cf0>]}
[0m00:55:28.537373 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m00:55:28.587083 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:55:28.630222 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:55:28.630464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '78e910dd-68a7-42fc-b94d-be530f609ffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10554d250>]}
[0m00:55:29.164240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78e910dd-68a7-42fc-b94d-be530f609ffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054d59a0>]}
[0m00:55:29.198349 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/manifest.json
[0m00:55:29.199604 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/semantic_manifest.json
[0m00:55:29.209706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78e910dd-68a7-42fc-b94d-be530f609ffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053fb850>]}
[0m00:55:29.209890 [info ] [MainThread]: Found 5 models, 1 snapshot, 7 data tests, 2 sources, 462 macros
[0m00:55:29.210027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78e910dd-68a7-42fc-b94d-be530f609ffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105908390>]}
[0m00:55:29.210725 [info ] [MainThread]: 
[0m00:55:29.210860 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:55:29.210966 [info ] [MainThread]: 
[0m00:55:29.211148 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:55:29.211468 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH'
[0m00:55:29.216271 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH"
[0m00:55:29.216435 [debug] [ThreadPool]: On list_USER_DB_CATFISH: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH"} */
show terse schemas in database USER_DB_CATFISH
    limit 10000
[0m00:55:29.216550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:29.588369 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH"} */
show terse schemas in database USER_DB_CATFISH
    limit 10000
[0m00:55:29.588622 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:55:29.588785 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m00:55:29.588893 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:55:29.589044 [debug] [ThreadPool]: On list_USER_DB_CATFISH: No close available on handle
[0m00:55:29.589395 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:55:29.589541 [debug] [MainThread]: Connection 'list_USER_DB_CATFISH' was properly closed.
[0m00:55:29.589669 [info ] [MainThread]: 
[0m00:55:29.589805 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m00:55:29.590012 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "USER_DB_CATFISH"
  Database Error
    250003 (08001): 404 Not Found: post https://my_snowflake_account.snowflakecomputing.com:443/session/v1/login-request?request_id=64aeacb9-3e4c-46f4-91c4-4eb67570200a&databaseName=USER_DB_CATFISH&schemaName=RAW&warehouse=CATFISH_QUERY_WH&roleName=TRAINING_ROLE&request_guid=c8e23f06-c753-4d19-91bb-636118f91bbe
[0m00:55:29.590871 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 1.2869576, "process_in_blocks": "0", "process_kernel_time": 0.168858, "process_mem_max_rss": "148717568", "process_out_blocks": "0", "process_user_time": 1.272194}
[0m00:55:29.591044 [debug] [MainThread]: Command `dbt snapshot` failed at 00:55:29.591008 after 1.29 seconds
[0m00:55:29.591202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10438b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059b81b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059b8aa0>]}
[0m00:55:29.591357 [debug] [MainThread]: Flushing usage events
[0m00:55:30.020095 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:55:42.224497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109757f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bc7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bc7ed0>]}


============================== 00:55:42.227058 | 74571841-e75a-4886-87d6-a213f82bfc62 ==============================
[0m00:55:42.227058 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:55:42.227307 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:55:42.401814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74571841-e75a-4886-87d6-a213f82bfc62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a5cb00>]}
[0m00:55:42.421222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74571841-e75a-4886-87d6-a213f82bfc62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127f2cf0>]}
[0m00:55:42.421738 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m00:55:42.470770 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:55:42.530474 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:55:42.530649 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:55:42.551850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74571841-e75a-4886-87d6-a213f82bfc62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127e2250>]}
[0m00:55:42.614278 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/manifest.json
[0m00:55:42.615884 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/semantic_manifest.json
[0m00:55:42.625406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74571841-e75a-4886-87d6-a213f82bfc62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a576b0>]}
[0m00:55:42.625601 [info ] [MainThread]: Found 5 models, 1 snapshot, 7 data tests, 2 sources, 462 macros
[0m00:55:42.625739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74571841-e75a-4886-87d6-a213f82bfc62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129e9550>]}
[0m00:55:42.626422 [info ] [MainThread]: 
[0m00:55:42.626552 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:55:42.626668 [info ] [MainThread]: 
[0m00:55:42.626855 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:55:42.627185 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH'
[0m00:55:42.632719 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH"
[0m00:55:42.632902 [debug] [ThreadPool]: On list_USER_DB_CATFISH: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH"} */
show terse schemas in database USER_DB_CATFISH
    limit 10000
[0m00:55:42.633030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:42.954175 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH"} */
show terse schemas in database USER_DB_CATFISH
    limit 10000
[0m00:55:42.954467 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:55:42.954694 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m00:55:42.954857 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:55:42.955069 [debug] [ThreadPool]: On list_USER_DB_CATFISH: No close available on handle
[0m00:55:42.955499 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:55:42.955715 [debug] [MainThread]: Connection 'list_USER_DB_CATFISH' was properly closed.
[0m00:55:42.955895 [info ] [MainThread]: 
[0m00:55:42.956081 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m00:55:42.956379 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "USER_DB_CATFISH"
  Database Error
    250003 (08001): 404 Not Found: post https://my_snowflake_account.snowflakecomputing.com:443/session/v1/login-request?request_id=1b32ad23-78cc-419f-9b92-5968e53ae486&databaseName=USER_DB_CATFISH&schemaName=RAW&warehouse=CATFISH_QUERY_WH&roleName=TRAINING_ROLE&request_guid=9f34359e-c469-4cc5-b301-633c14c2e0ce
[0m00:55:42.957609 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.757948, "process_in_blocks": "0", "process_kernel_time": 0.160809, "process_mem_max_rss": "138412032", "process_out_blocks": "0", "process_user_time": 0.80387}
[0m00:55:42.957854 [debug] [MainThread]: Command `dbt snapshot` failed at 00:55:42.957802 after 0.76 seconds
[0m00:55:42.958062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e458b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118cf890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e0d490>]}
[0m00:55:42.958275 [debug] [MainThread]: Flushing usage events
[0m00:55:43.340951 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:58:00.139714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051817f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c7ed0>]}


============================== 00:58:00.142352 | cdacf4c8-79fb-48cd-ac99-15501b0172c7 ==============================
[0m00:58:00.142352 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:58:00.142597 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:58:00.326174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cdacf4c8-79fb-48cd-ac99-15501b0172c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10737cb00>]}
[0m00:58:00.345205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cdacf4c8-79fb-48cd-ac99-15501b0172c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070f2cf0>]}
[0m00:58:00.345718 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m00:58:00.394298 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:58:00.436744 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:58:00.436967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cdacf4c8-79fb-48cd-ac99-15501b0172c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107779250>]}
[0m00:58:00.963824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdacf4c8-79fb-48cd-ac99-15501b0172c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077919a0>]}
[0m00:58:00.998616 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/manifest.json
[0m00:58:00.999884 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/semantic_manifest.json
[0m00:58:01.010270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdacf4c8-79fb-48cd-ac99-15501b0172c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10766b850>]}
[0m00:58:01.010453 [info ] [MainThread]: Found 5 models, 1 snapshot, 7 data tests, 2 sources, 462 macros
[0m00:58:01.010584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdacf4c8-79fb-48cd-ac99-15501b0172c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e3c390>]}
[0m00:58:01.011271 [info ] [MainThread]: 
[0m00:58:01.011403 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:58:01.011506 [info ] [MainThread]: 
[0m00:58:01.011687 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:58:01.012010 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH'
[0m00:58:01.016587 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH"
[0m00:58:01.016754 [debug] [ThreadPool]: On list_USER_DB_CATFISH: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH"} */
show terse schemas in database USER_DB_CATFISH
    limit 10000
[0m00:58:01.016916 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:58:01.435942 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH"} */
show terse schemas in database USER_DB_CATFISH
    limit 10000
[0m00:58:01.436317 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:58:01.436578 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m00:58:01.436762 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:58:01.437000 [debug] [ThreadPool]: On list_USER_DB_CATFISH: No close available on handle
[0m00:58:01.437504 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:58:01.437747 [debug] [MainThread]: Connection 'list_USER_DB_CATFISH' was properly closed.
[0m00:58:01.437952 [info ] [MainThread]: 
[0m00:58:01.438164 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m00:58:01.438488 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "USER_DB_CATFISH"
  Database Error
    250001 (08001): Failed to connect to DB: sfedu02-ksb65579.snowflakecomputing.com:443. Incorrect username or password was specified.
[0m00:58:01.439918 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 1.3269159, "process_in_blocks": "0", "process_kernel_time": 0.17888, "process_mem_max_rss": "147668992", "process_out_blocks": "0", "process_user_time": 1.265803}
[0m00:58:01.440191 [debug] [MainThread]: Command `dbt snapshot` failed at 00:58:01.440132 after 1.33 seconds
[0m00:58:01.440433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062cf890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110eec050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110eed4f0>]}
[0m00:58:01.440676 [debug] [MainThread]: Flushing usage events
[0m00:58:01.867592 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:00:00.599137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11127d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123c7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123c7ed0>]}


============================== 01:00:00.601849 | 43580ebe-b33c-4096-a52d-3391e026ac33 ==============================
[0m01:00:00.601849 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:00:00.602128 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/logs', 'profiles_dir': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:00:00.796619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43580ebe-b33c-4096-a52d-3391e026ac33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114360b00>]}
[0m01:00:00.817261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43580ebe-b33c-4096-a52d-3391e026ac33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140f2cf0>]}
[0m01:00:00.817919 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m01:00:00.867074 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:00:00.911469 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m01:00:00.911745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '43580ebe-b33c-4096-a52d-3391e026ac33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114679250>]}
[0m01:00:01.445958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43580ebe-b33c-4096-a52d-3391e026ac33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146a19a0>]}
[0m01:00:01.481217 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/manifest.json
[0m01:00:01.483084 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/semantic_manifest.json
[0m01:00:01.493790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43580ebe-b33c-4096-a52d-3391e026ac33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114507850>]}
[0m01:00:01.493976 [info ] [MainThread]: Found 5 models, 1 snapshot, 7 data tests, 2 sources, 462 macros
[0m01:00:01.494112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43580ebe-b33c-4096-a52d-3391e026ac33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115570390>]}
[0m01:00:01.494810 [info ] [MainThread]: 
[0m01:00:01.494950 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:00:01.495055 [info ] [MainThread]: 
[0m01:00:01.495234 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:00:01.495555 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH'
[0m01:00:01.500111 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH"
[0m01:00:01.500250 [debug] [ThreadPool]: On list_USER_DB_CATFISH: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH"} */
show terse schemas in database USER_DB_CATFISH
    limit 10000
[0m01:00:01.500399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:02.061421 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.562 seconds
[0m01:00:02.064080 [debug] [ThreadPool]: On list_USER_DB_CATFISH: Close
[0m01:00:02.230899 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH, now list_USER_DB_CATFISH_snapshot)
[0m01:00:02.237848 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_snapshot"
[0m01:00:02.238172 [debug] [ThreadPool]: On list_USER_DB_CATFISH_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_snapshot"} */
show terse objects in USER_DB_CATFISH.snapshot limit 10000
[0m01:00:02.238371 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:02.710443 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.473 seconds
[0m01:00:02.711299 [debug] [ThreadPool]: On list_USER_DB_CATFISH_snapshot: Close
[0m01:00:02.857461 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_snapshot, now list_USER_DB_CATFISH_analytics)
[0m01:00:02.858700 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_analytics"
[0m01:00:02.858889 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_analytics"} */
show terse objects in USER_DB_CATFISH.analytics limit 10000
[0m01:00:02.859031 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:03.343905 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.485 seconds
[0m01:00:03.347089 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: Close
[0m01:00:03.532942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43580ebe-b33c-4096-a52d-3391e026ac33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1155c28d0>]}
[0m01:00:03.537287 [debug] [Thread-1 (]: Began running node snapshot.stock_elt_project.snapshot_raw_stock_price
[0m01:00:03.537944 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_raw_stock_price ........................ [RUN]
[0m01:00:03.538473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_analytics, now snapshot.stock_elt_project.snapshot_raw_stock_price)
[0m01:00:03.538779 [debug] [Thread-1 (]: Began compiling node snapshot.stock_elt_project.snapshot_raw_stock_price
[0m01:00:03.546605 [debug] [Thread-1 (]: Began executing node snapshot.stock_elt_project.snapshot_raw_stock_price
[0m01:00:03.593222 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:00:03.593538 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(SYMBOL as varchar ), '')
         || '|' || coalesce(cast(DT as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        



SELECT * FROM USER_DB_CATFISH.analytics.lab1_stock_price_table

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m01:00:03.593730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:04.824248 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.231 seconds
[0m01:00:04.830450 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:00:04.830918 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m01:00:04.956709 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.125 seconds
[0m01:00:04.958361 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:00:04.960887 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:00:04.961369 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
create or replace transient table USER_DB_CATFISH.snapshot.snapshot_raw_stock_price
         as
        (
    

    select *,
        md5(coalesce(cast(SYMBOL as varchar ), '')
         || '|' || coalesce(cast(DT as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        



SELECT * FROM USER_DB_CATFISH.analytics.lab1_stock_price_table

    ) sbq



        );
[0m01:00:06.741492 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.781 seconds
[0m01:00:06.766189 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: Close
[0m01:00:06.967035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43580ebe-b33c-4096-a52d-3391e026ac33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115621d30>]}
[0m01:00:06.968485 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.snapshot_raw_stock_price ........................ [[32mSUCCESS 1[0m in 3.43s]
[0m01:00:06.969244 [debug] [Thread-1 (]: Finished running node snapshot.stock_elt_project.snapshot_raw_stock_price
[0m01:00:06.970730 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:00:06.971032 [debug] [MainThread]: Connection 'snapshot.stock_elt_project.snapshot_raw_stock_price' was properly closed.
[0m01:00:06.971340 [info ] [MainThread]: 
[0m01:00:06.971653 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 5.48 seconds (5.48s).
[0m01:00:06.972323 [debug] [MainThread]: Command end result
[0m01:00:06.993569 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/manifest.json
[0m01:00:06.994958 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/semantic_manifest.json
[0m01:00:06.999067 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/run_results.json
[0m01:00:06.999281 [info ] [MainThread]: 
[0m01:00:06.999579 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:00:06.999807 [info ] [MainThread]: 
[0m01:00:06.999989 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:00:07.001623 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 6.438109, "process_in_blocks": "0", "process_kernel_time": 0.191947, "process_mem_max_rss": "146833408", "process_out_blocks": "0", "process_user_time": 1.533686}
[0m01:00:07.001849 [debug] [MainThread]: Command `dbt snapshot` succeeded at 01:00:07.001802 after 6.44 seconds
[0m01:00:07.002034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11619be30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1155aac30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11153af50>]}
[0m01:00:07.002216 [debug] [MainThread]: Flushing usage events
[0m01:00:07.428420 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:02:03.371950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059117f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106657c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106657ed0>]}


============================== 01:02:03.374618 | 0a238116-1902-418b-aafa-59a7db9557b9 ==============================
[0m01:02:03.374618 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:02:03.374867 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:02:03.565867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a238116-1902-418b-aafa-59a7db9557b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10731cb00>]}
[0m01:02:03.585034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a238116-1902-418b-aafa-59a7db9557b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070becf0>]}
[0m01:02:03.585596 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m01:02:03.635433 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:02:03.702875 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:02:03.703040 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:02:03.724417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a238116-1902-418b-aafa-59a7db9557b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070b2250>]}
[0m01:02:03.788136 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/manifest.json
[0m01:02:03.789517 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/semantic_manifest.json
[0m01:02:03.806848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a238116-1902-418b-aafa-59a7db9557b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077e1a90>]}
[0m01:02:03.807076 [info ] [MainThread]: Found 5 models, 1 snapshot, 7 data tests, 2 sources, 462 macros
[0m01:02:03.807217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a238116-1902-418b-aafa-59a7db9557b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107698c90>]}
[0m01:02:03.807982 [info ] [MainThread]: 
[0m01:02:03.808115 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:02:03.808220 [info ] [MainThread]: 
[0m01:02:03.808410 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:02:03.810040 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH_analytics'
[0m01:02:03.817290 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_analytics"
[0m01:02:03.817522 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_analytics"} */
show terse objects in USER_DB_CATFISH.analytics limit 10000
[0m01:02:03.817663 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:04.298244 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.480 seconds
[0m01:02:04.301298 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: Close
[0m01:02:04.466724 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_analytics, now list_USER_DB_CATFISH_snapshot)
[0m01:02:04.471395 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_snapshot"
[0m01:02:04.471826 [debug] [ThreadPool]: On list_USER_DB_CATFISH_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_snapshot"} */
show terse objects in USER_DB_CATFISH.snapshot limit 10000
[0m01:02:04.472148 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:04.955541 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.483 seconds
[0m01:02:04.957743 [debug] [ThreadPool]: On list_USER_DB_CATFISH_snapshot: Close
[0m01:02:05.129585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a238116-1902-418b-aafa-59a7db9557b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10781f930>]}
[0m01:02:05.134312 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950
[0m01:02:05.134821 [info ] [Thread-1 (]: 1 of 7 START test not_null_lab1_stock_price_table_CLOSE ........................ [RUN]
[0m01:02:05.135288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_snapshot, now test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950)
[0m01:02:05.135607 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950
[0m01:02:05.149593 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950"
[0m01:02:05.150527 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950
[0m01:02:05.162902 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950"
[0m01:02:05.163805 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950"
[0m01:02:05.164023 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select CLOSE
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where CLOSE is null



      
    ) dbt_internal_test
[0m01:02:05.164212 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:05.918955 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.754 seconds
[0m01:02:05.930674 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950: Close
[0m01:02:06.076870 [info ] [Thread-1 (]: 1 of 7 PASS not_null_lab1_stock_price_table_CLOSE .............................. [[32mPASS[0m in 0.94s]
[0m01:02:06.077391 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950
[0m01:02:06.077659 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7
[0m01:02:06.077872 [info ] [Thread-1 (]: 2 of 7 START test not_null_lab1_stock_price_table_DT ........................... [RUN]
[0m01:02:06.078134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950, now test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7)
[0m01:02:06.078311 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7
[0m01:02:06.081051 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7"
[0m01:02:06.081716 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7
[0m01:02:06.083370 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7"
[0m01:02:06.084406 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7"
[0m01:02:06.084734 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DT
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where DT is null



      
    ) dbt_internal_test
[0m01:02:06.084978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:06.561624 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.476 seconds
[0m01:02:06.566390 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7: Close
[0m01:02:06.722601 [info ] [Thread-1 (]: 2 of 7 PASS not_null_lab1_stock_price_table_DT ................................. [[32mPASS[0m in 0.64s]
[0m01:02:06.723555 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7
[0m01:02:06.724057 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d
[0m01:02:06.724523 [info ] [Thread-1 (]: 3 of 7 START test not_null_lab1_stock_price_table_HIGH ......................... [RUN]
[0m01:02:06.725129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7, now test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d)
[0m01:02:06.725610 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d
[0m01:02:06.730305 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d"
[0m01:02:06.731258 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d
[0m01:02:06.734465 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d"
[0m01:02:06.735541 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d"
[0m01:02:06.735925 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select HIGH
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where HIGH is null



      
    ) dbt_internal_test
[0m01:02:06.736217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:07.375784 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.639 seconds
[0m01:02:07.379281 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d: Close
[0m01:02:07.538325 [info ] [Thread-1 (]: 3 of 7 PASS not_null_lab1_stock_price_table_HIGH ............................... [[32mPASS[0m in 0.81s]
[0m01:02:07.539533 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d
[0m01:02:07.539894 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8
[0m01:02:07.540247 [info ] [Thread-1 (]: 4 of 7 START test not_null_lab1_stock_price_table_LOW .......................... [RUN]
[0m01:02:07.540692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d, now test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8)
[0m01:02:07.540980 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8
[0m01:02:07.544403 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8"
[0m01:02:07.545241 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8
[0m01:02:07.550633 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8"
[0m01:02:07.551395 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8"
[0m01:02:07.551627 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select LOW
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where LOW is null



      
    ) dbt_internal_test
[0m01:02:07.551835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:07.984960 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.433 seconds
[0m01:02:07.988472 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8: Close
[0m01:02:08.148486 [info ] [Thread-1 (]: 4 of 7 PASS not_null_lab1_stock_price_table_LOW ................................ [[32mPASS[0m in 0.61s]
[0m01:02:08.149610 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8
[0m01:02:08.150192 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0
[0m01:02:08.151028 [info ] [Thread-1 (]: 5 of 7 START test not_null_lab1_stock_price_table_OPEN ......................... [RUN]
[0m01:02:08.152074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8, now test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0)
[0m01:02:08.152558 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0
[0m01:02:08.158242 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0"
[0m01:02:08.159499 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0
[0m01:02:08.162110 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0"
[0m01:02:08.163247 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0"
[0m01:02:08.163617 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select OPEN
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where OPEN is null



      
    ) dbt_internal_test
[0m01:02:08.163931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:08.689116 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.525 seconds
[0m01:02:08.691800 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0: Close
[0m01:02:08.872190 [info ] [Thread-1 (]: 5 of 7 PASS not_null_lab1_stock_price_table_OPEN ............................... [[32mPASS[0m in 0.72s]
[0m01:02:08.873249 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0
[0m01:02:08.873755 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c
[0m01:02:08.874215 [info ] [Thread-1 (]: 6 of 7 START test not_null_lab1_stock_price_table_SYMBOL ....................... [RUN]
[0m01:02:08.874729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0, now test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c)
[0m01:02:08.875096 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c
[0m01:02:08.884397 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c"
[0m01:02:08.885429 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c
[0m01:02:08.888700 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c"
[0m01:02:08.889745 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c"
[0m01:02:08.890099 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SYMBOL
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where SYMBOL is null



      
    ) dbt_internal_test
[0m01:02:08.890392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:09.354286 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.464 seconds
[0m01:02:09.359016 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c: Close
[0m01:02:09.516954 [info ] [Thread-1 (]: 6 of 7 PASS not_null_lab1_stock_price_table_SYMBOL ............................. [[32mPASS[0m in 0.64s]
[0m01:02:09.518036 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c
[0m01:02:09.518553 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8
[0m01:02:09.519035 [info ] [Thread-1 (]: 7 of 7 START test not_null_lab1_stock_price_table_VOLUME ....................... [RUN]
[0m01:02:09.519606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c, now test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8)
[0m01:02:09.520025 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8
[0m01:02:09.525686 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8"
[0m01:02:09.526738 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8
[0m01:02:09.528915 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8"
[0m01:02:09.529992 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8"
[0m01:02:09.530240 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VOLUME
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where VOLUME is null



      
    ) dbt_internal_test
[0m01:02:09.530421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:10.123380 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.593 seconds
[0m01:02:10.128194 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8: Close
[0m01:02:10.297325 [info ] [Thread-1 (]: 7 of 7 PASS not_null_lab1_stock_price_table_VOLUME ............................. [[32mPASS[0m in 0.78s]
[0m01:02:10.298355 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8
[0m01:02:10.300281 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:02:10.300723 [debug] [MainThread]: Connection 'test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8' was properly closed.
[0m01:02:10.301172 [info ] [MainThread]: 
[0m01:02:10.301576 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 6.49 seconds (6.49s).
[0m01:02:10.303223 [debug] [MainThread]: Command end result
[0m01:02:10.325919 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/manifest.json
[0m01:02:10.327700 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/semantic_manifest.json
[0m01:02:10.332229 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/run_results.json
[0m01:02:10.332453 [info ] [MainThread]: 
[0m01:02:10.332681 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:02:10.332855 [info ] [MainThread]: 
[0m01:02:10.333039 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m01:02:10.334297 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.991209, "process_in_blocks": "0", "process_kernel_time": 0.214296, "process_mem_max_rss": "141115392", "process_out_blocks": "0", "process_user_time": 1.395843}
[0m01:02:10.334548 [debug] [MainThread]: Command `dbt test` succeeded at 01:02:10.334496 after 6.99 seconds
[0m01:02:10.334767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106463890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078c3b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078c3e30>]}
[0m01:02:10.334980 [debug] [MainThread]: Flushing usage events
[0m01:02:10.769344 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:02:14.024655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067cd7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cc7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cc7ed0>]}


============================== 01:02:14.027147 | 46a8206b-bcc6-4b6f-97ec-7f7853083485 ==============================
[0m01:02:14.027147 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:02:14.027401 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/logs', 'profiles_dir': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:02:14.189653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46a8206b-bcc6-4b6f-97ec-7f7853083485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a70b00>]}
[0m01:02:14.209881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46a8206b-bcc6-4b6f-97ec-7f7853083485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108f2cf0>]}
[0m01:02:14.210609 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m01:02:14.259863 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:02:14.320379 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:02:14.320557 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:02:14.342439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46a8206b-bcc6-4b6f-97ec-7f7853083485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108e6250>]}
[0m01:02:14.406816 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/manifest.json
[0m01:02:14.407970 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/semantic_manifest.json
[0m01:02:14.417466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46a8206b-bcc6-4b6f-97ec-7f7853083485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a876b0>]}
[0m01:02:14.417657 [info ] [MainThread]: Found 5 models, 1 snapshot, 7 data tests, 2 sources, 462 macros
[0m01:02:14.417790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46a8206b-bcc6-4b6f-97ec-7f7853083485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a09550>]}
[0m01:02:14.418482 [info ] [MainThread]: 
[0m01:02:14.418612 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:02:14.418716 [info ] [MainThread]: 
[0m01:02:14.418905 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:02:14.419232 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH'
[0m01:02:14.424834 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH"
[0m01:02:14.425005 [debug] [ThreadPool]: On list_USER_DB_CATFISH: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH"} */
show terse schemas in database USER_DB_CATFISH
    limit 10000
[0m01:02:14.425124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:14.933993 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.509 seconds
[0m01:02:14.935211 [debug] [ThreadPool]: On list_USER_DB_CATFISH: Close
[0m01:02:15.099497 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH, now list_USER_DB_CATFISH_snapshot)
[0m01:02:15.110734 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_snapshot"
[0m01:02:15.111172 [debug] [ThreadPool]: On list_USER_DB_CATFISH_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_snapshot"} */
show terse objects in USER_DB_CATFISH.snapshot limit 10000
[0m01:02:15.111445 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:15.543244 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.432 seconds
[0m01:02:15.546269 [debug] [ThreadPool]: On list_USER_DB_CATFISH_snapshot: Close
[0m01:02:15.699522 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_snapshot, now list_USER_DB_CATFISH_analytics)
[0m01:02:15.703358 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_analytics"
[0m01:02:15.703834 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_analytics"} */
show terse objects in USER_DB_CATFISH.analytics limit 10000
[0m01:02:15.704323 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:16.184883 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.480 seconds
[0m01:02:16.187898 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: Close
[0m01:02:16.369317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46a8206b-bcc6-4b6f-97ec-7f7853083485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f64fc0>]}
[0m01:02:16.372913 [debug] [Thread-1 (]: Began running node snapshot.stock_elt_project.snapshot_raw_stock_price
[0m01:02:16.373533 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_raw_stock_price ........................ [RUN]
[0m01:02:16.373936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_analytics, now snapshot.stock_elt_project.snapshot_raw_stock_price)
[0m01:02:16.374215 [debug] [Thread-1 (]: Began compiling node snapshot.stock_elt_project.snapshot_raw_stock_price
[0m01:02:16.381380 [debug] [Thread-1 (]: Began executing node snapshot.stock_elt_project.snapshot_raw_stock_price
[0m01:02:16.415600 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:02:16.415861 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
select * from (
        



SELECT * FROM USER_DB_CATFISH.analytics.lab1_stock_price_table

    ) as __dbt_sbq
    where false
    limit 0
[0m01:02:16.416024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:16.885488 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.469 seconds
[0m01:02:16.897610 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:02:16.899157 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
describe table "USER_DB_CATFISH"."SNAPSHOT"."SNAPSHOT_RAW_STOCK_PRICE"
[0m01:02:17.001656 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.101 seconds
[0m01:02:17.013349 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:02:17.013983 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
describe table "USER_DB_CATFISH"."SNAPSHOT"."SNAPSHOT_RAW_STOCK_PRICE"
[0m01:02:17.122990 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.108 seconds
[0m01:02:17.148382 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:02:17.148780 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
create or replace temporary table "USER_DB_CATFISH"."SNAPSHOT"."SNAPSHOT_RAW_STOCK_PRICE__dbt_tmp"
         as
        (
    
    with snapshot_query as (

        



SELECT * FROM USER_DB_CATFISH.analytics.lab1_stock_price_table


    ),

    snapshotted_data as (

        select *, 
    
        
            SYMBOL as dbt_unique_key_1 ,
        
            DT as dbt_unique_key_2
        
    

        from "USER_DB_CATFISH"."SNAPSHOT"."SNAPSHOT_RAW_STOCK_PRICE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            SYMBOL as dbt_unique_key_1 ,
        
            DT as dbt_unique_key_2
        
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(SYMBOL as varchar ), '')
         || '|' || coalesce(cast(DT as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            SYMBOL as dbt_unique_key_1 ,
        
            DT as dbt_unique_key_2
        
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            SYMBOL as dbt_unique_key_1 ,
        
            DT as dbt_unique_key_2
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and ((snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."DT" != source_data."DT"
        or
        (
            ((snapshotted_data."DT" is null) and not (source_data."DT" is null))
            or
            ((not snapshotted_data."DT" is null) and (source_data."DT" is null))
        ) or snapshotted_data."OPEN" != source_data."OPEN"
        or
        (
            ((snapshotted_data."OPEN" is null) and not (source_data."OPEN" is null))
            or
            ((not snapshotted_data."OPEN" is null) and (source_data."OPEN" is null))
        ) or snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."HIGH" != source_data."HIGH"
        or
        (
            ((snapshotted_data."HIGH" is null) and not (source_data."HIGH" is null))
            or
            ((not snapshotted_data."HIGH" is null) and (source_data."HIGH" is null))
        ) or snapshotted_data."LOW" != source_data."LOW"
        or
        (
            ((snapshotted_data."LOW" is null) and not (source_data."LOW" is null))
            or
            ((not snapshotted_data."LOW" is null) and (source_data."LOW" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

        where (
            (snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."DT" != source_data."DT"
        or
        (
            ((snapshotted_data."DT" is null) and not (source_data."DT" is null))
            or
            ((not snapshotted_data."DT" is null) and (source_data."DT" is null))
        ) or snapshotted_data."OPEN" != source_data."OPEN"
        or
        (
            ((snapshotted_data."OPEN" is null) and not (source_data."OPEN" is null))
            or
            ((not snapshotted_data."OPEN" is null) and (source_data."OPEN" is null))
        ) or snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."HIGH" != source_data."HIGH"
        or
        (
            ((snapshotted_data."HIGH" is null) and not (source_data."HIGH" is null))
            or
            ((not snapshotted_data."HIGH" is null) and (source_data."HIGH" is null))
        ) or snapshotted_data."LOW" != source_data."LOW"
        or
        (
            ((snapshotted_data."LOW" is null) and not (source_data."LOW" is null))
            or
            ((not snapshotted_data."LOW" is null) and (source_data."LOW" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m01:02:18.106868 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.957 seconds
[0m01:02:18.111564 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:02:18.112145 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
describe table "USER_DB_CATFISH"."SNAPSHOT"."SNAPSHOT_RAW_STOCK_PRICE__dbt_tmp"
[0m01:02:18.217112 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.105 seconds
[0m01:02:18.220629 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:02:18.221003 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
describe table "USER_DB_CATFISH"."SNAPSHOT"."SNAPSHOT_RAW_STOCK_PRICE"
[0m01:02:18.334507 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.113 seconds
[0m01:02:18.346052 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:02:18.346735 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
describe table "USER_DB_CATFISH"."SNAPSHOT"."SNAPSHOT_RAW_STOCK_PRICE__dbt_tmp"
[0m01:02:18.479440 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.132 seconds
[0m01:02:18.487796 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:02:18.488753 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
describe table "USER_DB_CATFISH"."SNAPSHOT"."SNAPSHOT_RAW_STOCK_PRICE"
[0m01:02:18.581789 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.092 seconds
[0m01:02:18.601202 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:02:18.601583 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
describe table "USER_DB_CATFISH"."SNAPSHOT"."SNAPSHOT_RAW_STOCK_PRICE__dbt_tmp"
[0m01:02:18.731779 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.130 seconds
[0m01:02:18.752267 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:02:18.752800 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
select * from (
        
    
    with snapshot_query as (

        



SELECT * FROM USER_DB_CATFISH.analytics.lab1_stock_price_table


    ),

    snapshotted_data as (

        select *, 
    
        
            SYMBOL as dbt_unique_key_1 ,
        
            DT as dbt_unique_key_2
        
    

        from "USER_DB_CATFISH"."SNAPSHOT"."SNAPSHOT_RAW_STOCK_PRICE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            SYMBOL as dbt_unique_key_1 ,
        
            DT as dbt_unique_key_2
        
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(SYMBOL as varchar ), '')
         || '|' || coalesce(cast(DT as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            SYMBOL as dbt_unique_key_1 ,
        
            DT as dbt_unique_key_2
        
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            SYMBOL as dbt_unique_key_1 ,
        
            DT as dbt_unique_key_2
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and ((snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."DT" != source_data."DT"
        or
        (
            ((snapshotted_data."DT" is null) and not (source_data."DT" is null))
            or
            ((not snapshotted_data."DT" is null) and (source_data."DT" is null))
        ) or snapshotted_data."OPEN" != source_data."OPEN"
        or
        (
            ((snapshotted_data."OPEN" is null) and not (source_data."OPEN" is null))
            or
            ((not snapshotted_data."OPEN" is null) and (source_data."OPEN" is null))
        ) or snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."HIGH" != source_data."HIGH"
        or
        (
            ((snapshotted_data."HIGH" is null) and not (source_data."HIGH" is null))
            or
            ((not snapshotted_data."HIGH" is null) and (source_data."HIGH" is null))
        ) or snapshotted_data."LOW" != source_data."LOW"
        or
        (
            ((snapshotted_data."LOW" is null) and not (source_data."LOW" is null))
            or
            ((not snapshotted_data."LOW" is null) and (source_data."LOW" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

        where (
            (snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."DT" != source_data."DT"
        or
        (
            ((snapshotted_data."DT" is null) and not (source_data."DT" is null))
            or
            ((not snapshotted_data."DT" is null) and (source_data."DT" is null))
        ) or snapshotted_data."OPEN" != source_data."OPEN"
        or
        (
            ((snapshotted_data."OPEN" is null) and not (source_data."OPEN" is null))
            or
            ((not snapshotted_data."OPEN" is null) and (source_data."OPEN" is null))
        ) or snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."HIGH" != source_data."HIGH"
        or
        (
            ((snapshotted_data."HIGH" is null) and not (source_data."HIGH" is null))
            or
            ((not snapshotted_data."HIGH" is null) and (source_data."HIGH" is null))
        ) or snapshotted_data."LOW" != source_data."LOW"
        or
        (
            ((snapshotted_data."LOW" is null) and not (source_data."LOW" is null))
            or
            ((not snapshotted_data."LOW" is null) and (source_data."LOW" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m01:02:19.120591 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.367 seconds
[0m01:02:19.122333 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:02:19.122512 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m01:02:19.228686 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.106 seconds
[0m01:02:19.229040 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:02:19.230454 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:02:19.230611 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
BEGIN
[0m01:02:19.363677 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.133 seconds
[0m01:02:19.364086 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:02:19.364365 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
merge into "USER_DB_CATFISH"."SNAPSHOT"."SNAPSHOT_RAW_STOCK_PRICE" as DBT_INTERNAL_DEST
    using "USER_DB_CATFISH"."SNAPSHOT"."SNAPSHOT_RAW_STOCK_PRICE__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DT", "OPEN", "CLOSE", "HIGH", "LOW", "VOLUME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DT", "OPEN", "CLOSE", "HIGH", "LOW", "VOLUME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m01:02:19.807745 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.443 seconds
[0m01:02:19.809459 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:02:19.810361 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
COMMIT
[0m01:02:20.255206 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.444 seconds
[0m01:02:20.280708 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: Close
[0m01:02:20.431708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46a8206b-bcc6-4b6f-97ec-7f7853083485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f2dc10>]}
[0m01:02:20.432845 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.snapshot_raw_stock_price ........................ [[32mSUCCESS 0[0m in 4.06s]
[0m01:02:20.433746 [debug] [Thread-1 (]: Finished running node snapshot.stock_elt_project.snapshot_raw_stock_price
[0m01:02:20.434919 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:02:20.435153 [debug] [MainThread]: Connection 'snapshot.stock_elt_project.snapshot_raw_stock_price' was properly closed.
[0m01:02:20.435363 [info ] [MainThread]: 
[0m01:02:20.435793 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.02 seconds (6.02s).
[0m01:02:20.436214 [debug] [MainThread]: Command end result
[0m01:02:20.451681 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/manifest.json
[0m01:02:20.454727 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/semantic_manifest.json
[0m01:02:20.459986 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/run_results.json
[0m01:02:20.461292 [info ] [MainThread]: 
[0m01:02:20.461769 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:02:20.461918 [info ] [MainThread]: 
[0m01:02:20.462064 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:02:20.463660 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 6.465258, "process_in_blocks": "0", "process_kernel_time": 0.187233, "process_mem_max_rss": "142573568", "process_out_blocks": "0", "process_user_time": 1.219203}
[0m01:02:20.463888 [debug] [MainThread]: Command `dbt snapshot` succeeded at 01:02:20.463845 after 6.47 seconds
[0m01:02:20.464084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11112e4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111f93b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111f9310>]}
[0m01:02:20.464264 [debug] [MainThread]: Flushing usage events
[0m01:02:20.845388 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:02:54.860688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042f57f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10503fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10503fed0>]}


============================== 01:02:54.863325 | 49e3350a-908d-4ea7-bf52-ada75182939f ==============================
[0m01:02:54.863325 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:02:54.863579 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:02:55.063729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49e3350a-908d-4ea7-bf52-ada75182939f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d10b00>]}
[0m01:02:55.083393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49e3350a-908d-4ea7-bf52-ada75182939f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a9ecf0>]}
[0m01:02:55.083973 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m01:02:55.133197 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:02:55.196134 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:02:55.196313 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:02:55.217600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49e3350a-908d-4ea7-bf52-ada75182939f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a92250>]}
[0m01:02:55.280757 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/manifest.json
[0m01:02:55.282259 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/semantic_manifest.json
[0m01:02:55.292463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49e3350a-908d-4ea7-bf52-ada75182939f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d176b0>]}
[0m01:02:55.292650 [info ] [MainThread]: Found 5 models, 1 snapshot, 7 data tests, 2 sources, 462 macros
[0m01:02:55.292783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49e3350a-908d-4ea7-bf52-ada75182939f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c95710>]}
[0m01:02:55.293507 [info ] [MainThread]: 
[0m01:02:55.293640 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:02:55.293747 [info ] [MainThread]: 
[0m01:02:55.293934 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:02:55.295689 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH'
[0m01:02:55.301387 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH"
[0m01:02:55.301565 [debug] [ThreadPool]: On list_USER_DB_CATFISH: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH"} */
show terse schemas in database USER_DB_CATFISH
    limit 10000
[0m01:02:55.301686 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:55.998962 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.697 seconds
[0m01:02:56.003158 [debug] [ThreadPool]: On list_USER_DB_CATFISH: Close
[0m01:02:56.173563 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH, now list_USER_DB_CATFISH_analytics)
[0m01:02:56.184138 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_analytics"
[0m01:02:56.184630 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_analytics"} */
show terse objects in USER_DB_CATFISH.analytics limit 10000
[0m01:02:56.184943 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:56.627671 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.443 seconds
[0m01:02:56.632105 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: Close
[0m01:02:56.793448 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_analytics, now list_USER_DB_CATFISH_snapshot)
[0m01:02:56.797530 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_snapshot"
[0m01:02:56.797966 [debug] [ThreadPool]: On list_USER_DB_CATFISH_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_snapshot"} */
show terse objects in USER_DB_CATFISH.snapshot limit 10000
[0m01:02:56.798270 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:57.296895 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.498 seconds
[0m01:02:57.300035 [debug] [ThreadPool]: On list_USER_DB_CATFISH_snapshot: Close
[0m01:02:57.471458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49e3350a-908d-4ea7-bf52-ada75182939f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060f54a0>]}
[0m01:02:57.472884 [debug] [Thread-1 (]: Began running node model.stock_elt_project.lab1_stock_price_table
[0m01:02:57.473119 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.lab1_stock_price_table ................... [RUN]
[0m01:02:57.473309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_snapshot, now model.stock_elt_project.lab1_stock_price_table)
[0m01:02:57.473454 [debug] [Thread-1 (]: Began compiling node model.stock_elt_project.lab1_stock_price_table
[0m01:02:57.476648 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt_project.lab1_stock_price_table"
[0m01:02:57.477112 [debug] [Thread-1 (]: Began executing node model.stock_elt_project.lab1_stock_price_table
[0m01:02:57.492138 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_elt_project.lab1_stock_price_table"
[0m01:02:57.493085 [debug] [Thread-1 (]: Using snowflake connection "model.stock_elt_project.lab1_stock_price_table"
[0m01:02:57.493267 [debug] [Thread-1 (]: On model.stock_elt_project.lab1_stock_price_table: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_elt_project.lab1_stock_price_table"} */
create or replace   view USER_DB_CATFISH.analytics.lab1_stock_price_table
  
   as (
    SELECT *
FROM USER_DB_CATFISH.raw.raw_stock_data
  );
[0m01:02:57.493414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:58.116188 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.622 seconds
[0m01:02:58.142613 [debug] [Thread-1 (]: On model.stock_elt_project.lab1_stock_price_table: Close
[0m01:02:58.298735 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49e3350a-908d-4ea7-bf52-ada75182939f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060c5490>]}
[0m01:02:58.299426 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.lab1_stock_price_table .............. [[32mSUCCESS 1[0m in 0.82s]
[0m01:02:58.299957 [debug] [Thread-1 (]: Finished running node model.stock_elt_project.lab1_stock_price_table
[0m01:02:58.300729 [debug] [Thread-1 (]: Began running node model.stock_elt_project.price_gap_calc
[0m01:02:58.301185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt_project.lab1_stock_price_table, now model.stock_elt_project.price_gap_calc)
[0m01:02:58.301608 [debug] [Thread-1 (]: Began compiling node model.stock_elt_project.price_gap_calc
[0m01:02:58.303924 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt_project.price_gap_calc"
[0m01:02:58.304883 [debug] [Thread-1 (]: Finished running node model.stock_elt_project.price_gap_calc
[0m01:02:58.305151 [debug] [Thread-1 (]: Began running node model.stock_elt_project.rolling_average_calc
[0m01:02:58.305456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt_project.price_gap_calc, now model.stock_elt_project.rolling_average_calc)
[0m01:02:58.305728 [debug] [Thread-1 (]: Began compiling node model.stock_elt_project.rolling_average_calc
[0m01:02:58.307875 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt_project.rolling_average_calc"
[0m01:02:58.308824 [debug] [Thread-1 (]: Finished running node model.stock_elt_project.rolling_average_calc
[0m01:02:58.309140 [debug] [Thread-1 (]: Began running node model.stock_elt_project.price_gap_filtered
[0m01:02:58.309519 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.price_gap_filtered ...................... [RUN]
[0m01:02:58.309876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt_project.rolling_average_calc, now model.stock_elt_project.price_gap_filtered)
[0m01:02:58.310117 [debug] [Thread-1 (]: Began compiling node model.stock_elt_project.price_gap_filtered
[0m01:02:58.313040 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt_project.price_gap_filtered"
[0m01:02:58.313515 [debug] [Thread-1 (]: Began executing node model.stock_elt_project.price_gap_filtered
[0m01:02:58.326005 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_elt_project.price_gap_filtered"
[0m01:02:58.326804 [debug] [Thread-1 (]: Using snowflake connection "model.stock_elt_project.price_gap_filtered"
[0m01:02:58.327017 [debug] [Thread-1 (]: On model.stock_elt_project.price_gap_filtered: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_elt_project.price_gap_filtered"} */
create or replace transient table USER_DB_CATFISH.analytics.price_gap_filtered
         as
        (with __dbt__cte__price_gap_calc as (
SELECT SYMBOL,
        DT AS DATE,
        OPEN,
        LAG(CLOSE, 1) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DT) as LAST_CLOSING
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
ORDER BY SYMBOL, DATE
) SELECT *,
       (OPEN - LAST_CLOSING) AS PRICE_GAP
FROM __dbt__cte__price_gap_calc
WHERE LAST_CLOSING IS NOT NULL
        );
[0m01:02:58.327194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:59.414285 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.087 seconds
[0m01:02:59.417995 [debug] [Thread-1 (]: On model.stock_elt_project.price_gap_filtered: Close
[0m01:02:59.631645 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49e3350a-908d-4ea7-bf52-ada75182939f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c9650>]}
[0m01:02:59.632983 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.price_gap_filtered ................. [[32mSUCCESS 1[0m in 1.32s]
[0m01:02:59.633865 [debug] [Thread-1 (]: Finished running node model.stock_elt_project.price_gap_filtered
[0m01:02:59.634458 [debug] [Thread-1 (]: Began running node model.stock_elt_project.rolling_avg_filtered
[0m01:02:59.635171 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.rolling_avg_filtered .................... [RUN]
[0m01:02:59.635906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt_project.price_gap_filtered, now model.stock_elt_project.rolling_avg_filtered)
[0m01:02:59.636397 [debug] [Thread-1 (]: Began compiling node model.stock_elt_project.rolling_avg_filtered
[0m01:02:59.642350 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt_project.rolling_avg_filtered"
[0m01:02:59.643844 [debug] [Thread-1 (]: Began executing node model.stock_elt_project.rolling_avg_filtered
[0m01:02:59.646976 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_elt_project.rolling_avg_filtered"
[0m01:02:59.648655 [debug] [Thread-1 (]: Using snowflake connection "model.stock_elt_project.rolling_avg_filtered"
[0m01:02:59.649043 [debug] [Thread-1 (]: On model.stock_elt_project.rolling_avg_filtered: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_elt_project.rolling_avg_filtered"} */
create or replace transient table USER_DB_CATFISH.analytics.rolling_avg_filtered
         as
        (with __dbt__cte__rolling_average_calc as (


SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
) SELECT SYMBOL,
       DATE,
       ROLLING_AVERAGE
FROM __dbt__cte__rolling_average_calc
WHERE row_num >= 7
ORDER BY SYMBOL, DATE, row_num
        );
[0m01:02:59.649374 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:00.651114 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.001 seconds
[0m01:03:00.656245 [debug] [Thread-1 (]: On model.stock_elt_project.rolling_avg_filtered: Close
[0m01:03:00.819467 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49e3350a-908d-4ea7-bf52-ada75182939f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061019f0>]}
[0m01:03:00.820752 [info ] [Thread-1 (]: 3 of 3 OK created sql table model analytics.rolling_avg_filtered ............... [[32mSUCCESS 1[0m in 1.18s]
[0m01:03:00.821639 [debug] [Thread-1 (]: Finished running node model.stock_elt_project.rolling_avg_filtered
[0m01:03:00.823422 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:03:00.823784 [debug] [MainThread]: Connection 'model.stock_elt_project.rolling_avg_filtered' was properly closed.
[0m01:03:00.824209 [info ] [MainThread]: 
[0m01:03:00.824598 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 5.53 seconds (5.53s).
[0m01:03:00.825640 [debug] [MainThread]: Command end result
[0m01:03:00.852637 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/manifest.json
[0m01:03:00.853813 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/semantic_manifest.json
[0m01:03:00.857415 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/run_results.json
[0m01:03:00.857628 [info ] [MainThread]: 
[0m01:03:00.857855 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:03:00.858024 [info ] [MainThread]: 
[0m01:03:00.858204 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m01:03:00.859469 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.027227, "process_in_blocks": "0", "process_kernel_time": 0.194304, "process_mem_max_rss": "142262272", "process_out_blocks": "0", "process_user_time": 1.196272}
[0m01:03:00.859691 [debug] [MainThread]: Command `dbt run` succeeded at 01:03:00.859642 after 6.03 seconds
[0m01:03:00.859890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037d60d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f37cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050a5470>]}
[0m01:03:00.860082 [debug] [MainThread]: Flushing usage events
[0m01:03:01.258371 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:03:29.785587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039017f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc7ed0>]}


============================== 01:03:29.788616 | 92270584-a40c-4b78-852e-5ab44aa660c1 ==============================
[0m01:03:29.788616 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:03:29.788888 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:03:29.988937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92270584-a40c-4b78-852e-5ab44aa660c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f64b00>]}
[0m01:03:30.009979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92270584-a40c-4b78-852e-5ab44aa660c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cf2cf0>]}
[0m01:03:30.010734 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m01:03:30.062833 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:03:30.128279 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:03:30.128471 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:03:30.149787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92270584-a40c-4b78-852e-5ab44aa660c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ce6250>]}
[0m01:03:30.213507 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/manifest.json
[0m01:03:30.215006 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/semantic_manifest.json
[0m01:03:30.230525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92270584-a40c-4b78-852e-5ab44aa660c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106535a90>]}
[0m01:03:30.230735 [info ] [MainThread]: Found 5 models, 1 snapshot, 7 data tests, 2 sources, 462 macros
[0m01:03:30.230868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92270584-a40c-4b78-852e-5ab44aa660c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063f0c90>]}
[0m01:03:30.231637 [info ] [MainThread]: 
[0m01:03:30.231774 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:03:30.231882 [info ] [MainThread]: 
[0m01:03:30.232074 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:03:30.233758 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH_analytics'
[0m01:03:30.240452 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_analytics"
[0m01:03:30.240670 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_analytics"} */
show terse objects in USER_DB_CATFISH.analytics limit 10000
[0m01:03:30.240793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:03:30.771232 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.530 seconds
[0m01:03:30.774766 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: Close
[0m01:03:30.933508 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_analytics, now list_USER_DB_CATFISH_snapshot)
[0m01:03:30.939965 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_snapshot"
[0m01:03:30.940569 [debug] [ThreadPool]: On list_USER_DB_CATFISH_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_snapshot"} */
show terse objects in USER_DB_CATFISH.snapshot limit 10000
[0m01:03:30.940910 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:03:31.373276 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.432 seconds
[0m01:03:31.376818 [debug] [ThreadPool]: On list_USER_DB_CATFISH_snapshot: Close
[0m01:03:31.528653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92270584-a40c-4b78-852e-5ab44aa660c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106573930>]}
[0m01:03:31.531019 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950
[0m01:03:31.531234 [info ] [Thread-1 (]: 1 of 7 START test not_null_lab1_stock_price_table_CLOSE ........................ [RUN]
[0m01:03:31.531435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_snapshot, now test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950)
[0m01:03:31.531579 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950
[0m01:03:31.538359 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950"
[0m01:03:31.538731 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950
[0m01:03:31.547034 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950"
[0m01:03:31.547602 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950"
[0m01:03:31.547759 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select CLOSE
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where CLOSE is null



      
    ) dbt_internal_test
[0m01:03:31.547895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:32.653798 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.105 seconds
[0m01:03:32.668170 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950: Close
[0m01:03:32.843363 [info ] [Thread-1 (]: 1 of 7 PASS not_null_lab1_stock_price_table_CLOSE .............................. [[32mPASS[0m in 1.31s]
[0m01:03:32.844693 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950
[0m01:03:32.845425 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7
[0m01:03:32.846136 [info ] [Thread-1 (]: 2 of 7 START test not_null_lab1_stock_price_table_DT ........................... [RUN]
[0m01:03:32.846775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950, now test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7)
[0m01:03:32.847218 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7
[0m01:03:32.854414 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7"
[0m01:03:32.855855 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7
[0m01:03:32.859952 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7"
[0m01:03:32.861721 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7"
[0m01:03:32.862164 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DT
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where DT is null



      
    ) dbt_internal_test
[0m01:03:32.862483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:33.380221 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.517 seconds
[0m01:03:33.384521 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7: Close
[0m01:03:33.554162 [info ] [Thread-1 (]: 2 of 7 PASS not_null_lab1_stock_price_table_DT ................................. [[32mPASS[0m in 0.71s]
[0m01:03:33.555213 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7
[0m01:03:33.555755 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d
[0m01:03:33.556275 [info ] [Thread-1 (]: 3 of 7 START test not_null_lab1_stock_price_table_HIGH ......................... [RUN]
[0m01:03:33.556860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7, now test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d)
[0m01:03:33.557244 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d
[0m01:03:33.562516 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d"
[0m01:03:33.563523 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d
[0m01:03:33.567039 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d"
[0m01:03:33.568363 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d"
[0m01:03:33.568700 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select HIGH
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where HIGH is null



      
    ) dbt_internal_test
[0m01:03:33.568961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:34.044293 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.475 seconds
[0m01:03:34.049103 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d: Close
[0m01:03:34.224490 [info ] [Thread-1 (]: 3 of 7 PASS not_null_lab1_stock_price_table_HIGH ............................... [[32mPASS[0m in 0.67s]
[0m01:03:34.225556 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d
[0m01:03:34.226075 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8
[0m01:03:34.226536 [info ] [Thread-1 (]: 4 of 7 START test not_null_lab1_stock_price_table_LOW .......................... [RUN]
[0m01:03:34.227112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d, now test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8)
[0m01:03:34.227525 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8
[0m01:03:34.233111 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8"
[0m01:03:34.234168 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8
[0m01:03:34.241764 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8"
[0m01:03:34.243037 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8"
[0m01:03:34.243358 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select LOW
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where LOW is null



      
    ) dbt_internal_test
[0m01:03:34.243629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:34.642750 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.399 seconds
[0m01:03:34.645984 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8: Close
[0m01:03:34.914668 [info ] [Thread-1 (]: 4 of 7 PASS not_null_lab1_stock_price_table_LOW ................................ [[32mPASS[0m in 0.69s]
[0m01:03:34.916792 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8
[0m01:03:34.917560 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0
[0m01:03:34.918108 [info ] [Thread-1 (]: 5 of 7 START test not_null_lab1_stock_price_table_OPEN ......................... [RUN]
[0m01:03:34.918913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8, now test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0)
[0m01:03:34.919398 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0
[0m01:03:34.926459 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0"
[0m01:03:34.927749 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0
[0m01:03:34.931048 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0"
[0m01:03:34.932736 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0"
[0m01:03:34.933160 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select OPEN
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where OPEN is null



      
    ) dbt_internal_test
[0m01:03:34.933463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:35.826909 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.893 seconds
[0m01:03:35.830575 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0: Close
[0m01:03:36.003739 [info ] [Thread-1 (]: 5 of 7 PASS not_null_lab1_stock_price_table_OPEN ............................... [[32mPASS[0m in 1.08s]
[0m01:03:36.004847 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0
[0m01:03:36.005413 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c
[0m01:03:36.005954 [info ] [Thread-1 (]: 6 of 7 START test not_null_lab1_stock_price_table_SYMBOL ....................... [RUN]
[0m01:03:36.006596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0, now test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c)
[0m01:03:36.007070 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c
[0m01:03:36.012927 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c"
[0m01:03:36.014222 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c
[0m01:03:36.017187 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c"
[0m01:03:36.018919 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c"
[0m01:03:36.019400 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SYMBOL
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where SYMBOL is null



      
    ) dbt_internal_test
[0m01:03:36.019744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:36.548720 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.529 seconds
[0m01:03:36.549844 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c: Close
[0m01:03:36.704528 [info ] [Thread-1 (]: 6 of 7 PASS not_null_lab1_stock_price_table_SYMBOL ............................. [[32mPASS[0m in 0.70s]
[0m01:03:36.704985 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c
[0m01:03:36.705225 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8
[0m01:03:36.705496 [info ] [Thread-1 (]: 7 of 7 START test not_null_lab1_stock_price_table_VOLUME ....................... [RUN]
[0m01:03:36.705821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c, now test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8)
[0m01:03:36.706048 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8
[0m01:03:36.708360 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8"
[0m01:03:36.708812 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8
[0m01:03:36.709951 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8"
[0m01:03:36.710452 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8"
[0m01:03:36.710644 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VOLUME
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where VOLUME is null



      
    ) dbt_internal_test
[0m01:03:36.710870 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:37.130112 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.419 seconds
[0m01:03:37.132471 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8: Close
[0m01:03:37.295111 [info ] [Thread-1 (]: 7 of 7 PASS not_null_lab1_stock_price_table_VOLUME ............................. [[32mPASS[0m in 0.59s]
[0m01:03:37.295793 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8
[0m01:03:37.297065 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:03:37.297405 [debug] [MainThread]: Connection 'test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8' was properly closed.
[0m01:03:37.297722 [info ] [MainThread]: 
[0m01:03:37.298034 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 7.07 seconds (7.07s).
[0m01:03:37.299436 [debug] [MainThread]: Command end result
[0m01:03:37.334586 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/manifest.json
[0m01:03:37.336462 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/semantic_manifest.json
[0m01:03:37.341586 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/run_results.json
[0m01:03:37.341818 [info ] [MainThread]: 
[0m01:03:37.342073 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:03:37.342259 [info ] [MainThread]: 
[0m01:03:37.342459 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m01:03:37.344372 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 7.58761, "process_in_blocks": "0", "process_kernel_time": 0.218431, "process_mem_max_rss": "142934016", "process_out_blocks": "0", "process_user_time": 1.420755}
[0m01:03:37.344674 [debug] [MainThread]: Command `dbt test` succeeded at 01:03:37.344611 after 7.59 seconds
[0m01:03:37.344938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ccf890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106617b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106617e30>]}
[0m01:03:37.345182 [debug] [MainThread]: Flushing usage events
[0m01:03:37.782754 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:03:49.125018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066b57f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073ffc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073ffed0>]}


============================== 01:03:49.127462 | b6b3dc15-a32c-4fe9-8816-0ed08f59dd66 ==============================
[0m01:03:49.127462 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:03:49.127706 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m01:03:49.307105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6b3dc15-a32c-4fe9-8816-0ed08f59dd66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080c0b00>]}
[0m01:03:49.326519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6b3dc15-a32c-4fe9-8816-0ed08f59dd66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e62cf0>]}
[0m01:03:49.327638 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m01:03:49.375825 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:03:49.437405 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:03:49.437617 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:03:49.460016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6b3dc15-a32c-4fe9-8816-0ed08f59dd66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e56250>]}
[0m01:03:49.526415 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/manifest.json
[0m01:03:49.527888 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/semantic_manifest.json
[0m01:03:49.537772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6b3dc15-a32c-4fe9-8816-0ed08f59dd66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080d76b0>]}
[0m01:03:49.537999 [info ] [MainThread]: Found 5 models, 1 snapshot, 7 data tests, 2 sources, 462 macros
[0m01:03:49.538139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6b3dc15-a32c-4fe9-8816-0ed08f59dd66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108055550>]}
[0m01:03:49.538851 [info ] [MainThread]: 
[0m01:03:49.538991 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:03:49.539100 [info ] [MainThread]: 
[0m01:03:49.539293 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:03:49.539625 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH'
[0m01:03:49.545193 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH"
[0m01:03:49.545359 [debug] [ThreadPool]: On list_USER_DB_CATFISH: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH"} */
show terse schemas in database USER_DB_CATFISH
    limit 10000
[0m01:03:49.545478 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:03:50.082171 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.536 seconds
[0m01:03:50.085062 [debug] [ThreadPool]: On list_USER_DB_CATFISH: Close
[0m01:03:50.240163 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH, now list_USER_DB_CATFISH_snapshot)
[0m01:03:50.250514 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_snapshot"
[0m01:03:50.250998 [debug] [ThreadPool]: On list_USER_DB_CATFISH_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_snapshot"} */
show terse objects in USER_DB_CATFISH.snapshot limit 10000
[0m01:03:50.251268 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:03:50.743209 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.492 seconds
[0m01:03:50.744000 [debug] [ThreadPool]: On list_USER_DB_CATFISH_snapshot: Close
[0m01:03:50.896457 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_snapshot, now list_USER_DB_CATFISH_analytics)
[0m01:03:50.898819 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_analytics"
[0m01:03:50.899136 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_analytics"} */
show terse objects in USER_DB_CATFISH.analytics limit 10000
[0m01:03:50.899381 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:03:51.319446 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.420 seconds
[0m01:03:51.323389 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: Close
[0m01:03:51.503905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6b3dc15-a32c-4fe9-8816-0ed08f59dd66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084b4fc0>]}
[0m01:03:51.507312 [debug] [Thread-1 (]: Began running node snapshot.stock_elt_project.snapshot_raw_stock_price
[0m01:03:51.507838 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_raw_stock_price ........................ [RUN]
[0m01:03:51.508250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_analytics, now snapshot.stock_elt_project.snapshot_raw_stock_price)
[0m01:03:51.508567 [debug] [Thread-1 (]: Began compiling node snapshot.stock_elt_project.snapshot_raw_stock_price
[0m01:03:51.516315 [debug] [Thread-1 (]: Began executing node snapshot.stock_elt_project.snapshot_raw_stock_price
[0m01:03:51.551398 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:03:51.551669 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
select * from (
        



SELECT * FROM USER_DB_CATFISH.analytics.lab1_stock_price_table

    ) as __dbt_sbq
    where false
    limit 0
[0m01:03:51.551841 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:52.008592 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.456 seconds
[0m01:03:52.020483 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:03:52.021935 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
describe table "USER_DB_CATFISH"."SNAPSHOT"."SNAPSHOT_RAW_STOCK_PRICE"
[0m01:03:52.112040 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.088 seconds
[0m01:03:52.123047 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:03:52.123607 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
describe table "USER_DB_CATFISH"."SNAPSHOT"."SNAPSHOT_RAW_STOCK_PRICE"
[0m01:03:52.226945 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.103 seconds
[0m01:03:52.274390 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:03:52.274850 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
create or replace temporary table "USER_DB_CATFISH"."SNAPSHOT"."SNAPSHOT_RAW_STOCK_PRICE__dbt_tmp"
         as
        (
    
    with snapshot_query as (

        



SELECT * FROM USER_DB_CATFISH.analytics.lab1_stock_price_table


    ),

    snapshotted_data as (

        select *, 
    
        
            SYMBOL as dbt_unique_key_1 ,
        
            DT as dbt_unique_key_2
        
    

        from "USER_DB_CATFISH"."SNAPSHOT"."SNAPSHOT_RAW_STOCK_PRICE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            SYMBOL as dbt_unique_key_1 ,
        
            DT as dbt_unique_key_2
        
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(SYMBOL as varchar ), '')
         || '|' || coalesce(cast(DT as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            SYMBOL as dbt_unique_key_1 ,
        
            DT as dbt_unique_key_2
        
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            SYMBOL as dbt_unique_key_1 ,
        
            DT as dbt_unique_key_2
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and ((snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."DT" != source_data."DT"
        or
        (
            ((snapshotted_data."DT" is null) and not (source_data."DT" is null))
            or
            ((not snapshotted_data."DT" is null) and (source_data."DT" is null))
        ) or snapshotted_data."OPEN" != source_data."OPEN"
        or
        (
            ((snapshotted_data."OPEN" is null) and not (source_data."OPEN" is null))
            or
            ((not snapshotted_data."OPEN" is null) and (source_data."OPEN" is null))
        ) or snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."HIGH" != source_data."HIGH"
        or
        (
            ((snapshotted_data."HIGH" is null) and not (source_data."HIGH" is null))
            or
            ((not snapshotted_data."HIGH" is null) and (source_data."HIGH" is null))
        ) or snapshotted_data."LOW" != source_data."LOW"
        or
        (
            ((snapshotted_data."LOW" is null) and not (source_data."LOW" is null))
            or
            ((not snapshotted_data."LOW" is null) and (source_data."LOW" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

        where (
            (snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."DT" != source_data."DT"
        or
        (
            ((snapshotted_data."DT" is null) and not (source_data."DT" is null))
            or
            ((not snapshotted_data."DT" is null) and (source_data."DT" is null))
        ) or snapshotted_data."OPEN" != source_data."OPEN"
        or
        (
            ((snapshotted_data."OPEN" is null) and not (source_data."OPEN" is null))
            or
            ((not snapshotted_data."OPEN" is null) and (source_data."OPEN" is null))
        ) or snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."HIGH" != source_data."HIGH"
        or
        (
            ((snapshotted_data."HIGH" is null) and not (source_data."HIGH" is null))
            or
            ((not snapshotted_data."HIGH" is null) and (source_data."HIGH" is null))
        ) or snapshotted_data."LOW" != source_data."LOW"
        or
        (
            ((snapshotted_data."LOW" is null) and not (source_data."LOW" is null))
            or
            ((not snapshotted_data."LOW" is null) and (source_data."LOW" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m01:03:53.349686 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.074 seconds
[0m01:03:53.354539 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:03:53.355093 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
describe table "USER_DB_CATFISH"."SNAPSHOT"."SNAPSHOT_RAW_STOCK_PRICE__dbt_tmp"
[0m01:03:53.453862 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.098 seconds
[0m01:03:53.458761 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:03:53.459238 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
describe table "USER_DB_CATFISH"."SNAPSHOT"."SNAPSHOT_RAW_STOCK_PRICE"
[0m01:03:53.562527 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.103 seconds
[0m01:03:53.574278 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:03:53.574921 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
describe table "USER_DB_CATFISH"."SNAPSHOT"."SNAPSHOT_RAW_STOCK_PRICE__dbt_tmp"
[0m01:03:53.700733 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.125 seconds
[0m01:03:53.706420 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:03:53.707009 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
describe table "USER_DB_CATFISH"."SNAPSHOT"."SNAPSHOT_RAW_STOCK_PRICE"
[0m01:03:53.804254 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.096 seconds
[0m01:03:53.814115 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:03:53.814602 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
describe table "USER_DB_CATFISH"."SNAPSHOT"."SNAPSHOT_RAW_STOCK_PRICE__dbt_tmp"
[0m01:03:53.904219 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.089 seconds
[0m01:03:53.930132 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:03:53.930801 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
select * from (
        
    
    with snapshot_query as (

        



SELECT * FROM USER_DB_CATFISH.analytics.lab1_stock_price_table


    ),

    snapshotted_data as (

        select *, 
    
        
            SYMBOL as dbt_unique_key_1 ,
        
            DT as dbt_unique_key_2
        
    

        from "USER_DB_CATFISH"."SNAPSHOT"."SNAPSHOT_RAW_STOCK_PRICE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            SYMBOL as dbt_unique_key_1 ,
        
            DT as dbt_unique_key_2
        
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(SYMBOL as varchar ), '')
         || '|' || coalesce(cast(DT as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            SYMBOL as dbt_unique_key_1 ,
        
            DT as dbt_unique_key_2
        
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            SYMBOL as dbt_unique_key_1 ,
        
            DT as dbt_unique_key_2
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and ((snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."DT" != source_data."DT"
        or
        (
            ((snapshotted_data."DT" is null) and not (source_data."DT" is null))
            or
            ((not snapshotted_data."DT" is null) and (source_data."DT" is null))
        ) or snapshotted_data."OPEN" != source_data."OPEN"
        or
        (
            ((snapshotted_data."OPEN" is null) and not (source_data."OPEN" is null))
            or
            ((not snapshotted_data."OPEN" is null) and (source_data."OPEN" is null))
        ) or snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."HIGH" != source_data."HIGH"
        or
        (
            ((snapshotted_data."HIGH" is null) and not (source_data."HIGH" is null))
            or
            ((not snapshotted_data."HIGH" is null) and (source_data."HIGH" is null))
        ) or snapshotted_data."LOW" != source_data."LOW"
        or
        (
            ((snapshotted_data."LOW" is null) and not (source_data."LOW" is null))
            or
            ((not snapshotted_data."LOW" is null) and (source_data."LOW" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

        where (
            (snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."DT" != source_data."DT"
        or
        (
            ((snapshotted_data."DT" is null) and not (source_data."DT" is null))
            or
            ((not snapshotted_data."DT" is null) and (source_data."DT" is null))
        ) or snapshotted_data."OPEN" != source_data."OPEN"
        or
        (
            ((snapshotted_data."OPEN" is null) and not (source_data."OPEN" is null))
            or
            ((not snapshotted_data."OPEN" is null) and (source_data."OPEN" is null))
        ) or snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."HIGH" != source_data."HIGH"
        or
        (
            ((snapshotted_data."HIGH" is null) and not (source_data."HIGH" is null))
            or
            ((not snapshotted_data."HIGH" is null) and (source_data."HIGH" is null))
        ) or snapshotted_data."LOW" != source_data."LOW"
        or
        (
            ((snapshotted_data."LOW" is null) and not (source_data."LOW" is null))
            or
            ((not snapshotted_data."LOW" is null) and (source_data."LOW" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m01:03:54.127685 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.196 seconds
[0m01:03:54.131704 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:03:54.132102 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m01:03:54.234462 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.102 seconds
[0m01:03:54.236050 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:03:54.238951 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:03:54.239281 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
BEGIN
[0m01:03:54.400889 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.161 seconds
[0m01:03:54.402048 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:03:54.402938 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
merge into "USER_DB_CATFISH"."SNAPSHOT"."SNAPSHOT_RAW_STOCK_PRICE" as DBT_INTERNAL_DEST
    using "USER_DB_CATFISH"."SNAPSHOT"."SNAPSHOT_RAW_STOCK_PRICE__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DT", "OPEN", "CLOSE", "HIGH", "LOW", "VOLUME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DT", "OPEN", "CLOSE", "HIGH", "LOW", "VOLUME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m01:03:54.974339 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.570 seconds
[0m01:03:54.975313 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:03:54.975831 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
COMMIT
[0m01:03:55.283304 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.307 seconds
[0m01:03:55.305700 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: Close
[0m01:03:55.477137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6b3dc15-a32c-4fe9-8816-0ed08f59dd66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10847dc10>]}
[0m01:03:55.478191 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.snapshot_raw_stock_price ........................ [[32mSUCCESS 0[0m in 3.97s]
[0m01:03:55.478757 [debug] [Thread-1 (]: Finished running node snapshot.stock_elt_project.snapshot_raw_stock_price
[0m01:03:55.479922 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:03:55.480279 [debug] [MainThread]: Connection 'snapshot.stock_elt_project.snapshot_raw_stock_price' was properly closed.
[0m01:03:55.480571 [info ] [MainThread]: 
[0m01:03:55.480860 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 5.94 seconds (5.94s).
[0m01:03:55.481465 [debug] [MainThread]: Command end result
[0m01:03:55.503661 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/manifest.json
[0m01:03:55.505404 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/semantic_manifest.json
[0m01:03:55.509601 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/run_results.json
[0m01:03:55.509844 [info ] [MainThread]: 
[0m01:03:55.510088 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:03:55.510265 [info ] [MainThread]: 
[0m01:03:55.510451 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:03:55.512619 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 6.4150553, "process_in_blocks": "0", "process_kernel_time": 0.188476, "process_mem_max_rss": "142753792", "process_out_blocks": "0", "process_user_time": 1.274783}
[0m01:03:55.512879 [debug] [MainThread]: Command `dbt snapshot` succeeded at 01:03:55.512826 after 6.42 seconds
[0m01:03:55.513104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10857e4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086453b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108645310>]}
[0m01:03:55.513316 [debug] [MainThread]: Flushing usage events
[0m01:03:55.890158 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:25:22.574091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120ad17f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123ac7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123ac7ed0>]}


============================== 01:25:22.576919 | cb077145-d7dc-4d72-9b1e-83584fcae60b ==============================
[0m01:25:22.576919 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:25:22.577213 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt', 'log_path': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:25:22.764531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb077145-d7dc-4d72-9b1e-83584fcae60b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124984b00>]}
[0m01:25:22.784166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb077145-d7dc-4d72-9b1e-83584fcae60b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1247f2cf0>]}
[0m01:25:22.784860 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m01:25:22.834839 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:25:22.898126 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:25:22.898439 [debug] [MainThread]: Partial parsing: updated file: stock_elt_project://models/schema.yml
[0m01:25:23.021890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb077145-d7dc-4d72-9b1e-83584fcae60b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124d89d50>]}
[0m01:25:23.057425 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/manifest.json
[0m01:25:23.058972 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/semantic_manifest.json
[0m01:25:23.075394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb077145-d7dc-4d72-9b1e-83584fcae60b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1250f8230>]}
[0m01:25:23.075618 [info ] [MainThread]: Found 5 models, 1 snapshot, 9 data tests, 2 sources, 462 macros
[0m01:25:23.075753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb077145-d7dc-4d72-9b1e-83584fcae60b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1251091d0>]}
[0m01:25:23.076556 [info ] [MainThread]: 
[0m01:25:23.076690 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:25:23.076793 [info ] [MainThread]: 
[0m01:25:23.076975 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:25:23.078625 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH_snapshot'
[0m01:25:23.084227 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_snapshot"
[0m01:25:23.084440 [debug] [ThreadPool]: On list_USER_DB_CATFISH_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_snapshot"} */
show terse objects in USER_DB_CATFISH.snapshot limit 10000
[0m01:25:23.084561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:25:23.560281 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.475 seconds
[0m01:25:23.564052 [debug] [ThreadPool]: On list_USER_DB_CATFISH_snapshot: Close
[0m01:25:23.718917 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_snapshot, now list_USER_DB_CATFISH_analytics)
[0m01:25:23.723291 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_analytics"
[0m01:25:23.723762 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_analytics"} */
show terse objects in USER_DB_CATFISH.analytics limit 10000
[0m01:25:23.724128 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:25:24.190828 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.466 seconds
[0m01:25:24.193711 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: Close
[0m01:25:24.380049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb077145-d7dc-4d72-9b1e-83584fcae60b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12509fe10>]}
[0m01:25:24.382632 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950
[0m01:25:24.382837 [info ] [Thread-1 (]: 1 of 9 START test not_null_lab1_stock_price_table_CLOSE ........................ [RUN]
[0m01:25:24.383023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_analytics, now test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950)
[0m01:25:24.383169 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950
[0m01:25:24.390378 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950"
[0m01:25:24.390772 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950
[0m01:25:24.398962 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950"
[0m01:25:24.399482 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950"
[0m01:25:24.399635 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select CLOSE
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where CLOSE is null



      
    ) dbt_internal_test
[0m01:25:24.399769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:24.891932 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.492 seconds
[0m01:25:24.904907 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950: Close
[0m01:25:25.061288 [info ] [Thread-1 (]: 1 of 9 PASS not_null_lab1_stock_price_table_CLOSE .............................. [[32mPASS[0m in 0.68s]
[0m01:25:25.062552 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950
[0m01:25:25.063222 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7
[0m01:25:25.063867 [info ] [Thread-1 (]: 2 of 9 START test not_null_lab1_stock_price_table_DT ........................... [RUN]
[0m01:25:25.064599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950, now test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7)
[0m01:25:25.065086 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7
[0m01:25:25.071354 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7"
[0m01:25:25.072765 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7
[0m01:25:25.076059 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7"
[0m01:25:25.077456 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7"
[0m01:25:25.077811 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DT
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where DT is null



      
    ) dbt_internal_test
[0m01:25:25.078123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:25.477078 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.399 seconds
[0m01:25:25.479522 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7: Close
[0m01:25:25.653306 [info ] [Thread-1 (]: 2 of 9 PASS not_null_lab1_stock_price_table_DT ................................. [[32mPASS[0m in 0.59s]
[0m01:25:25.654135 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7
[0m01:25:25.654485 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d
[0m01:25:25.654865 [info ] [Thread-1 (]: 3 of 9 START test not_null_lab1_stock_price_table_HIGH ......................... [RUN]
[0m01:25:25.655192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7, now test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d)
[0m01:25:25.655751 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d
[0m01:25:25.660299 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d"
[0m01:25:25.661606 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d
[0m01:25:25.665232 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d"
[0m01:25:25.669242 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d"
[0m01:25:25.670031 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select HIGH
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where HIGH is null



      
    ) dbt_internal_test
[0m01:25:25.670196 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:26.043443 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.373 seconds
[0m01:25:26.045149 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d: Close
[0m01:25:26.202036 [info ] [Thread-1 (]: 3 of 9 PASS not_null_lab1_stock_price_table_HIGH ............................... [[32mPASS[0m in 0.55s]
[0m01:25:26.202678 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d
[0m01:25:26.203023 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8
[0m01:25:26.203407 [info ] [Thread-1 (]: 4 of 9 START test not_null_lab1_stock_price_table_LOW .......................... [RUN]
[0m01:25:26.203871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d, now test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8)
[0m01:25:26.204151 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8
[0m01:25:26.207254 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8"
[0m01:25:26.207859 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8
[0m01:25:26.209590 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8"
[0m01:25:26.210405 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8"
[0m01:25:26.210646 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select LOW
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where LOW is null



      
    ) dbt_internal_test
[0m01:25:26.210865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:26.657852 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.446 seconds
[0m01:25:26.661658 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8: Close
[0m01:25:26.817827 [info ] [Thread-1 (]: 4 of 9 PASS not_null_lab1_stock_price_table_LOW ................................ [[32mPASS[0m in 0.61s]
[0m01:25:26.818995 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8
[0m01:25:26.819742 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0
[0m01:25:26.820381 [info ] [Thread-1 (]: 5 of 9 START test not_null_lab1_stock_price_table_OPEN ......................... [RUN]
[0m01:25:26.821052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8, now test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0)
[0m01:25:26.821526 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0
[0m01:25:26.827390 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0"
[0m01:25:26.828813 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0
[0m01:25:26.831406 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0"
[0m01:25:26.832629 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0"
[0m01:25:26.833021 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select OPEN
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where OPEN is null



      
    ) dbt_internal_test
[0m01:25:26.833337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:27.314778 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.481 seconds
[0m01:25:27.318588 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0: Close
[0m01:25:27.496740 [info ] [Thread-1 (]: 5 of 9 PASS not_null_lab1_stock_price_table_OPEN ............................... [[32mPASS[0m in 0.68s]
[0m01:25:27.497144 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0
[0m01:25:27.497348 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c
[0m01:25:27.497579 [info ] [Thread-1 (]: 6 of 9 START test not_null_lab1_stock_price_table_SYMBOL ....................... [RUN]
[0m01:25:27.497850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0, now test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c)
[0m01:25:27.498033 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c
[0m01:25:27.500050 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c"
[0m01:25:27.500462 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c
[0m01:25:27.501466 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c"
[0m01:25:27.501914 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c"
[0m01:25:27.502090 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SYMBOL
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where SYMBOL is null



      
    ) dbt_internal_test
[0m01:25:27.502256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:27.912816 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.410 seconds
[0m01:25:27.916359 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c: Close
[0m01:25:28.083593 [info ] [Thread-1 (]: 6 of 9 PASS not_null_lab1_stock_price_table_SYMBOL ............................. [[32mPASS[0m in 0.59s]
[0m01:25:28.084907 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c
[0m01:25:28.085280 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8
[0m01:25:28.085646 [info ] [Thread-1 (]: 7 of 9 START test not_null_lab1_stock_price_table_VOLUME ....................... [RUN]
[0m01:25:28.086164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c, now test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8)
[0m01:25:28.086514 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8
[0m01:25:28.089964 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8"
[0m01:25:28.090701 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8
[0m01:25:28.092236 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8"
[0m01:25:28.092902 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8"
[0m01:25:28.093141 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VOLUME
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where VOLUME is null



      
    ) dbt_internal_test
[0m01:25:28.093361 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:28.531889 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.438 seconds
[0m01:25:28.535551 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8: Close
[0m01:25:28.713347 [info ] [Thread-1 (]: 7 of 9 PASS not_null_lab1_stock_price_table_VOLUME ............................. [[32mPASS[0m in 0.63s]
[0m01:25:28.714558 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8
[0m01:25:28.715158 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_price_gap_filtered_PRICE_GAP.d1505a9ff6
[0m01:25:28.715665 [info ] [Thread-1 (]: 8 of 9 START test not_null_price_gap_filtered_PRICE_GAP ........................ [RUN]
[0m01:25:28.716264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8, now test.stock_elt_project.not_null_price_gap_filtered_PRICE_GAP.d1505a9ff6)
[0m01:25:28.716736 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_price_gap_filtered_PRICE_GAP.d1505a9ff6
[0m01:25:28.722685 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_price_gap_filtered_PRICE_GAP.d1505a9ff6"
[0m01:25:28.724116 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_price_gap_filtered_PRICE_GAP.d1505a9ff6
[0m01:25:28.726384 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_price_gap_filtered_PRICE_GAP.d1505a9ff6"
[0m01:25:28.727973 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_price_gap_filtered_PRICE_GAP.d1505a9ff6"
[0m01:25:28.728343 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_price_gap_filtered_PRICE_GAP.d1505a9ff6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_price_gap_filtered_PRICE_GAP.d1505a9ff6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select PRICE_GAP
from USER_DB_CATFISH.analytics.price_gap_filtered
where PRICE_GAP is null



      
    ) dbt_internal_test
[0m01:25:28.728661 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:29.338973 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.610 seconds
[0m01:25:29.343482 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_price_gap_filtered_PRICE_GAP.d1505a9ff6: Close
[0m01:25:29.503159 [info ] [Thread-1 (]: 8 of 9 PASS not_null_price_gap_filtered_PRICE_GAP .............................. [[32mPASS[0m in 0.79s]
[0m01:25:29.503966 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_price_gap_filtered_PRICE_GAP.d1505a9ff6
[0m01:25:29.504396 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_rolling_avg_filtered_ROLLING_AVERAGE.4bec977fbe
[0m01:25:29.504862 [info ] [Thread-1 (]: 9 of 9 START test not_null_rolling_avg_filtered_ROLLING_AVERAGE ................ [RUN]
[0m01:25:29.505443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_price_gap_filtered_PRICE_GAP.d1505a9ff6, now test.stock_elt_project.not_null_rolling_avg_filtered_ROLLING_AVERAGE.4bec977fbe)
[0m01:25:29.505840 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_rolling_avg_filtered_ROLLING_AVERAGE.4bec977fbe
[0m01:25:29.510040 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_rolling_avg_filtered_ROLLING_AVERAGE.4bec977fbe"
[0m01:25:29.510919 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_rolling_avg_filtered_ROLLING_AVERAGE.4bec977fbe
[0m01:25:29.512655 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_rolling_avg_filtered_ROLLING_AVERAGE.4bec977fbe"
[0m01:25:29.513437 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_rolling_avg_filtered_ROLLING_AVERAGE.4bec977fbe"
[0m01:25:29.513764 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_rolling_avg_filtered_ROLLING_AVERAGE.4bec977fbe: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_rolling_avg_filtered_ROLLING_AVERAGE.4bec977fbe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ROLLING_AVERAGE
from USER_DB_CATFISH.analytics.rolling_avg_filtered
where ROLLING_AVERAGE is null



      
    ) dbt_internal_test
[0m01:25:29.514119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:30.086144 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.572 seconds
[0m01:25:30.090505 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_rolling_avg_filtered_ROLLING_AVERAGE.4bec977fbe: Close
[0m01:25:30.251095 [info ] [Thread-1 (]: 9 of 9 PASS not_null_rolling_avg_filtered_ROLLING_AVERAGE ...................... [[32mPASS[0m in 0.75s]
[0m01:25:30.252222 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_rolling_avg_filtered_ROLLING_AVERAGE.4bec977fbe
[0m01:25:30.254388 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:25:30.254816 [debug] [MainThread]: Connection 'test.stock_elt_project.not_null_rolling_avg_filtered_ROLLING_AVERAGE.4bec977fbe' was properly closed.
[0m01:25:30.255230 [info ] [MainThread]: 
[0m01:25:30.255665 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 7.18 seconds (7.18s).
[0m01:25:30.257542 [debug] [MainThread]: Command end result
[0m01:25:30.284903 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/manifest.json
[0m01:25:30.286336 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/semantic_manifest.json
[0m01:25:30.290655 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/run_results.json
[0m01:25:30.290872 [info ] [MainThread]: 
[0m01:25:30.291087 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:25:30.291244 [info ] [MainThread]: 
[0m01:25:30.291404 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m01:25:30.292609 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 7.7444797, "process_in_blocks": "0", "process_kernel_time": 0.231047, "process_mem_max_rss": "146341888", "process_out_blocks": "0", "process_user_time": 1.524138}
[0m01:25:30.292885 [debug] [MainThread]: Command `dbt test` succeeded at 01:25:30.292832 after 7.74 seconds
[0m01:25:30.293096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1238cf890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125c7e620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125c7e0a0>]}
[0m01:25:30.293293 [debug] [MainThread]: Flushing usage events
[0m01:25:30.728795 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:31:09.144217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d797f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fc7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fc7ed0>]}


============================== 01:31:09.146932 | f44a0be7-aa9a-489e-8187-49ae6d3baa94 ==============================
[0m01:31:09.146932 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:31:09.147181 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:31:09.326769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f44a0be7-aa9a-489e-8187-49ae6d3baa94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108df4b00>]}
[0m01:31:09.345925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f44a0be7-aa9a-489e-8187-49ae6d3baa94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bf2cf0>]}
[0m01:31:09.346454 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m01:31:09.396485 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:31:09.458708 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:31:09.458887 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:31:09.480092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f44a0be7-aa9a-489e-8187-49ae6d3baa94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108be2250>]}
[0m01:31:09.543447 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/manifest.json
[0m01:31:09.544971 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/semantic_manifest.json
[0m01:31:09.555255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f44a0be7-aa9a-489e-8187-49ae6d3baa94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dff6b0>]}
[0m01:31:09.555459 [info ] [MainThread]: Found 5 models, 1 snapshot, 9 data tests, 2 sources, 462 macros
[0m01:31:09.555592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f44a0be7-aa9a-489e-8187-49ae6d3baa94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d78f30>]}
[0m01:31:09.556327 [info ] [MainThread]: 
[0m01:31:09.556460 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:31:09.556568 [info ] [MainThread]: 
[0m01:31:09.556752 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:31:09.558411 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH'
[0m01:31:09.563766 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH"
[0m01:31:09.563918 [debug] [ThreadPool]: On list_USER_DB_CATFISH: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH"} */
show terse schemas in database USER_DB_CATFISH
    limit 10000
[0m01:31:09.564029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:31:10.030286 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.466 seconds
[0m01:31:10.033025 [debug] [ThreadPool]: On list_USER_DB_CATFISH: Close
[0m01:31:10.195698 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH, now list_USER_DB_CATFISH_analytics)
[0m01:31:10.207618 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_analytics"
[0m01:31:10.208151 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_analytics"} */
show terse objects in USER_DB_CATFISH.analytics limit 10000
[0m01:31:10.208470 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:31:10.685049 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.476 seconds
[0m01:31:10.687967 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: Close
[0m01:31:10.846386 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_analytics, now list_USER_DB_CATFISH_snapshot)
[0m01:31:10.849666 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_snapshot"
[0m01:31:10.850006 [debug] [ThreadPool]: On list_USER_DB_CATFISH_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_snapshot"} */
show terse objects in USER_DB_CATFISH.snapshot limit 10000
[0m01:31:10.850263 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:31:11.476070 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.626 seconds
[0m01:31:11.479426 [debug] [ThreadPool]: On list_USER_DB_CATFISH_snapshot: Close
[0m01:31:11.748618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f44a0be7-aa9a-489e-8187-49ae6d3baa94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109468e20>]}
[0m01:31:11.753434 [debug] [Thread-1 (]: Began running node model.stock_elt_project.lab1_stock_price_table
[0m01:31:11.754266 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.lab1_stock_price_table ................... [RUN]
[0m01:31:11.754821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_snapshot, now model.stock_elt_project.lab1_stock_price_table)
[0m01:31:11.755215 [debug] [Thread-1 (]: Began compiling node model.stock_elt_project.lab1_stock_price_table
[0m01:31:11.764964 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt_project.lab1_stock_price_table"
[0m01:31:11.766045 [debug] [Thread-1 (]: Began executing node model.stock_elt_project.lab1_stock_price_table
[0m01:31:11.787541 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_elt_project.lab1_stock_price_table"
[0m01:31:11.788480 [debug] [Thread-1 (]: Using snowflake connection "model.stock_elt_project.lab1_stock_price_table"
[0m01:31:11.788747 [debug] [Thread-1 (]: On model.stock_elt_project.lab1_stock_price_table: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_elt_project.lab1_stock_price_table"} */
create or replace   view USER_DB_CATFISH.analytics.lab1_stock_price_table
  
   as (
    SELECT *
FROM USER_DB_CATFISH.raw.raw_stock_data
  );
[0m01:31:11.788949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:31:12.431377 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.642 seconds
[0m01:31:12.451740 [debug] [Thread-1 (]: On model.stock_elt_project.lab1_stock_price_table: Close
[0m01:31:12.622265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f44a0be7-aa9a-489e-8187-49ae6d3baa94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10946d490>]}
[0m01:31:12.623514 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.lab1_stock_price_table .............. [[32mSUCCESS 1[0m in 0.86s]
[0m01:31:12.624412 [debug] [Thread-1 (]: Finished running node model.stock_elt_project.lab1_stock_price_table
[0m01:31:12.625701 [debug] [Thread-1 (]: Began running node model.stock_elt_project.price_gap_calc
[0m01:31:12.626289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt_project.lab1_stock_price_table, now model.stock_elt_project.price_gap_calc)
[0m01:31:12.626693 [debug] [Thread-1 (]: Began compiling node model.stock_elt_project.price_gap_calc
[0m01:31:12.629893 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt_project.price_gap_calc"
[0m01:31:12.631108 [debug] [Thread-1 (]: Finished running node model.stock_elt_project.price_gap_calc
[0m01:31:12.631522 [debug] [Thread-1 (]: Began running node model.stock_elt_project.rolling_average_calc
[0m01:31:12.631960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt_project.price_gap_calc, now model.stock_elt_project.rolling_average_calc)
[0m01:31:12.632368 [debug] [Thread-1 (]: Began compiling node model.stock_elt_project.rolling_average_calc
[0m01:31:12.635407 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt_project.rolling_average_calc"
[0m01:31:12.636226 [debug] [Thread-1 (]: Finished running node model.stock_elt_project.rolling_average_calc
[0m01:31:12.636560 [debug] [Thread-1 (]: Began running node model.stock_elt_project.price_gap_filtered
[0m01:31:12.636975 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.price_gap_filtered ...................... [RUN]
[0m01:31:12.637310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt_project.rolling_average_calc, now model.stock_elt_project.price_gap_filtered)
[0m01:31:12.637554 [debug] [Thread-1 (]: Began compiling node model.stock_elt_project.price_gap_filtered
[0m01:31:12.640211 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt_project.price_gap_filtered"
[0m01:31:12.640695 [debug] [Thread-1 (]: Began executing node model.stock_elt_project.price_gap_filtered
[0m01:31:12.656017 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_elt_project.price_gap_filtered"
[0m01:31:12.656955 [debug] [Thread-1 (]: Using snowflake connection "model.stock_elt_project.price_gap_filtered"
[0m01:31:12.657193 [debug] [Thread-1 (]: On model.stock_elt_project.price_gap_filtered: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_elt_project.price_gap_filtered"} */
create or replace transient table USER_DB_CATFISH.analytics.price_gap_filtered
         as
        (with __dbt__cte__price_gap_calc as (
SELECT SYMBOL,
        DT AS DATE,
        OPEN,
        LAG(CLOSE, 1) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DT) as LAST_CLOSING
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
ORDER BY SYMBOL, DATE
) SELECT *,
       (OPEN - LAST_CLOSING) AS PRICE_GAP
FROM __dbt__cte__price_gap_calc
WHERE LAST_CLOSING IS NOT NULL
        );
[0m01:31:12.657402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:31:13.843084 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.186 seconds
[0m01:31:13.845567 [debug] [Thread-1 (]: On model.stock_elt_project.price_gap_filtered: Close
[0m01:31:14.003177 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f44a0be7-aa9a-489e-8187-49ae6d3baa94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109731700>]}
[0m01:31:14.004218 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.price_gap_filtered ................. [[32mSUCCESS 1[0m in 1.37s]
[0m01:31:14.004828 [debug] [Thread-1 (]: Finished running node model.stock_elt_project.price_gap_filtered
[0m01:31:14.005236 [debug] [Thread-1 (]: Began running node model.stock_elt_project.rolling_avg_filtered
[0m01:31:14.005747 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.rolling_avg_filtered .................... [RUN]
[0m01:31:14.006229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt_project.price_gap_filtered, now model.stock_elt_project.rolling_avg_filtered)
[0m01:31:14.006612 [debug] [Thread-1 (]: Began compiling node model.stock_elt_project.rolling_avg_filtered
[0m01:31:14.010800 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt_project.rolling_avg_filtered"
[0m01:31:14.011610 [debug] [Thread-1 (]: Began executing node model.stock_elt_project.rolling_avg_filtered
[0m01:31:14.014248 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_elt_project.rolling_avg_filtered"
[0m01:31:14.015559 [debug] [Thread-1 (]: Using snowflake connection "model.stock_elt_project.rolling_avg_filtered"
[0m01:31:14.015931 [debug] [Thread-1 (]: On model.stock_elt_project.rolling_avg_filtered: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_elt_project.rolling_avg_filtered"} */
create or replace transient table USER_DB_CATFISH.analytics.rolling_avg_filtered
         as
        (with __dbt__cte__rolling_average_calc as (


SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
) SELECT SYMBOL,
       DATE,
       ROLLING_AVERAGE
FROM __dbt__cte__rolling_average_calc
WHERE row_num >= 7
ORDER BY SYMBOL, DATE, row_num
        );
[0m01:31:14.016276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:31:15.286076 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.269 seconds
[0m01:31:15.290103 [debug] [Thread-1 (]: On model.stock_elt_project.rolling_avg_filtered: Close
[0m01:31:15.453410 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f44a0be7-aa9a-489e-8187-49ae6d3baa94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094d63f0>]}
[0m01:31:15.454823 [info ] [Thread-1 (]: 3 of 3 OK created sql table model analytics.rolling_avg_filtered ............... [[32mSUCCESS 1[0m in 1.45s]
[0m01:31:15.456230 [debug] [Thread-1 (]: Finished running node model.stock_elt_project.rolling_avg_filtered
[0m01:31:15.458869 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:31:15.459406 [debug] [MainThread]: Connection 'model.stock_elt_project.rolling_avg_filtered' was properly closed.
[0m01:31:15.459874 [info ] [MainThread]: 
[0m01:31:15.460309 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 5.90 seconds (5.90s).
[0m01:31:15.461708 [debug] [MainThread]: Command end result
[0m01:31:15.485759 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/manifest.json
[0m01:31:15.486958 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/semantic_manifest.json
[0m01:31:15.491562 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/run_results.json
[0m01:31:15.491808 [info ] [MainThread]: 
[0m01:31:15.492024 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:31:15.492186 [info ] [MainThread]: 
[0m01:31:15.492357 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m01:31:15.493589 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.3786373, "process_in_blocks": "0", "process_kernel_time": 0.191705, "process_mem_max_rss": "141279232", "process_out_blocks": "0", "process_user_time": 1.2109}
[0m01:31:15.493814 [debug] [MainThread]: Command `dbt run` succeeded at 01:31:15.493765 after 6.38 seconds
[0m01:31:15.494013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dd3dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f5e9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10802d470>]}
[0m01:31:15.494215 [debug] [MainThread]: Flushing usage events
[0m01:31:15.924227 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:34:19.976446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11027d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114c7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114c7ed0>]}


============================== 01:34:19.979269 | 997edd01-b0fa-4fc6-8e43-f3aa122a3f85 ==============================
[0m01:34:19.979269 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:34:19.979532 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt', 'log_path': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:34:20.168630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '997edd01-b0fa-4fc6-8e43-f3aa122a3f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112380b00>]}
[0m01:34:20.187725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '997edd01-b0fa-4fc6-8e43-f3aa122a3f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ff2cf0>]}
[0m01:34:20.188334 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m01:34:20.236736 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:34:20.299779 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:34:20.299951 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:34:20.320909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '997edd01-b0fa-4fc6-8e43-f3aa122a3f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fe2250>]}
[0m01:34:20.393252 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/manifest.json
[0m01:34:20.394720 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/semantic_manifest.json
[0m01:34:20.405816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '997edd01-b0fa-4fc6-8e43-f3aa122a3f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123776b0>]}
[0m01:34:20.406061 [info ] [MainThread]: Found 5 models, 1 snapshot, 9 data tests, 2 sources, 462 macros
[0m01:34:20.406240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '997edd01-b0fa-4fc6-8e43-f3aa122a3f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112304f30>]}
[0m01:34:20.407110 [info ] [MainThread]: 
[0m01:34:20.407280 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:34:20.407399 [info ] [MainThread]: 
[0m01:34:20.407596 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:34:20.409231 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH'
[0m01:34:20.414935 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH"
[0m01:34:20.415095 [debug] [ThreadPool]: On list_USER_DB_CATFISH: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH"} */
show terse schemas in database USER_DB_CATFISH
    limit 10000
[0m01:34:20.415206 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:34:21.024042 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.609 seconds
[0m01:34:21.027178 [debug] [ThreadPool]: On list_USER_DB_CATFISH: Close
[0m01:34:21.305524 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH, now list_USER_DB_CATFISH_snapshot)
[0m01:34:21.317741 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_snapshot"
[0m01:34:21.318300 [debug] [ThreadPool]: On list_USER_DB_CATFISH_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_snapshot"} */
show terse objects in USER_DB_CATFISH.snapshot limit 10000
[0m01:34:21.318617 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:34:21.792988 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.474 seconds
[0m01:34:21.796660 [debug] [ThreadPool]: On list_USER_DB_CATFISH_snapshot: Close
[0m01:34:21.966677 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_snapshot, now list_USER_DB_CATFISH_analytics)
[0m01:34:21.970318 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_analytics"
[0m01:34:21.970767 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_analytics"} */
show terse objects in USER_DB_CATFISH.analytics limit 10000
[0m01:34:21.971137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:34:22.415122 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.444 seconds
[0m01:34:22.418416 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: Close
[0m01:34:22.597028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '997edd01-b0fa-4fc6-8e43-f3aa122a3f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11286bba0>]}
[0m01:34:22.600936 [debug] [Thread-1 (]: Began running node model.stock_elt_project.lab1_stock_price_table
[0m01:34:22.601495 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.lab1_stock_price_table ................... [RUN]
[0m01:34:22.601914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_analytics, now model.stock_elt_project.lab1_stock_price_table)
[0m01:34:22.602227 [debug] [Thread-1 (]: Began compiling node model.stock_elt_project.lab1_stock_price_table
[0m01:34:22.609198 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt_project.lab1_stock_price_table"
[0m01:34:22.609987 [debug] [Thread-1 (]: Began executing node model.stock_elt_project.lab1_stock_price_table
[0m01:34:22.631923 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_elt_project.lab1_stock_price_table"
[0m01:34:22.632730 [debug] [Thread-1 (]: Using snowflake connection "model.stock_elt_project.lab1_stock_price_table"
[0m01:34:22.632967 [debug] [Thread-1 (]: On model.stock_elt_project.lab1_stock_price_table: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_elt_project.lab1_stock_price_table"} */
create or replace   view USER_DB_CATFISH.analytics.lab1_stock_price_table
  
   as (
    SELECT *
FROM USER_DB_CATFISH.raw.raw_stock_data
  );
[0m01:34:22.633162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:34:23.363381 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.730 seconds
[0m01:34:23.400479 [debug] [Thread-1 (]: On model.stock_elt_project.lab1_stock_price_table: Close
[0m01:34:23.580222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '997edd01-b0fa-4fc6-8e43-f3aa122a3f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11286d490>]}
[0m01:34:23.580671 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.lab1_stock_price_table .............. [[32mSUCCESS 1[0m in 0.98s]
[0m01:34:23.580923 [debug] [Thread-1 (]: Finished running node model.stock_elt_project.lab1_stock_price_table
[0m01:34:23.581278 [debug] [Thread-1 (]: Began running node model.stock_elt_project.price_gap_calc
[0m01:34:23.581518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt_project.lab1_stock_price_table, now model.stock_elt_project.price_gap_calc)
[0m01:34:23.581692 [debug] [Thread-1 (]: Began compiling node model.stock_elt_project.price_gap_calc
[0m01:34:23.582717 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt_project.price_gap_calc"
[0m01:34:23.583120 [debug] [Thread-1 (]: Finished running node model.stock_elt_project.price_gap_calc
[0m01:34:23.583271 [debug] [Thread-1 (]: Began running node model.stock_elt_project.rolling_average_calc
[0m01:34:23.583481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt_project.price_gap_calc, now model.stock_elt_project.rolling_average_calc)
[0m01:34:23.583695 [debug] [Thread-1 (]: Began compiling node model.stock_elt_project.rolling_average_calc
[0m01:34:23.585009 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt_project.rolling_average_calc"
[0m01:34:23.585318 [debug] [Thread-1 (]: Finished running node model.stock_elt_project.rolling_average_calc
[0m01:34:23.585448 [debug] [Thread-1 (]: Began running node model.stock_elt_project.price_gap_filtered
[0m01:34:23.585663 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.price_gap_filtered ...................... [RUN]
[0m01:34:23.585848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt_project.rolling_average_calc, now model.stock_elt_project.price_gap_filtered)
[0m01:34:23.585982 [debug] [Thread-1 (]: Began compiling node model.stock_elt_project.price_gap_filtered
[0m01:34:23.587294 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt_project.price_gap_filtered"
[0m01:34:23.587548 [debug] [Thread-1 (]: Began executing node model.stock_elt_project.price_gap_filtered
[0m01:34:23.597551 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_elt_project.price_gap_filtered"
[0m01:34:23.598212 [debug] [Thread-1 (]: Using snowflake connection "model.stock_elt_project.price_gap_filtered"
[0m01:34:23.598362 [debug] [Thread-1 (]: On model.stock_elt_project.price_gap_filtered: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_elt_project.price_gap_filtered"} */
create or replace transient table USER_DB_CATFISH.analytics.price_gap_filtered
         as
        (with __dbt__cte__price_gap_calc as (
SELECT SYMBOL,
        DT AS DATE,
        OPEN,
        LAG(CLOSE, 1) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DT) as LAST_CLOSING
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
ORDER BY SYMBOL, DATE
) SELECT *,
       (OPEN - LAST_CLOSING) AS PRICE_GAP
FROM __dbt__cte__price_gap_calc
WHERE LAST_CLOSING IS NOT NULL
        );
[0m01:34:23.598490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:34:24.919404 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.321 seconds
[0m01:34:24.924117 [debug] [Thread-1 (]: On model.stock_elt_project.price_gap_filtered: Close
[0m01:34:25.081130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '997edd01-b0fa-4fc6-8e43-f3aa122a3f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c31700>]}
[0m01:34:25.082718 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.price_gap_filtered ................. [[32mSUCCESS 1[0m in 1.49s]
[0m01:34:25.083696 [debug] [Thread-1 (]: Finished running node model.stock_elt_project.price_gap_filtered
[0m01:34:25.084272 [debug] [Thread-1 (]: Began running node model.stock_elt_project.rolling_avg_filtered
[0m01:34:25.084895 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.rolling_avg_filtered .................... [RUN]
[0m01:34:25.085526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_elt_project.price_gap_filtered, now model.stock_elt_project.rolling_avg_filtered)
[0m01:34:25.085981 [debug] [Thread-1 (]: Began compiling node model.stock_elt_project.rolling_avg_filtered
[0m01:34:25.091919 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_elt_project.rolling_avg_filtered"
[0m01:34:25.092971 [debug] [Thread-1 (]: Began executing node model.stock_elt_project.rolling_avg_filtered
[0m01:34:25.095357 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_elt_project.rolling_avg_filtered"
[0m01:34:25.096617 [debug] [Thread-1 (]: Using snowflake connection "model.stock_elt_project.rolling_avg_filtered"
[0m01:34:25.096978 [debug] [Thread-1 (]: On model.stock_elt_project.rolling_avg_filtered: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_elt_project.rolling_avg_filtered"} */
create or replace transient table USER_DB_CATFISH.analytics.rolling_avg_filtered
         as
        (with __dbt__cte__rolling_average_calc as (


SELECT SYMBOL,
       DT AS "DATE",
       CLOSE,
       ROW_NUMBER() OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE) AS row_num,
       ROUND(AVG(CLOSE) OVER (PARTITION BY SYMBOL ORDER BY SYMBOL, DATE ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ROLLING_AVERAGE
FROM USER_DB_CATFISH.analytics.lab1_stock_price_table
) SELECT SYMBOL,
       DATE,
       ROLLING_AVERAGE
FROM __dbt__cte__rolling_average_calc
WHERE row_num >= 7
ORDER BY SYMBOL, DATE, row_num
        );
[0m01:34:25.097305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:34:26.333757 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.236 seconds
[0m01:34:26.338105 [debug] [Thread-1 (]: On model.stock_elt_project.rolling_avg_filtered: Close
[0m01:34:26.499503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '997edd01-b0fa-4fc6-8e43-f3aa122a3f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128d63f0>]}
[0m01:34:26.500882 [info ] [Thread-1 (]: 3 of 3 OK created sql table model analytics.rolling_avg_filtered ............... [[32mSUCCESS 1[0m in 1.41s]
[0m01:34:26.501756 [debug] [Thread-1 (]: Finished running node model.stock_elt_project.rolling_avg_filtered
[0m01:34:26.503839 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:34:26.504196 [debug] [MainThread]: Connection 'model.stock_elt_project.rolling_avg_filtered' was properly closed.
[0m01:34:26.504630 [info ] [MainThread]: 
[0m01:34:26.505040 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 6.10 seconds (6.10s).
[0m01:34:26.506252 [debug] [MainThread]: Command end result
[0m01:34:26.533254 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/manifest.json
[0m01:34:26.534673 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/semantic_manifest.json
[0m01:34:26.538285 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/run_results.json
[0m01:34:26.538472 [info ] [MainThread]: 
[0m01:34:26.538671 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:34:26.538825 [info ] [MainThread]: 
[0m01:34:26.538990 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m01:34:26.540257 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.5931606, "process_in_blocks": "0", "process_kernel_time": 0.2034, "process_mem_max_rss": "142393344", "process_out_blocks": "0", "process_user_time": 1.190486}
[0m01:34:26.540530 [debug] [MainThread]: Command `dbt run` succeeded at 01:34:26.540472 after 6.59 seconds
[0m01:34:26.540742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112363dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112366bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11152d470>]}
[0m01:34:26.540946 [debug] [MainThread]: Flushing usage events
[0m01:34:26.975166 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:37:45.256134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10557d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c7ed0>]}


============================== 01:37:45.258958 | e77962b7-5a6c-4bab-9f22-b7ee5fad82b2 ==============================
[0m01:37:45.258958 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:37:45.259208 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m01:37:45.455475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e77962b7-5a6c-4bab-9f22-b7ee5fad82b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075f0b00>]}
[0m01:37:45.474877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e77962b7-5a6c-4bab-9f22-b7ee5fad82b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073f2cf0>]}
[0m01:37:45.475489 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m01:37:45.525735 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:37:45.588577 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:37:45.588756 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:37:45.609913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e77962b7-5a6c-4bab-9f22-b7ee5fad82b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073e2250>]}
[0m01:37:45.673519 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/manifest.json
[0m01:37:45.675078 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/semantic_manifest.json
[0m01:37:45.692943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e77962b7-5a6c-4bab-9f22-b7ee5fad82b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d39a90>]}
[0m01:37:45.693164 [info ] [MainThread]: Found 5 models, 1 snapshot, 9 data tests, 2 sources, 462 macros
[0m01:37:45.693301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e77962b7-5a6c-4bab-9f22-b7ee5fad82b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c01630>]}
[0m01:37:45.694112 [info ] [MainThread]: 
[0m01:37:45.694250 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:37:45.694355 [info ] [MainThread]: 
[0m01:37:45.694544 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:37:45.696169 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH_snapshot'
[0m01:37:45.702615 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_snapshot"
[0m01:37:45.702813 [debug] [ThreadPool]: On list_USER_DB_CATFISH_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_snapshot"} */
show terse objects in USER_DB_CATFISH.snapshot limit 10000
[0m01:37:45.702933 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:37:46.323423 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.620 seconds
[0m01:37:46.326976 [debug] [ThreadPool]: On list_USER_DB_CATFISH_snapshot: Close
[0m01:37:46.496787 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_snapshot, now list_USER_DB_CATFISH_analytics)
[0m01:37:46.500675 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_analytics"
[0m01:37:46.501157 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_analytics"} */
show terse objects in USER_DB_CATFISH.analytics limit 10000
[0m01:37:46.501504 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:37:47.038161 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.537 seconds
[0m01:37:47.039887 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: Close
[0m01:37:47.190779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e77962b7-5a6c-4bab-9f22-b7ee5fad82b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d77d40>]}
[0m01:37:47.196521 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950
[0m01:37:47.197077 [info ] [Thread-1 (]: 1 of 9 START test not_null_lab1_stock_price_table_CLOSE ........................ [RUN]
[0m01:37:47.197638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_analytics, now test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950)
[0m01:37:47.198025 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950
[0m01:37:47.214263 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950"
[0m01:37:47.214992 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950
[0m01:37:47.227468 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950"
[0m01:37:47.228101 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950"
[0m01:37:47.228339 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select CLOSE
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where CLOSE is null



      
    ) dbt_internal_test
[0m01:37:47.228543 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:37:47.756374 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.527 seconds
[0m01:37:47.770272 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950: Close
[0m01:37:47.953503 [info ] [Thread-1 (]: 1 of 9 PASS not_null_lab1_stock_price_table_CLOSE .............................. [[32mPASS[0m in 0.76s]
[0m01:37:47.954428 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950
[0m01:37:47.954870 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7
[0m01:37:47.955361 [info ] [Thread-1 (]: 2 of 9 START test not_null_lab1_stock_price_table_DT ........................... [RUN]
[0m01:37:47.955909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_lab1_stock_price_table_CLOSE.47e70d6950, now test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7)
[0m01:37:47.956296 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7
[0m01:37:47.960779 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7"
[0m01:37:47.961610 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7
[0m01:37:47.964714 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7"
[0m01:37:47.966219 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7"
[0m01:37:47.966493 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DT
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where DT is null



      
    ) dbt_internal_test
[0m01:37:47.966646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:37:48.494766 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.528 seconds
[0m01:37:48.497104 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7: Close
[0m01:37:48.645122 [info ] [Thread-1 (]: 2 of 9 PASS not_null_lab1_stock_price_table_DT ................................. [[32mPASS[0m in 0.69s]
[0m01:37:48.645956 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7
[0m01:37:48.646393 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d
[0m01:37:48.646877 [info ] [Thread-1 (]: 3 of 9 START test not_null_lab1_stock_price_table_HIGH ......................... [RUN]
[0m01:37:48.647384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_lab1_stock_price_table_DT.aeb1d0cef7, now test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d)
[0m01:37:48.647774 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d
[0m01:37:48.652556 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d"
[0m01:37:48.653586 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d
[0m01:37:48.656808 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d"
[0m01:37:48.658167 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d"
[0m01:37:48.658610 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select HIGH
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where HIGH is null



      
    ) dbt_internal_test
[0m01:37:48.658857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:37:49.167279 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.508 seconds
[0m01:37:49.171471 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d: Close
[0m01:37:49.329606 [info ] [Thread-1 (]: 3 of 9 PASS not_null_lab1_stock_price_table_HIGH ............................... [[32mPASS[0m in 0.68s]
[0m01:37:49.330769 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d
[0m01:37:49.331360 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8
[0m01:37:49.331905 [info ] [Thread-1 (]: 4 of 9 START test not_null_lab1_stock_price_table_LOW .......................... [RUN]
[0m01:37:49.332568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_lab1_stock_price_table_HIGH.cb03af757d, now test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8)
[0m01:37:49.333061 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8
[0m01:37:49.338806 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8"
[0m01:37:49.340170 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8
[0m01:37:49.349480 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8"
[0m01:37:49.350686 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8"
[0m01:37:49.351038 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select LOW
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where LOW is null



      
    ) dbt_internal_test
[0m01:37:49.351348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:37:49.826060 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.474 seconds
[0m01:37:49.830802 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8: Close
[0m01:37:49.985698 [info ] [Thread-1 (]: 4 of 9 PASS not_null_lab1_stock_price_table_LOW ................................ [[32mPASS[0m in 0.65s]
[0m01:37:49.986623 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8
[0m01:37:49.987111 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0
[0m01:37:49.987535 [info ] [Thread-1 (]: 5 of 9 START test not_null_lab1_stock_price_table_OPEN ......................... [RUN]
[0m01:37:49.988073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_lab1_stock_price_table_LOW.b17aee39b8, now test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0)
[0m01:37:49.988452 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0
[0m01:37:49.993369 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0"
[0m01:37:49.994309 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0
[0m01:37:49.996523 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0"
[0m01:37:49.997462 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0"
[0m01:37:49.997865 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select OPEN
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where OPEN is null



      
    ) dbt_internal_test
[0m01:37:49.998372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:37:50.416274 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.418 seconds
[0m01:37:50.421026 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0: Close
[0m01:37:50.574066 [info ] [Thread-1 (]: 5 of 9 PASS not_null_lab1_stock_price_table_OPEN ............................... [[32mPASS[0m in 0.59s]
[0m01:37:50.575224 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0
[0m01:37:50.575801 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c
[0m01:37:50.576322 [info ] [Thread-1 (]: 6 of 9 START test not_null_lab1_stock_price_table_SYMBOL ....................... [RUN]
[0m01:37:50.576989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_lab1_stock_price_table_OPEN.7e85f446a0, now test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c)
[0m01:37:50.577460 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c
[0m01:37:50.583295 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c"
[0m01:37:50.584590 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c
[0m01:37:50.587378 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c"
[0m01:37:50.588935 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c"
[0m01:37:50.589753 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SYMBOL
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where SYMBOL is null



      
    ) dbt_internal_test
[0m01:37:50.590236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:37:51.261584 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.671 seconds
[0m01:37:51.265164 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c: Close
[0m01:37:51.436890 [info ] [Thread-1 (]: 6 of 9 PASS not_null_lab1_stock_price_table_SYMBOL ............................. [[32mPASS[0m in 0.86s]
[0m01:37:51.438931 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c
[0m01:37:51.439511 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8
[0m01:37:51.439997 [info ] [Thread-1 (]: 7 of 9 START test not_null_lab1_stock_price_table_VOLUME ....................... [RUN]
[0m01:37:51.440530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_lab1_stock_price_table_SYMBOL.dd7a33a65c, now test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8)
[0m01:37:51.440935 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8
[0m01:37:51.446400 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8"
[0m01:37:51.447676 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8
[0m01:37:51.450302 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8"
[0m01:37:51.451893 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8"
[0m01:37:51.452357 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VOLUME
from USER_DB_CATFISH.analytics.lab1_stock_price_table
where VOLUME is null



      
    ) dbt_internal_test
[0m01:37:51.452734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:37:51.885585 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.433 seconds
[0m01:37:51.889603 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8: Close
[0m01:37:52.069497 [info ] [Thread-1 (]: 7 of 9 PASS not_null_lab1_stock_price_table_VOLUME ............................. [[32mPASS[0m in 0.63s]
[0m01:37:52.070985 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8
[0m01:37:52.071802 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_price_gap_filtered_PRICE_GAP.d1505a9ff6
[0m01:37:52.072331 [info ] [Thread-1 (]: 8 of 9 START test not_null_price_gap_filtered_PRICE_GAP ........................ [RUN]
[0m01:37:52.072983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_lab1_stock_price_table_VOLUME.9a3544d1d8, now test.stock_elt_project.not_null_price_gap_filtered_PRICE_GAP.d1505a9ff6)
[0m01:37:52.073510 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_price_gap_filtered_PRICE_GAP.d1505a9ff6
[0m01:37:52.080030 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_price_gap_filtered_PRICE_GAP.d1505a9ff6"
[0m01:37:52.081662 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_price_gap_filtered_PRICE_GAP.d1505a9ff6
[0m01:37:52.084455 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_price_gap_filtered_PRICE_GAP.d1505a9ff6"
[0m01:37:52.085623 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_price_gap_filtered_PRICE_GAP.d1505a9ff6"
[0m01:37:52.085976 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_price_gap_filtered_PRICE_GAP.d1505a9ff6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_price_gap_filtered_PRICE_GAP.d1505a9ff6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select PRICE_GAP
from USER_DB_CATFISH.analytics.price_gap_filtered
where PRICE_GAP is null



      
    ) dbt_internal_test
[0m01:37:52.086289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:37:52.774182 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.688 seconds
[0m01:37:52.778185 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_price_gap_filtered_PRICE_GAP.d1505a9ff6: Close
[0m01:37:52.928233 [info ] [Thread-1 (]: 8 of 9 PASS not_null_price_gap_filtered_PRICE_GAP .............................. [[32mPASS[0m in 0.86s]
[0m01:37:52.929238 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_price_gap_filtered_PRICE_GAP.d1505a9ff6
[0m01:37:52.929793 [debug] [Thread-1 (]: Began running node test.stock_elt_project.not_null_rolling_avg_filtered_ROLLING_AVERAGE.4bec977fbe
[0m01:37:52.930310 [info ] [Thread-1 (]: 9 of 9 START test not_null_rolling_avg_filtered_ROLLING_AVERAGE ................ [RUN]
[0m01:37:52.930940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_elt_project.not_null_price_gap_filtered_PRICE_GAP.d1505a9ff6, now test.stock_elt_project.not_null_rolling_avg_filtered_ROLLING_AVERAGE.4bec977fbe)
[0m01:37:52.931414 [debug] [Thread-1 (]: Began compiling node test.stock_elt_project.not_null_rolling_avg_filtered_ROLLING_AVERAGE.4bec977fbe
[0m01:37:52.937355 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_elt_project.not_null_rolling_avg_filtered_ROLLING_AVERAGE.4bec977fbe"
[0m01:37:52.938696 [debug] [Thread-1 (]: Began executing node test.stock_elt_project.not_null_rolling_avg_filtered_ROLLING_AVERAGE.4bec977fbe
[0m01:37:52.941489 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_elt_project.not_null_rolling_avg_filtered_ROLLING_AVERAGE.4bec977fbe"
[0m01:37:52.943024 [debug] [Thread-1 (]: Using snowflake connection "test.stock_elt_project.not_null_rolling_avg_filtered_ROLLING_AVERAGE.4bec977fbe"
[0m01:37:52.943479 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_rolling_avg_filtered_ROLLING_AVERAGE.4bec977fbe: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_elt_project.not_null_rolling_avg_filtered_ROLLING_AVERAGE.4bec977fbe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ROLLING_AVERAGE
from USER_DB_CATFISH.analytics.rolling_avg_filtered
where ROLLING_AVERAGE is null



      
    ) dbt_internal_test
[0m01:37:52.943825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:37:53.591566 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.648 seconds
[0m01:37:53.594003 [debug] [Thread-1 (]: On test.stock_elt_project.not_null_rolling_avg_filtered_ROLLING_AVERAGE.4bec977fbe: Close
[0m01:37:53.739595 [info ] [Thread-1 (]: 9 of 9 PASS not_null_rolling_avg_filtered_ROLLING_AVERAGE ...................... [[32mPASS[0m in 0.81s]
[0m01:37:53.740416 [debug] [Thread-1 (]: Finished running node test.stock_elt_project.not_null_rolling_avg_filtered_ROLLING_AVERAGE.4bec977fbe
[0m01:37:53.741572 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:37:53.741934 [debug] [MainThread]: Connection 'test.stock_elt_project.not_null_rolling_avg_filtered_ROLLING_AVERAGE.4bec977fbe' was properly closed.
[0m01:37:53.742277 [info ] [MainThread]: 
[0m01:37:53.742613 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 8.05 seconds (8.05s).
[0m01:37:53.744472 [debug] [MainThread]: Command end result
[0m01:37:53.759160 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/manifest.json
[0m01:37:53.760008 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/semantic_manifest.json
[0m01:37:53.762906 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/run_results.json
[0m01:37:53.763045 [info ] [MainThread]: 
[0m01:37:53.763191 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:37:53.763301 [info ] [MainThread]: 
[0m01:37:53.763421 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m01:37:53.764270 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 8.536719, "process_in_blocks": "0", "process_kernel_time": 0.234434, "process_mem_max_rss": "144998400", "process_out_blocks": "0", "process_user_time": 1.574355}
[0m01:37:53.764425 [debug] [MainThread]: Command `dbt test` succeeded at 01:37:53.764394 after 8.54 seconds
[0m01:37:53.764574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064cf890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c08680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c092e0>]}
[0m01:37:53.764713 [debug] [MainThread]: Flushing usage events
[0m01:37:54.196061 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:45:08.310681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11287d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bc7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bc7ed0>]}


============================== 01:45:08.313433 | 3a7a6bd9-82ec-4739-8adb-f964fdc19d5e ==============================
[0m01:45:08.313433 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:45:08.313685 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:45:08.508894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a7a6bd9-82ec-4739-8adb-f964fdc19d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115370b00>]}
[0m01:45:08.528449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a7a6bd9-82ec-4739-8adb-f964fdc19d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ff2cf0>]}
[0m01:45:08.529058 [info ] [MainThread]: Registered adapter: snowflake=1.8.0
[0m01:45:08.580478 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:45:08.662658 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:45:08.662873 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:45:08.684908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a7a6bd9-82ec-4739-8adb-f964fdc19d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114fe2250>]}
[0m01:45:08.751105 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/manifest.json
[0m01:45:08.752475 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/semantic_manifest.json
[0m01:45:08.763601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a7a6bd9-82ec-4739-8adb-f964fdc19d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11538b6b0>]}
[0m01:45:08.763808 [info ] [MainThread]: Found 5 models, 1 snapshot, 9 data tests, 2 sources, 462 macros
[0m01:45:08.763940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a7a6bd9-82ec-4739-8adb-f964fdc19d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1153050f0>]}
[0m01:45:08.764649 [info ] [MainThread]: 
[0m01:45:08.764784 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:45:08.764886 [info ] [MainThread]: 
[0m01:45:08.765072 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:45:08.765406 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_CATFISH'
[0m01:45:08.770881 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH"
[0m01:45:08.771032 [debug] [ThreadPool]: On list_USER_DB_CATFISH: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH"} */
show terse schemas in database USER_DB_CATFISH
    limit 10000
[0m01:45:08.771138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:45:09.306395 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.535 seconds
[0m01:45:09.309524 [debug] [ThreadPool]: On list_USER_DB_CATFISH: Close
[0m01:45:09.480021 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH, now list_USER_DB_CATFISH_snapshot)
[0m01:45:09.485804 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_snapshot"
[0m01:45:09.486060 [debug] [ThreadPool]: On list_USER_DB_CATFISH_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_snapshot"} */
show terse objects in USER_DB_CATFISH.snapshot limit 10000
[0m01:45:09.486197 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:45:09.920049 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.434 seconds
[0m01:45:09.923415 [debug] [ThreadPool]: On list_USER_DB_CATFISH_snapshot: Close
[0m01:45:10.079793 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_snapshot, now list_USER_DB_CATFISH_analytics)
[0m01:45:10.085701 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_CATFISH_analytics"
[0m01:45:10.086517 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_USER_DB_CATFISH_analytics"} */
show terse objects in USER_DB_CATFISH.analytics limit 10000
[0m01:45:10.086960 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:45:10.547247 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.460 seconds
[0m01:45:10.548145 [debug] [ThreadPool]: On list_USER_DB_CATFISH_analytics: Close
[0m01:45:10.702689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a7a6bd9-82ec-4739-8adb-f964fdc19d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11576d160>]}
[0m01:45:10.705243 [debug] [Thread-1 (]: Began running node snapshot.stock_elt_project.snapshot_raw_stock_price
[0m01:45:10.705581 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_raw_stock_price ........................ [RUN]
[0m01:45:10.705845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_CATFISH_analytics, now snapshot.stock_elt_project.snapshot_raw_stock_price)
[0m01:45:10.706022 [debug] [Thread-1 (]: Began compiling node snapshot.stock_elt_project.snapshot_raw_stock_price
[0m01:45:10.710155 [debug] [Thread-1 (]: Began executing node snapshot.stock_elt_project.snapshot_raw_stock_price
[0m01:45:10.736175 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:45:10.736408 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
select * from (
        



SELECT * FROM USER_DB_CATFISH.analytics.lab1_stock_price_table

    ) as __dbt_sbq
    where false
    limit 0
[0m01:45:10.736544 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:45:11.158495 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.422 seconds
[0m01:45:11.169762 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:45:11.171234 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
describe table "USER_DB_CATFISH"."SNAPSHOT"."SNAPSHOT_RAW_STOCK_PRICE"
[0m01:45:11.315951 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.143 seconds
[0m01:45:11.325567 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:45:11.326060 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
describe table "USER_DB_CATFISH"."SNAPSHOT"."SNAPSHOT_RAW_STOCK_PRICE"
[0m01:45:11.446036 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.119 seconds
[0m01:45:11.494449 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:45:11.494907 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
create or replace temporary table "USER_DB_CATFISH"."SNAPSHOT"."SNAPSHOT_RAW_STOCK_PRICE__dbt_tmp"
         as
        (
    
    with snapshot_query as (

        



SELECT * FROM USER_DB_CATFISH.analytics.lab1_stock_price_table


    ),

    snapshotted_data as (

        select *, 
    
        
            SYMBOL as dbt_unique_key_1 ,
        
            DT as dbt_unique_key_2
        
    

        from "USER_DB_CATFISH"."SNAPSHOT"."SNAPSHOT_RAW_STOCK_PRICE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            SYMBOL as dbt_unique_key_1 ,
        
            DT as dbt_unique_key_2
        
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(SYMBOL as varchar ), '')
         || '|' || coalesce(cast(DT as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            SYMBOL as dbt_unique_key_1 ,
        
            DT as dbt_unique_key_2
        
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            SYMBOL as dbt_unique_key_1 ,
        
            DT as dbt_unique_key_2
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and ((snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."DT" != source_data."DT"
        or
        (
            ((snapshotted_data."DT" is null) and not (source_data."DT" is null))
            or
            ((not snapshotted_data."DT" is null) and (source_data."DT" is null))
        ) or snapshotted_data."OPEN" != source_data."OPEN"
        or
        (
            ((snapshotted_data."OPEN" is null) and not (source_data."OPEN" is null))
            or
            ((not snapshotted_data."OPEN" is null) and (source_data."OPEN" is null))
        ) or snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."HIGH" != source_data."HIGH"
        or
        (
            ((snapshotted_data."HIGH" is null) and not (source_data."HIGH" is null))
            or
            ((not snapshotted_data."HIGH" is null) and (source_data."HIGH" is null))
        ) or snapshotted_data."LOW" != source_data."LOW"
        or
        (
            ((snapshotted_data."LOW" is null) and not (source_data."LOW" is null))
            or
            ((not snapshotted_data."LOW" is null) and (source_data."LOW" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

        where (
            (snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."DT" != source_data."DT"
        or
        (
            ((snapshotted_data."DT" is null) and not (source_data."DT" is null))
            or
            ((not snapshotted_data."DT" is null) and (source_data."DT" is null))
        ) or snapshotted_data."OPEN" != source_data."OPEN"
        or
        (
            ((snapshotted_data."OPEN" is null) and not (source_data."OPEN" is null))
            or
            ((not snapshotted_data."OPEN" is null) and (source_data."OPEN" is null))
        ) or snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."HIGH" != source_data."HIGH"
        or
        (
            ((snapshotted_data."HIGH" is null) and not (source_data."HIGH" is null))
            or
            ((not snapshotted_data."HIGH" is null) and (source_data."HIGH" is null))
        ) or snapshotted_data."LOW" != source_data."LOW"
        or
        (
            ((snapshotted_data."LOW" is null) and not (source_data."LOW" is null))
            or
            ((not snapshotted_data."LOW" is null) and (source_data."LOW" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m01:45:12.281266 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.786 seconds
[0m01:45:12.285987 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:45:12.286613 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
describe table "USER_DB_CATFISH"."SNAPSHOT"."SNAPSHOT_RAW_STOCK_PRICE__dbt_tmp"
[0m01:45:12.411205 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.124 seconds
[0m01:45:12.423978 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:45:12.424808 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
describe table "USER_DB_CATFISH"."SNAPSHOT"."SNAPSHOT_RAW_STOCK_PRICE"
[0m01:45:12.551697 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.126 seconds
[0m01:45:12.557672 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:45:12.558311 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
describe table "USER_DB_CATFISH"."SNAPSHOT"."SNAPSHOT_RAW_STOCK_PRICE__dbt_tmp"
[0m01:45:12.658990 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.100 seconds
[0m01:45:12.664257 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:45:12.664802 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
describe table "USER_DB_CATFISH"."SNAPSHOT"."SNAPSHOT_RAW_STOCK_PRICE"
[0m01:45:12.764895 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.099 seconds
[0m01:45:12.776356 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:45:12.776892 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
describe table "USER_DB_CATFISH"."SNAPSHOT"."SNAPSHOT_RAW_STOCK_PRICE__dbt_tmp"
[0m01:45:12.896537 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.119 seconds
[0m01:45:12.905573 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:45:12.905888 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
select * from (
        
    
    with snapshot_query as (

        



SELECT * FROM USER_DB_CATFISH.analytics.lab1_stock_price_table


    ),

    snapshotted_data as (

        select *, 
    
        
            SYMBOL as dbt_unique_key_1 ,
        
            DT as dbt_unique_key_2
        
    

        from "USER_DB_CATFISH"."SNAPSHOT"."SNAPSHOT_RAW_STOCK_PRICE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            SYMBOL as dbt_unique_key_1 ,
        
            DT as dbt_unique_key_2
        
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(SYMBOL as varchar ), '')
         || '|' || coalesce(cast(DT as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            SYMBOL as dbt_unique_key_1 ,
        
            DT as dbt_unique_key_2
        
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            SYMBOL as dbt_unique_key_1 ,
        
            DT as dbt_unique_key_2
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and ((snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."DT" != source_data."DT"
        or
        (
            ((snapshotted_data."DT" is null) and not (source_data."DT" is null))
            or
            ((not snapshotted_data."DT" is null) and (source_data."DT" is null))
        ) or snapshotted_data."OPEN" != source_data."OPEN"
        or
        (
            ((snapshotted_data."OPEN" is null) and not (source_data."OPEN" is null))
            or
            ((not snapshotted_data."OPEN" is null) and (source_data."OPEN" is null))
        ) or snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."HIGH" != source_data."HIGH"
        or
        (
            ((snapshotted_data."HIGH" is null) and not (source_data."HIGH" is null))
            or
            ((not snapshotted_data."HIGH" is null) and (source_data."HIGH" is null))
        ) or snapshotted_data."LOW" != source_data."LOW"
        or
        (
            ((snapshotted_data."LOW" is null) and not (source_data."LOW" is null))
            or
            ((not snapshotted_data."LOW" is null) and (source_data."LOW" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

        where (
            (snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."DT" != source_data."DT"
        or
        (
            ((snapshotted_data."DT" is null) and not (source_data."DT" is null))
            or
            ((not snapshotted_data."DT" is null) and (source_data."DT" is null))
        ) or snapshotted_data."OPEN" != source_data."OPEN"
        or
        (
            ((snapshotted_data."OPEN" is null) and not (source_data."OPEN" is null))
            or
            ((not snapshotted_data."OPEN" is null) and (source_data."OPEN" is null))
        ) or snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."HIGH" != source_data."HIGH"
        or
        (
            ((snapshotted_data."HIGH" is null) and not (source_data."HIGH" is null))
            or
            ((not snapshotted_data."HIGH" is null) and (source_data."HIGH" is null))
        ) or snapshotted_data."LOW" != source_data."LOW"
        or
        (
            ((snapshotted_data."LOW" is null) and not (source_data."LOW" is null))
            or
            ((not snapshotted_data."LOW" is null) and (source_data."LOW" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m01:45:13.304531 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.398 seconds
[0m01:45:13.309993 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:45:13.310514 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m01:45:13.462313 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.151 seconds
[0m01:45:13.463957 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:45:13.467465 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:45:13.467966 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
BEGIN
[0m01:45:13.623129 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.155 seconds
[0m01:45:13.624052 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:45:13.624660 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
merge into "USER_DB_CATFISH"."SNAPSHOT"."SNAPSHOT_RAW_STOCK_PRICE" as DBT_INTERNAL_DEST
    using "USER_DB_CATFISH"."SNAPSHOT"."SNAPSHOT_RAW_STOCK_PRICE__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DT", "OPEN", "CLOSE", "HIGH", "LOW", "VOLUME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DT", "OPEN", "CLOSE", "HIGH", "LOW", "VOLUME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m01:45:14.122745 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.497 seconds
[0m01:45:14.123999 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_elt_project.snapshot_raw_stock_price"
[0m01:45:14.124500 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_elt_project.snapshot_raw_stock_price"} */
COMMIT
[0m01:45:14.530084 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.405 seconds
[0m01:45:14.541780 [debug] [Thread-1 (]: On snapshot.stock_elt_project.snapshot_raw_stock_price: Close
[0m01:45:14.706638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a7a6bd9-82ec-4739-8adb-f964fdc19d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11572dc10>]}
[0m01:45:14.707733 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.snapshot_raw_stock_price ........................ [[32mSUCCESS 0[0m in 4.00s]
[0m01:45:14.708360 [debug] [Thread-1 (]: Finished running node snapshot.stock_elt_project.snapshot_raw_stock_price
[0m01:45:14.709870 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:45:14.710194 [debug] [MainThread]: Connection 'snapshot.stock_elt_project.snapshot_raw_stock_price' was properly closed.
[0m01:45:14.710486 [info ] [MainThread]: 
[0m01:45:14.710786 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 5.95 seconds (5.95s).
[0m01:45:14.711441 [debug] [MainThread]: Command end result
[0m01:45:14.733745 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/manifest.json
[0m01:45:14.735079 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/semantic_manifest.json
[0m01:45:14.739010 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/matthewleffler/Documents/DATA 226/Docker Files 2/sjsu-data226-SP25/dbt/target/run_results.json
[0m01:45:14.739207 [info ] [MainThread]: 
[0m01:45:14.739433 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:45:14.739603 [info ] [MainThread]: 
[0m01:45:14.739773 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:45:14.741365 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 6.460114, "process_in_blocks": "0", "process_kernel_time": 0.214736, "process_mem_max_rss": "138969088", "process_out_blocks": "0", "process_user_time": 1.265784}
[0m01:45:14.741655 [debug] [MainThread]: Command `dbt snapshot` succeeded at 01:45:14.741595 after 6.46 seconds
[0m01:45:14.741876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11593e360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115755450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115754690>]}
[0m01:45:14.742086 [debug] [MainThread]: Flushing usage events
[0m01:45:15.180544 [debug] [MainThread]: An error was encountered while trying to flush usage events
